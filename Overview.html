<!doctype html>
<html lang="en" dir="ltr">
 <head>
  <meta charset="UTF-8">
  <title>Encoding</title>
  <meta content="width=device-width, initial-scale=1, shrink-to-fit=no" name="viewport">
  <meta content="CR" name="w3c-status">
  <meta content="The Encoding Standard defines encodings and their JavaScript API." name="abstract">

  <link rel="stylesheet" href="https://www.w3.org/encoding/local.css" type="text/css">

  <meta content="Bikeshed version f9aa96bada6cc0645a943ca5dd1cd55eb004d4c0" name="generator">
  <link href="https://www.w3.org/TR/encoding/" rel="canonical">
<style>/* style-md-lists */

            /* This is a weird hack for me not yet following the commonmark spec
               regarding paragraph and lists. */
            [data-md] > :first-child {
                margin-top: 0;
            }
            [data-md] > :last-child {
                margin-bottom: 0;
            }</style>
<style>/* style-selflinks */

            .heading, .issue, .note, .example, li, dt {
                position: relative;
            }
            a.self-link {
                position: absolute;
                top: 0;
                left: calc(-1 * (3.5rem - 26px));
                width: calc(3.5rem - 26px);
                height: 2em;
                text-align: center;
                border: none;
                transition: opacity .2s;
                opacity: .5;
            }
            a.self-link:hover {
                opacity: 1;
            }
            .heading > a.self-link {
                font-size: 83%;
            }
            li > a.self-link {
                left: calc(-1 * (3.5rem - 26px) - 2em);
            }
            dfn > a.self-link {
                top: auto;
                left: auto;
                opacity: 0;
                width: 1.5em;
                height: 1.5em;
                background: gray;
                color: white;
                font-style: normal;
                transition: opacity .2s, background-color .2s, color .2s;
            }
            dfn:hover > a.self-link {
                opacity: 1;
            }
            dfn > a.self-link:hover {
                color: black;
            }

            a.self-link::before            { content: "¶"; }
            .heading > a.self-link::before { content: "§"; }
            dfn > a.self-link::before      { content: "#"; }</style>
<style>/* style-counters */

            body {
                counter-reset: example figure issue;
            }
            .issue {
                counter-increment: issue;
            }
            .issue:not(.no-marker)::before {
                content: "Issue " counter(issue);
            }

            .example {
                counter-increment: example;
            }
            .example:not(.no-marker)::before {
                content: "Example " counter(example);
            }
            .invalid.example:not(.no-marker)::before,
            .illegal.example:not(.no-marker)::before {
                content: "Invalid Example" counter(example);
            }

            figcaption {
                counter-increment: figure;
            }
            figcaption:not(.no-marker)::before {
                content: "Figure " counter(figure) " ";
            }</style>
<style>/* style-autolinks */

            .css.css, .property.property, .descriptor.descriptor {
                color: #005a9c;
                font-size: inherit;
                font-family: inherit;
            }
            .css::before, .property::before, .descriptor::before {
                content: "‘";
            }
            .css::after, .property::after, .descriptor::after {
                content: "’";
            }
            .property, .descriptor {
                /* Don't wrap property and descriptor names */
                white-space: nowrap;
            }
            .type { /* CSS value <type> */
                font-style: italic;
            }
            pre .property::before, pre .property::after {
                content: "";
            }
            [data-link-type="property"]::before,
            [data-link-type="propdesc"]::before,
            [data-link-type="descriptor"]::before,
            [data-link-type="value"]::before,
            [data-link-type="function"]::before,
            [data-link-type="at-rule"]::before,
            [data-link-type="selector"]::before,
            [data-link-type="maybe"]::before {
                content: "‘";
            }
            [data-link-type="property"]::after,
            [data-link-type="propdesc"]::after,
            [data-link-type="descriptor"]::after,
            [data-link-type="value"]::after,
            [data-link-type="function"]::after,
            [data-link-type="at-rule"]::after,
            [data-link-type="selector"]::after,
            [data-link-type="maybe"]::after {
                content: "’";
            }

            [data-link-type].production::before,
            [data-link-type].production::after,
            .prod [data-link-type]::before,
            .prod [data-link-type]::after {
                content: "";
            }

            [data-link-type=element],
            [data-link-type=element-attr] {
                font-family: Menlo, Consolas, "DejaVu Sans Mono", monospace;
                font-size: .9em;
            }
            [data-link-type=element]::before { content: "<" }
            [data-link-type=element]::after  { content: ">" }

            [data-link-type=biblio] {
                white-space: pre;
            }</style>
<style>/* style-dfn-panel */

        .dfn-panel {
            position: absolute;
            z-index: 35;
            height: auto;
            width: -webkit-fit-content;
            width: fit-content;
            max-width: 300px;
            max-height: 500px;
            overflow: auto;
            padding: 0.5em 0.75em;
            font: small Helvetica Neue, sans-serif, Droid Sans Fallback;
            background: #DDDDDD;
            color: black;
            border: outset 0.2em;
        }
        .dfn-panel:not(.on) { display: none; }
        .dfn-panel * { margin: 0; padding: 0; text-indent: 0; }
        .dfn-panel > b { display: block; }
        .dfn-panel a { color: black; }
        .dfn-panel a:not(:hover) { text-decoration: none !important; border-bottom: none !important; }
        .dfn-panel > b + b { margin-top: 0.25em; }
        .dfn-panel ul { padding: 0; }
        .dfn-panel li { list-style: inside; }
        .dfn-panel.activated {
            display: inline-block;
            position: fixed;
            left: .5em;
            bottom: 2em;
            margin: 0 auto;
            max-width: calc(100vw - 1.5em - .4em - .5em);
            max-height: 30vh;
        }

        .dfn-paneled { cursor: pointer; }
        </style>
<style>/* style-syntax-highlighting */
pre.idl.highlight { color: #708090; }
.highlight:not(.idl) { background: hsl(24, 20%, 95%); }
code.highlight { padding: .1em; border-radius: .3em; }
pre.highlight, pre > code.highlight { display: block; padding: 1em; margin: .5em 0; overflow: auto; border-radius: 0; }
.highlight .c { color: #708090 } /* Comment */
.highlight .k { color: #990055 } /* Keyword */
.highlight .l { color: #000000 } /* Literal */
.highlight .n { color: #0077aa } /* Name */
.highlight .o { color: #999999 } /* Operator */
.highlight .p { color: #999999 } /* Punctuation */
.highlight .cm { color: #708090 } /* Comment.Multiline */
.highlight .cp { color: #708090 } /* Comment.Preproc */
.highlight .c1 { color: #708090 } /* Comment.Single */
.highlight .cs { color: #708090 } /* Comment.Special */
.highlight .kc { color: #990055 } /* Keyword.Constant */
.highlight .kd { color: #990055 } /* Keyword.Declaration */
.highlight .kn { color: #990055 } /* Keyword.Namespace */
.highlight .kp { color: #990055 } /* Keyword.Pseudo */
.highlight .kr { color: #990055 } /* Keyword.Reserved */
.highlight .kt { color: #990055 } /* Keyword.Type */
.highlight .ld { color: #000000 } /* Literal.Date */
.highlight .m { color: #000000 } /* Literal.Number */
.highlight .s { color: #a67f59 } /* Literal.String */
.highlight .na { color: #0077aa } /* Name.Attribute */
.highlight .nc { color: #0077aa } /* Name.Class */
.highlight .no { color: #0077aa } /* Name.Constant */
.highlight .nd { color: #0077aa } /* Name.Decorator */
.highlight .ni { color: #0077aa } /* Name.Entity */
.highlight .ne { color: #0077aa } /* Name.Exception */
.highlight .nf { color: #0077aa } /* Name.Function */
.highlight .nl { color: #0077aa } /* Name.Label */
.highlight .nn { color: #0077aa } /* Name.Namespace */
.highlight .py { color: #0077aa } /* Name.Property */
.highlight .nt { color: #669900 } /* Name.Tag */
.highlight .nv { color: #222222 } /* Name.Variable */
.highlight .ow { color: #999999 } /* Operator.Word */
.highlight .mb { color: #000000 } /* Literal.Number.Bin */
.highlight .mf { color: #000000 } /* Literal.Number.Float */
.highlight .mh { color: #000000 } /* Literal.Number.Hex */
.highlight .mi { color: #000000 } /* Literal.Number.Integer */
.highlight .mo { color: #000000 } /* Literal.Number.Oct */
.highlight .sb { color: #a67f59 } /* Literal.String.Backtick */
.highlight .sc { color: #a67f59 } /* Literal.String.Char */
.highlight .sd { color: #a67f59 } /* Literal.String.Doc */
.highlight .s2 { color: #a67f59 } /* Literal.String.Double */
.highlight .se { color: #a67f59 } /* Literal.String.Escape */
.highlight .sh { color: #a67f59 } /* Literal.String.Heredoc */
.highlight .si { color: #a67f59 } /* Literal.String.Interpol */
.highlight .sx { color: #a67f59 } /* Literal.String.Other */
.highlight .sr { color: #a67f59 } /* Literal.String.Regex */
.highlight .s1 { color: #a67f59 } /* Literal.String.Single */
.highlight .ss { color: #a67f59 } /* Literal.String.Symbol */
.highlight .vc { color: #0077aa } /* Name.Variable.Class */
.highlight .vg { color: #0077aa } /* Name.Variable.Global */
.highlight .vi { color: #0077aa } /* Name.Variable.Instance */
.highlight .il { color: #000000 } /* Literal.Number.Integer.Long */
</style>
  <link href="https://www.w3.org/StyleSheets/TR/2016/W3C-CR" rel="stylesheet" type="text/css">
 <script src="//www.w3.org/scripts/TR/2016/fixup.js"></script>
 <body class="h-entry">
  <div class="head">
   <p data-fill-with="logo"><a class="logo" href="https://www.w3.org/"> <img alt="W3C" height="48" src="https://www.w3.org/StyleSheets/TR/2016/logos/W3C" width="72"> </a> </p>
   <h1 class="p-name no-ref" id="title">Encoding</h1>
   <h2 class="no-num no-toc no-ref heading settled" id="subtitle"><span class="content">W3C Candidate Recommendation, <time class="dt-updated" datetime="2017-07-14">14 July 2017</time></span></h2>
   <div data-fill-with="spec-metadata">
    <dl>
     <dt>This version:
     <dd><a class="u-url" href="https://www.w3.org/TR/2017/CR-encoding-20170714/">https://www.w3.org/TR/2017/CR-encoding-20170714/</a>
     <dt>Latest published version:
     <dd><a href="https://www.w3.org/TR/encoding/">https://www.w3.org/TR/encoding/</a>
     <dt>Editor's Draft:
     <dd><a href="https://encoding.spec.whatwg.org/">https://encoding.spec.whatwg.org/</a>
     <dt>Previous Versions:
     <dd><a href="https://www.w3.org/TR/2017/CR-encoding-20170413/" rel="prev">https://www.w3.org/TR/2017/CR-encoding-20170413/</a>
     <dt class="editor">Editors:
     <dd class="editor p-author h-card vcard"><a class="p-name fn u-email email" href="mailto:annevk@annevk.nl">Anne van Kesteren</a>
     <dd class="editor p-author h-card vcard"><span class="p-name fn">Joshua Bell</span> (<span class="p-org org">Google</span>)
     <dd class="editor p-author h-card vcard"><a class="p-name fn u-email email" href="mailto:addison@amazon.com">Addison Phillips</a> (<span class="p-org org">Invited Expert</span>)
    </dl>
    
    <dt>Implementation report:</dt>
      <dd><a href="https://www.w3.org/International/docs/encoding/implementation-report">https://www.w3.org/International/docs/encoding/implementation-report</a></dd>
      <dt>Bug tracker:</dt>
      <dd><a href="https://github.com/whatwg/encoding/issues">file a bug</a> (<a href="https://github.com/whatwg/encoding/issues">open bugs</a>)</dd>
      <dt>Github:</dt>
      <dd>
        <a href="https://github.com/whatwg/encoding/">repository</a>
   </dd>
   </div>
   <div data-fill-with="warning"></div>
   <p class="copyright" data-fill-with="copyright"><a href="https://www.w3.org/Consortium/Legal/ipr-notice#Copyright">Copyright</a> © 2017 <a href="https://www.w3.org/"><abbr title="World Wide Web Consortium">W3C</abbr></a><sup>®</sup> (<a href="http://www.csail.mit.edu/"><abbr title="Massachusetts Institute of Technology">MIT</abbr></a>, <a href="http://www.ercim.eu/"><abbr title="European Research Consortium for Informatics and Mathematics">ERCIM</abbr></a>, <a href="http://www.keio.ac.jp/">Keio</a>, <a href="http://ev.buaa.edu.cn/">Beihang</a>). W3C <a href="https://www.w3.org/Consortium/Legal/ipr-notice#Legal_Disclaimer">liability</a>, <a href="https://www.w3.org/Consortium/Legal/ipr-notice#W3C_Trademarks">trademark</a> and <a href="https://www.w3.org/Consortium/Legal/copyright-documents">document use</a> rules apply. </p>
   <hr title="Separator for header">
  </div>
  <div class="p-summary" data-fill-with="abstract">
   <h2 class="no-num no-toc no-ref heading settled" id="abstract"><span class="content">Abstract</span></h2>
    <p>The utf-8 encoding is the most appropriate encoding for interchange of Unicode, the universal coded character set. Therefore for new protocols and formats, as well as existing formats deployed in new contexts, this specification requires (and defines) the utf-8 encoding. </p>
    <p>The other (legacy) encodings have been defined to some extent in the past. However, user agents have not always implemented them in the same way, have not always used the same labels, and often differ in dealing with undefined and former proprietary areas of encodings. This specification addresses those gaps so that new user agents do not have to reverse engineer encoding implementations and existing user agents can converge. </p>

  </div>
  <h2 class="no-num no-toc no-ref heading settled" id="status"><span class="content">Status of this document</span></h2>
  <div data-fill-with="status">
   <p> <em>This section describes the status of this document at the time of its publication.
		Other documents may supersede this document.
		A list of current W3C publications and the latest revision of this technical report
		can be found in the <a href="https://www.w3.org/TR/">W3C technical reports index at https://www.w3.org/TR/.</a></em> </p>
		  <p class="stability" id="wip">The body of this spec is an exact copy of the WHATWG version as of the date of its publication, intended to provide a stable reference for other specifications. For the latest updates, including changes since this snapshot was published, please look at the <a href="http://encoding.spec.whatwg.org/">WHATWG version</a>.
<input onclick="closeWarning(this.parentNode)" type="button" value="X"></p>
  <script>
   function closeWarning(element) {
     element.parentNode.removeChild(element);
     var date = new Date();
     date.setDate(date.getDate()+4);
     document.cookie = 'hide-obsolescence-warning=1; expires=' + date.toGMTString();
   }
   function removeWIP () {
       document.getElementById('wip').parentNode.removeChild(document.getElementById('wip'));
   }
   if (document.documentElement.getAttribute("data-wip") === "false") removeWIP();
   if (getCookie('hide-obsolescence-warning') == '1') setTimeout(removeWIP, 2000);
  </script>


    <p>This is a snapshot of the WHATWG document, as of 14 July 2017, published with the knowledge of the WHATWG editors. No changes have been made in the body of this document other than to align with <abbr title="World Wide Web Consortium">W3C</abbr> house styles. The primary reason that <abbr title="World Wide Web Consortium">W3C</abbr> is publishing this document is so that HTML5 and other specifications may normatively refer to a stable <abbr title="World Wide Web Consortium">W3C</abbr> Recommendation.</p>
    <p>This update of the Candidate Recommendation takes into account changes made to the editor's draft since its previous publication as CR. These changes are largely due to issues discovered during implementation.</p>
    <div class="note">
      <div class="note-title marker" aria-level="3" role="heading" id="h-note1"><span>Note</span></div>
      <div class="">
        <div class="">
          <p style="font-weight: bold; font-size: 120%">Sending comments on this document</p>
          <p>If you wish to make comments regarding this document, please raise them as <a href="https://github.com/whatwg/encoding/issues" style="font-size: 120%;">github issues</a> against the <a href="https://encoding.spec.whatwg.org/" style="font-size: 120%">latest editor's draft</a>. Only send comments by email if you are unable to raise issues on github (see links below). All comments are welcome.</p>
          <p>To make it easier to track comments, please raise separate issues or emails for each comment, and point to the section you are commenting on&nbsp; using a URL for the dated version of the document.</p>
        </div>
      </div>
</div>
   <p> This document was produced by the <a href="https://www.w3.org/International/core/">Internationalization Working Group</a> as a Candidate Recommendation.
	This document is intended to become a W3C Recommendation.
	This document will remain a Candidate Recommendation at least until <time class="status-deadline" datetime="2017-07-28">28 July 2017</time> in order
	to ensure the opportunity for wide review. </p>
   <p> If you wish to make comments regarding this document,
	please send them to <a href="www-international@w3.org">www-international@w3.org</a> (<a href="mailto:www-international-request@w3.org">subscribe</a>, <a href="https://lists.w3.org/Archives/Public/www-international/">archives</a>). </p>
   <p> Publication as a Candidate Recommendation does not imply endorsement by the W3C
	Membership. This is a draft document and may be updated, replaced or
	obsoleted by other documents at any time. It is inappropriate to cite this
	document as other than work in progress. </p>
   <p> This document was produced by a group operating under
	the <a href="https://www.w3.org/Consortium/Patent-Policy-20040205/">5 February 2004 W3C Patent Policy</a>.
	W3C maintains a <a href="https://www.w3.org/2004/01/pp-impl/32113/status" rel="disclosure">public list of any patent disclosures</a> made in connection with the deliverables of the group;
	that page also includes instructions for disclosing a patent.
	An individual who has actual knowledge of a patent which the individual believes contains <a href="https://www.w3.org/Consortium/Patent-Policy-20040205/#def-essential">Essential Claim(s)</a> must disclose the information in accordance with <a href="https://www.w3.org/Consortium/Patent-Policy-20040205/#sec-Disclosure">section 6 of the W3C Patent Policy</a>. </p>
   <p> This document is governed by the <a href="https://www.w3.org/2017/Process-20170301/" id="w3c_process_revision">1 March 2017 W3C Process Document</a>. </p>
   <p> For changes since the last draft,
	see the <a href="#changes">Changes</a> section. </p>
   <p></p>
  </div>
  <div data-fill-with="at-risk"></div>
  <nav data-fill-with="table-of-contents" id="toc">
   <h2 class="no-num no-toc no-ref" id="contents">Table of Contents</h2>
   <ol class="toc" role="directory">
    <li><a href="#preface"><span class="secno">1</span> <span class="content">Preface</span></a>
    <li><a href="#security-background"><span class="secno">2</span> <span class="content">Security background</span></a>
    <li><a href="#terminology"><span class="secno">3</span> <span class="content">Terminology</span></a>
    <li>
     <a href="#encodings"><span class="secno">4</span> <span class="content">Encodings</span></a>
     <ol class="toc">
      <li><a href="#encoders-and-decoders"><span class="secno">4.1</span> <span class="content">Encoders and decoders</span></a>
      <li><a href="#names-and-labels"><span class="secno">4.2</span> <span class="content">Names and labels</span></a>
      <li><a href="#output-encodings"><span class="secno">4.3</span> <span class="content">Output encodings</span></a>
     </ol>
    <li><a href="#indexes"><span class="secno">5</span> <span class="content">Indexes</span></a>
    <li><a href="#specification-hooks"><span class="secno">6</span> <span class="content">Specification hooks</span></a>
    <li>
     <a href="#api"><span class="secno">7</span> <span class="content">API</span></a>
     <ol class="toc">
      <li><a href="#interface-textdecoder"><span class="secno">7.1</span> <span class="content">Interface <code class="idl"><span>TextDecoder</span></code></span></a>
      <li><a href="#interface-textencoder"><span class="secno">7.2</span> <span class="content">Interface <code class="idl"><span>TextEncoder</span></code></span></a>
     </ol>
    <li>
     <a href="#the-encoding"><span class="secno">8</span> <span class="content">The encoding</span></a>
     <ol class="toc">
      <li>
       <a href="#utf-8"><span class="secno">8.1</span> <span class="content">UTF-8</span></a>
       <ol class="toc">
        <li><a href="#utf-8-decoder"><span class="secno">8.1.1</span> <span class="content">UTF-8 decoder</span></a>
        <li><a href="#utf-8-encoder"><span class="secno">8.1.2</span> <span class="content">UTF-8 encoder</span></a>
       </ol>
     </ol>
    <li>
     <a href="#legacy-single-byte-encodings"><span class="secno">9</span> <span class="content">Legacy single-byte encodings</span></a>
     <ol class="toc">
      <li><a href="#single-byte-decoder"><span class="secno">9.1</span> <span class="content">single-byte decoder</span></a>
      <li><a href="#single-byte-encoder"><span class="secno">9.2</span> <span class="content">single-byte encoder</span></a>
     </ol>
    <li>
     <a href="#legacy-multi-byte-chinese-(simplified)-encodings"><span class="secno">10</span> <span class="content">Legacy multi-byte Chinese (simplified) encodings</span></a>
     <ol class="toc">
      <li>
       <a href="#gbk"><span class="secno">10.1</span> <span class="content">GBK</span></a>
       <ol class="toc">
        <li><a href="#gbk-decoder"><span class="secno">10.1.1</span> <span class="content">GBK decoder</span></a>
        <li><a href="#gbk-encoder"><span class="secno">10.1.2</span> <span class="content">GBK encoder</span></a>
       </ol>
      <li>
       <a href="#gb18030"><span class="secno">10.2</span> <span class="content">gb18030</span></a>
       <ol class="toc">
        <li><a href="#gb18030-decoder"><span class="secno">10.2.1</span> <span class="content">gb18030 decoder</span></a>
        <li><a href="#gb18030-encoder"><span class="secno">10.2.2</span> <span class="content">gb18030 encoder</span></a>
       </ol>
     </ol>
    <li>
     <a href="#legacy-multi-byte-chinese-(traditional)-encodings"><span class="secno">11</span> <span class="content">Legacy multi-byte Chinese (traditional) encodings</span></a>
     <ol class="toc">
      <li>
       <a href="#big5"><span class="secno">11.1</span> <span class="content">Big5</span></a>
       <ol class="toc">
        <li><a href="#big5-decoder"><span class="secno">11.1.1</span> <span class="content">Big5 decoder</span></a>
        <li><a href="#big5-encoder"><span class="secno">11.1.2</span> <span class="content">Big5 encoder</span></a>
       </ol>
     </ol>
    <li>
     <a href="#legacy-multi-byte-japanese-encodings"><span class="secno">12</span> <span class="content">Legacy multi-byte Japanese encodings</span></a>
     <ol class="toc">
      <li>
       <a href="#euc-jp"><span class="secno">12.1</span> <span class="content">EUC-JP</span></a>
       <ol class="toc">
        <li><a href="#euc-jp-decoder"><span class="secno">12.1.1</span> <span class="content">EUC-JP decoder</span></a>
        <li><a href="#euc-jp-encoder"><span class="secno">12.1.2</span> <span class="content">EUC-JP encoder</span></a>
       </ol>
      <li>
       <a href="#iso-2022-jp"><span class="secno">12.2</span> <span class="content">ISO-2022-JP</span></a>
       <ol class="toc">
        <li><a href="#iso-2022-jp-decoder"><span class="secno">12.2.1</span> <span class="content">ISO-2022-JP decoder</span></a>
        <li><a href="#iso-2022-jp-encoder"><span class="secno">12.2.2</span> <span class="content">ISO-2022-JP encoder</span></a>
       </ol>
      <li>
       <a href="#shift_jis"><span class="secno">12.3</span> <span class="content">Shift_JIS</span></a>
       <ol class="toc">
        <li><a href="#shift_jis-decoder"><span class="secno">12.3.1</span> <span class="content">Shift_JIS decoder</span></a>
        <li><a href="#shift_jis-encoder"><span class="secno">12.3.2</span> <span class="content">Shift_JIS encoder</span></a>
       </ol>
     </ol>
    <li>
     <a href="#legacy-multi-byte-korean-encodings"><span class="secno">13</span> <span class="content">Legacy multi-byte Korean encodings</span></a>
     <ol class="toc">
      <li>
       <a href="#euc-kr"><span class="secno">13.1</span> <span class="content">EUC-KR</span></a>
       <ol class="toc">
        <li><a href="#euc-kr-decoder"><span class="secno">13.1.1</span> <span class="content">EUC-KR decoder</span></a>
        <li><a href="#euc-kr-encoder"><span class="secno">13.1.2</span> <span class="content">EUC-KR encoder</span></a>
       </ol>
     </ol>
    <li>
     <a href="#legacy-miscellaneous-encodings"><span class="secno">14</span> <span class="content">Legacy miscellaneous encodings</span></a>
     <ol class="toc">
      <li>
       <a href="#replacement"><span class="secno">14.1</span> <span class="content">replacement</span></a>
       <ol class="toc">
        <li><a href="#replacement-decoder"><span class="secno">14.1.1</span> <span class="content">replacement decoder</span></a>
       </ol>
      <li>
       <a href="#common-infrastructure-for-utf-16be-and-utf-16le"><span class="secno">14.2</span> <span class="content">Common infrastructure for <span>UTF-16BE</span> and <span>UTF-16LE</span></span></a>
       <ol class="toc">
        <li><a href="#shared-utf-16-decoder"><span class="secno">14.2.1</span> <span class="content">shared UTF-16 decoder</span></a>
       </ol>
      <li>
       <a href="#utf-16be"><span class="secno">14.3</span> <span class="content">UTF-16BE</span></a>
       <ol class="toc">
        <li><a href="#utf-16be-decoder"><span class="secno">14.3.1</span> <span class="content">UTF-16BE decoder</span></a>
       </ol>
      <li>
       <a href="#utf-16le"><span class="secno">14.4</span> <span class="content">UTF-16LE</span></a>
       <ol class="toc">
        <li><a href="#utf-16le-decoder"><span class="secno">14.4.1</span> <span class="content">UTF-16LE decoder</span></a>
       </ol>
      <li>
       <a href="#x-user-defined"><span class="secno">14.5</span> <span class="content">x-user-defined</span></a>
       <ol class="toc">
        <li><a href="#x-user-defined-decoder"><span class="secno">14.5.1</span> <span class="content">x-user-defined decoder</span></a>
        <li><a href="#x-user-defined-encoder"><span class="secno">14.5.2</span> <span class="content">x-user-defined encoder</span></a>
       </ol>
     </ol>
    <li><a href="#browser-ui"><span class="secno">15</span> <span class="content">Browser UI</span></a>
    <li><a href="#implementation-considerations"><span class="secno"></span> <span class="content">Implementation considerations</span></a>
    <li><a href="#acknowledgments"><span class="secno"></span> <span class="content">Acknowledgments</span></a>
    <li><a href="#changes"><span class="secno"></span> <span class="content">Changes</span></a>
    <li>
     <a href="#references"><span class="secno"></span> <span class="content">References</span></a>
     <ol class="toc">
      <li><a href="#normative"><span class="secno"></span> <span class="content">Normative References</span></a>
      <li><a href="#informative"><span class="secno"></span> <span class="content">Informative References</span></a>
     </ol>
   </ol>
  </nav>
  <main>
<script async="" src="https://resources.whatwg.org/file-issue.js"></script>
<script async="" src="https://resources.whatwg.org/commit-snapshot-shortcut-key.js"></script>
<script defer="" src="https://resources.whatwg.org/dfn.js"></script>
   <h2 class="heading settled" data-level="1" id="preface"><span class="secno">1. </span><span class="content">Preface</span><a class="self-link" href="#preface"></a></h2>
   <p>The UTF-8 encoding is the most appropriate encoding for interchange of Unicode, the
universal coded character set. Therefore for new protocols and formats, as well as
existing formats deployed in new contexts, this specification requires (and defines) the
UTF-8 encoding. </p>
   <p>The other (legacy) encodings have been defined to some extent in the past. However,
user agents have not always implemented them in the same way, have not always used the
same labels, and often differ in dealing with undefined and former proprietary areas of
encodings. This specification addresses those gaps so that new user agents do not have to
reverse engineer encoding implementations and existing user agents can converge. </p>
   <p>In particular, this specification defines all those encodings, their algorithms to go
from bytes to scalar values and back, and their canonical names and identifying labels.
This specification also defines an API to expose part of the encoding algorithms to
JavaScript. </p>
   <p>User agents have also significantly deviated from the labels listed in the <a href="https://www.iana.org/assignments/character-sets/character-sets.xhtml">IANA Character Sets registry</a>.
To stop spreading legacy encodings further, this specification is exhaustive about the
aforementioned details and therefore has no need for the registry. In particular, this
specification does not provide a mechanism for extending any aspect of encodings. </p>
   <h2 class="heading settled" data-level="2" id="security-background"><span class="secno">2. </span><span class="content">Security background</span><a class="self-link" href="#security-background"></a></h2>
   <p>There is a set of encoding security issues when the producer and consumer do not agree
on the encoding in use, or on the way a given encoding is to be implemented. For instance,
an attack was reported in 2011 where a <a data-link-type="dfn" href="#shift_jis" id="ref-for-shift_jis-1">Shift_JIS</a> lead byte 0x82 was used to
“mask” a 0x22 trail byte in a JSON resource of which an attacker could control some field.
The producer did not see the problem even though this is an illegal byte combination. The
consumer decoded it as a single U+FFFD and therefore changed the overall interpretation as
U+0022 is an important delimiter. Decoders of encodings that use multiple bytes for scalar
values now require that in case of an illegal byte combination, a scalar value in the
range U+0000 to U+007F, inclusive, cannot be “masked”. For the aforementioned sequence the
output would be U+FFFD U+0022. </p>
   <p>This is a larger issue for encodings that map anything that is an <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#ascii-byte">ASCII byte</a> to
something that is not an <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#ascii-code-point">ASCII code point</a>, when there is no lead byte present. These
are “ASCII-incompatible” encodings and other than <a data-link-type="dfn" href="#iso-2022-jp" id="ref-for-iso-2022-jp-1">ISO-2022-JP</a>, <a data-link-type="dfn" href="#utf-16be" id="ref-for-utf-16be-1">UTF-16BE</a>,
and <a data-link-type="dfn" href="#utf-16le" id="ref-for-utf-16le-1">UTF-16LE</a>, which are unfortunately required due to deployed content, they are not
supported. (Investigation is <a href="https://github.com/whatwg/encoding/issues/8">ongoing</a> whether more labels of other such encodings can be mapped to the <a data-link-type="dfn" href="#replacement" id="ref-for-replacement-1">replacement</a> encoding, rather than the unknown encoding fallback.) An example attack is injecting
carefully crafted content into a resource and then encouraging the user to override the
encoding, resulting in e.g. script execution. </p>
   <p>Encoders used by URLs found in HTML and HTML’s form feature can also result in slight
information loss when an encoding is used that cannot represent all scalar values. E.g.
when a resource uses the <a data-link-type="dfn" href="#windows-1252" id="ref-for-windows-1252-1">windows-1252</a> encoding a server will not be able to
distinguish between an end user entering “💩” and “&amp;#128169;” into a form. </p>
   <p>The problems outlined here go away when exclusively using UTF-8, which is one of the
many reasons that is now the mandatory encoding for all things. </p>
   <p class="note" role="note">See also the <a href="#browser-ui">Browser UI</a> chapter. </p>
   <h2 class="heading settled" data-level="3" id="terminology"><span class="secno">3. </span><span class="content">Terminology</span><a class="self-link" href="#terminology"></a></h2>
   <p>This specification depends on the Infra Standard. <a data-link-type="biblio" href="#biblio-infra">[INFRA]</a> </p>
   <p>Hexadecimal numbers are prefixed with "0x". </p>
   <p>In equations, all numbers are integers, addition is represented by "+", subtraction by "−",
multiplication by "×", integer division by "/" (returns the quotient), modulo by "%" (returns the
remainder of an integer division), logical left shifts by "&lt;&lt;", logical right shifts by ">>",
bitwise AND by "&amp;", and bitwise OR by "|". </p>
   <p>For logical right shifts operands must have at least twenty-one bits precision. </p>
   <hr>
   <p>A <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport="" id="concept-token">token</dfn> is a piece of data, such as a <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#byte">byte</a> or <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#code-point">code point</a>. </p>
   <p>A <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport="" id="concept-stream">stream</dfn> represents an ordered sequence of <a data-link-type="dfn" href="#concept-token" id="ref-for-concept-token-1">tokens</a>. <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport="" id="end-of-stream">End-of-stream</dfn> is a special <a data-link-type="dfn" href="#concept-token" id="ref-for-concept-token-2">token</a> that signifies no more <a data-link-type="dfn" href="#concept-token" id="ref-for-concept-token-3">tokens</a> are in the <a data-link-type="dfn" href="#concept-stream" id="ref-for-concept-stream-1">stream</a>. </p>
   <p>When a <a data-link-type="dfn" href="#concept-token" id="ref-for-concept-token-4">token</a> is <dfn class="dfn-paneled" data-dfn-for="stream" data-dfn-type="dfn" data-noexport="" id="concept-stream-read">read</dfn> from a <a data-link-type="dfn" href="#concept-stream" id="ref-for-concept-stream-2">stream</a>,
the first token in the stream must be returned and subsequently removed, and <a data-link-type="dfn" href="#end-of-stream" id="ref-for-end-of-stream-1">end-of-stream</a> must be returned otherwise. </p>
   <p>When one or more <a data-link-type="dfn" href="#concept-token" id="ref-for-concept-token-5">tokens</a> are <dfn class="dfn-paneled" data-dfn-for="stream" data-dfn-type="dfn" data-noexport="" id="concept-stream-prepend">prepended</dfn> to a <a data-link-type="dfn" href="#concept-stream" id="ref-for-concept-stream-3">stream</a>, those tokens must be inserted, in given order,
before the first token in the stream. </p>
   <p class="example" id="example-tokens"><a class="self-link" href="#example-tokens"></a>Inserting the sequence of tokens <code>&amp;#128169;</code> in a stream "<code> hello world</code>", results in a stream
"<code>&amp;#128169; hello world</code>". The next token to be read would be <code>&amp;</code>. </p>
   <p>When one or more <a data-link-type="dfn" href="#concept-token" id="ref-for-concept-token-6">tokens</a> are <dfn class="dfn-paneled" data-dfn-for="stream" data-dfn-type="dfn" data-noexport="" id="concept-stream-push">pushed</dfn> to a <a data-link-type="dfn" href="#concept-stream" id="ref-for-concept-stream-4">stream</a>,
those tokens must be inserted, in given order, after the last token in the stream. </p>
   <h2 class="heading settled" data-level="4" id="encodings"><span class="secno">4. </span><span class="content">Encodings</span><a class="self-link" href="#encodings"></a></h2>
   <p>An <dfn class="dfn-paneled" data-dfn-type="dfn" data-export="" id="encoding">encoding</dfn> defines a mapping from a <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#scalar-value">scalar value</a> sequence to
a <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#byte">byte</a> sequence (and vice versa). Each <a data-link-type="dfn" href="#encoding" id="ref-for-encoding-1">encoding</a> has a <dfn class="dfn-paneled" data-dfn-for="encoding" data-dfn-type="dfn" data-export="" id="name">name</dfn>, and one or more <dfn class="dfn-paneled" data-dfn-for="encoding" data-dfn-type="dfn" data-export="" data-lt="label" id="label">labels</dfn>. </p>
   <h3 class="heading settled" data-level="4.1" id="encoders-and-decoders"><span class="secno">4.1. </span><span class="content">Encoders and decoders</span><a class="self-link" href="#encoders-and-decoders"></a></h3>
   <p>Each <a data-link-type="dfn" href="#encoding" id="ref-for-encoding-2">encoding</a> has an associated <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport="" id="decoder">decoder</dfn> and most of them have an
associated <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport="" id="encoder">encoder</dfn>. Each <a data-link-type="dfn" href="#decoder" id="ref-for-decoder-1">decoder</a> and <a data-link-type="dfn" href="#encoder" id="ref-for-encoder-1">encoder</a> have a <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport="" id="handler">handler</dfn> algorithm. A <a data-link-type="dfn" href="#handler" id="ref-for-handler-1">handler</a> algorithm takes an input <a data-link-type="dfn" href="#concept-stream" id="ref-for-concept-stream-5">stream</a> and a <a data-link-type="dfn" href="#concept-token" id="ref-for-concept-token-7">token</a>, and returns <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport="" id="finished">finished</dfn>, one or more <a data-link-type="dfn" href="#concept-token" id="ref-for-concept-token-8">tokens</a>, <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport="" id="error">error</dfn> optionally with a <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#code-point">code point</a>, or <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport="" id="continue">continue</dfn>. </p>
   <p class="note no-backref" role="note">The <a data-link-type="dfn" href="#replacement" id="ref-for-replacement-2">replacement</a>, <a data-link-type="dfn" href="#utf-16be" id="ref-for-utf-16be-2">UTF-16BE</a>, and <a data-link-type="dfn" href="#utf-16le" id="ref-for-utf-16le-2">UTF-16LE</a> <a data-link-type="dfn" href="#encoding" id="ref-for-encoding-3">encodings</a> have no <a data-link-type="dfn" href="#encoder" id="ref-for-encoder-2">encoder</a>. </p>
   <p>An <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport="" id="error-mode">error mode</dfn> as used below is "<code>replacement</code>" (default) or
"<code>fatal</code>" for a <a data-link-type="dfn" href="#decoder" id="ref-for-decoder-2">decoder</a> and "<code>fatal</code>" (default) or
"<code>html</code>" for an <a data-link-type="dfn" href="#encoder" id="ref-for-encoder-3">encoder</a>. </p>
   <p class="note" role="note">An XML processor would set <a data-link-type="dfn" href="#error-mode" id="ref-for-error-mode-1">error mode</a> to "<code>fatal</code>". <a data-link-type="biblio" href="#biblio-xml">[XML]</a> </p>
   <p class="note" role="note"><code>html</code> exists as <a data-link-type="dfn" href="#error-mode" id="ref-for-error-mode-2">error mode</a> due to URLs and HTML forms
requiring a non-terminating legacy <a data-link-type="dfn" href="#encoder" id="ref-for-encoder-4">encoder</a>. The "<code>html</code>" <a data-link-type="dfn" href="#error-mode" id="ref-for-error-mode-3">error mode</a> causes a sequence to be emitted that cannot be distinguished from
legitimate input and can therefore lead to silent data loss. Developers are strongly
encouraged to use the <a data-link-type="dfn" href="#utf-8" id="ref-for-utf-8-1">UTF-8</a> <a data-link-type="dfn" href="#encoding" id="ref-for-encoding-4">encoding</a> to prevent this from
happening. <a data-link-type="biblio" href="#biblio-url">[URL]</a> <a data-link-type="biblio" href="#biblio-html">[HTML]</a> </p>
   <p>To <dfn class="dfn-paneled" data-dfn-for="encoding" data-dfn-type="dfn" data-noexport="" id="concept-encoding-run">run</dfn> an <a data-link-type="dfn" href="#encoding" id="ref-for-encoding-5">encoding</a>’s <a data-link-type="dfn" href="#decoder" id="ref-for-decoder-3">decoder</a> or <a data-link-type="dfn" href="#encoder" id="ref-for-encoder-5">encoder</a> <var>encoderDecoder</var> with input <a data-link-type="dfn" href="#concept-stream" id="ref-for-concept-stream-6">stream</a> <var>input</var>, output <a data-link-type="dfn" href="#concept-stream" id="ref-for-concept-stream-7">stream</a> <var>output</var>, and optional <a data-link-type="dfn" href="#error-mode" id="ref-for-error-mode-4">error mode</a> <var>mode</var>, run these steps: </p>
   <ol>
    <li>
     <p>If <var>mode</var> is not given, set it to "<code>replacement</code>", if <var>encoderDecoder</var> is a <a data-link-type="dfn" href="#decoder" id="ref-for-decoder-4">decoder</a>, and "<code>fatal</code>" otherwise. </p>
    <li>
     <p>Let <var>encoderDecoderInstance</var> be a new <var>encoderDecoder</var>. </p>
    <li>
     <p>While true: </p>
     <ol>
      <li>
       <p>Let <var>result</var> be the result of <a data-link-type="dfn" href="#concept-encoding-process" id="ref-for-concept-encoding-process-1">processing</a> the result of <a data-link-type="dfn" href="#concept-stream-read" id="ref-for-concept-stream-read-1">reading</a> from <var>input</var> for <var>encoderDecoderInstance</var>, <var>input</var>, <var>output</var>, and <var>mode</var>. </p>
      <li>
       <p>If <var>result</var> is not <a data-link-type="dfn" href="#continue" id="ref-for-continue-1">continue</a>, return <var>result</var>. </p>
      <li>
       <p>Otherwise, do nothing. </p>
     </ol>
   </ol>
   <p>To <dfn class="dfn-paneled" data-dfn-for="encoding" data-dfn-type="dfn" data-noexport="" id="concept-encoding-process">process</dfn> a <a data-link-type="dfn" href="#concept-token" id="ref-for-concept-token-9">token</a> <var>token</var> for an <a data-link-type="dfn" href="#encoding" id="ref-for-encoding-6">encoding</a>’s <a data-link-type="dfn" href="#encoder" id="ref-for-encoder-6">encoder</a> or <a data-link-type="dfn" href="#decoder" id="ref-for-decoder-5">decoder</a> instance <var>encoderDecoderInstance</var>, <a data-link-type="dfn" href="#concept-stream" id="ref-for-concept-stream-8">stream</a> <var>input</var>, output <a data-link-type="dfn" href="#concept-stream" id="ref-for-concept-stream-9">stream</a> <var>output</var>, and optional <a data-link-type="dfn" href="#error-mode" id="ref-for-error-mode-5">error mode</a> <var>mode</var>, run these steps: </p>
   <ol>
    <li>
     <p>If <var>mode</var> is not given, set it to "<code>replacement</code>", if <var>encoderDecoderInstance</var> is a <a data-link-type="dfn" href="#decoder" id="ref-for-decoder-6">decoder</a> instance, and "<code>fatal</code>"
 otherwise. </p>
    <li>
     <p>Let <var>result</var> be the result of running <var>encoderDecoderInstance</var>’s <a data-link-type="dfn" href="#handler" id="ref-for-handler-2">handler</a> on <var>input</var> and <var>token</var>. </p>
    <li>
     <p>If <var>result</var> is <a data-link-type="dfn" href="#continue" id="ref-for-continue-2">continue</a> or <a data-link-type="dfn" href="#finished" id="ref-for-finished-1">finished</a>, return <var>result</var>. </p>
    <li>
     <p>Otherwise, if <var>result</var> is one or more <a data-link-type="dfn" href="#concept-token" id="ref-for-concept-token-10">tokens</a>, <a data-link-type="dfn" href="#concept-stream-push" id="ref-for-concept-stream-push-1">push</a> <var>result</var> to <var>output</var>. </p>
    <li>
     <p>Otherwise, if <var>result</var> is <a data-link-type="dfn" href="#error" id="ref-for-error-1">error</a>, switch on <var>mode</var> and
  run the associated steps: </p>
     <dl class="switch">
      <dt>"<code>replacement</code>" 
      <dd><a data-link-type="dfn" href="#concept-stream-push" id="ref-for-concept-stream-push-2">Push</a> U+FFFD to <var>output</var>. 
      <dt>"<code>html</code>" 
      <dd><a data-link-type="dfn" href="#concept-stream-prepend" id="ref-for-concept-stream-prepend-1">Prepend</a> U+0026, U+0023, followed by the
   shortest sequence of <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#ascii-digit">ASCII digits</a> representing <var>result</var>’s <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#code-point">code point</a> in base ten, followed by U+003B to <var>input</var>. 
      <dt>"<code>fatal</code>" 
      <dd>Return <a data-link-type="dfn" href="#error" id="ref-for-error-2">error</a>. 
     </dl>
    <li>Return <a data-link-type="dfn" href="#continue" id="ref-for-continue-3">continue</a>. 
   </ol>
   <h3 class="heading settled" data-level="4.2" id="names-and-labels"><span class="secno">4.2. </span><span class="content">Names and labels</span><a class="self-link" href="#names-and-labels"></a></h3>
   <p>The table below lists all <a data-link-type="dfn" href="#encoding" id="ref-for-encoding-7">encodings</a> and their <a data-link-type="dfn" href="#label" id="ref-for-label-1">labels</a> user agents must support.
User agents must not support any other <a data-link-type="dfn" href="#encoding" id="ref-for-encoding-8">encodings</a> or <a data-link-type="dfn" href="#label" id="ref-for-label-2">labels</a>. </p>
   <p>Authors must use the <a data-link-type="dfn" href="#utf-8" id="ref-for-utf-8-2">UTF-8</a> <a data-link-type="dfn" href="#encoding" id="ref-for-encoding-9">encoding</a> and must use the <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#ascii-case-insensitive">ASCII case-insensitive</a> "<code>utf-8</code>" <a data-link-type="dfn" href="#label" id="ref-for-label-3">label</a> to
identify it. </p>
   <p>New protocols and formats, as well as existing formats deployed in new contexts, must
use the <a data-link-type="dfn" href="#utf-8" id="ref-for-utf-8-3">UTF-8</a> <a data-link-type="dfn" href="#encoding" id="ref-for-encoding-10">encoding</a> exclusively. If these protocols and
formats need to expose the <a data-link-type="dfn" href="#encoding" id="ref-for-encoding-11">encoding</a>’s <a data-link-type="dfn" href="#name" id="ref-for-name-1">name</a> or <a data-link-type="dfn" href="#label" id="ref-for-label-4">label</a>, they must expose it as "<code>utf-8</code>". </p>
   <p>To <dfn class="dfn-paneled" data-dfn-type="dfn" data-export="" data-lt="get an encoding|getting an encoding" id="concept-encoding-get">get an encoding</dfn> from a string <var>label</var>, run these steps: </p>
   <ol>
    <li>
     <p>Remove any leading and trailing <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#ascii-whitespace">ASCII whitespace</a> from <var>label</var>. </p>
    <li>
     <p>If <var>label</var> is an <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#ascii-case-insensitive">ASCII case-insensitive</a> match for any of the <a data-link-type="dfn" href="#label" id="ref-for-label-5">labels</a> listed in the table
 below, return the corresponding <a data-link-type="dfn" href="#encoding" id="ref-for-encoding-12">encoding</a>, and failure otherwise. </p>
   </ol>
   <p class="note no-backref" role="note">This is a much simpler and more restrictive algorithm of
mapping <a data-link-type="dfn" href="#label" id="ref-for-label-6">labels</a> to <a data-link-type="dfn" href="#encoding" id="ref-for-encoding-13">encodings</a> than <a href="http://www.unicode.org/reports/tr22/tr22-7.html#Charset_Alias_Matching">section 1.4 of Unicode Technical Standard #22</a> prescribes, as that is found to be necessary to be compatible with deployed content. </p>
   <table>
    <thead>
     <tr>
      <th><a data-link-type="dfn" href="#name" id="ref-for-name-2">Name</a> 
      <th><a data-link-type="dfn" href="#label" id="ref-for-label-7">Labels</a> 
    <tbody>
     <tr>
      <th colspan="2"><a href="#the-encoding">The Encoding</a> 
     <tr>
      <td rowspan="3"><a data-link-type="dfn" href="#utf-8" id="ref-for-utf-8-4">UTF-8</a> 
      <td>"<code>unicode-1-1-utf-8</code>" 
     <tr>
      <td>"<code>utf-8</code>" 
     <tr>
      <td>"<code>utf8</code>" 
    <tbody>
     <tr>
      <th colspan="2"><a href="#legacy-single-byte-encodings">Legacy single-byte encodings</a> 
     <tr>
      <td rowspan="4"><a data-link-type="dfn" href="#ibm866" id="ref-for-ibm866-1">IBM866</a> 
      <td>"<code>866</code>" 
     <tr>
      <td>"<code>cp866</code>" 
     <tr>
      <td>"<code>csibm866</code>" 
     <tr>
      <td>"<code>ibm866</code>" 
     <tr>
      <td rowspan="9"><a data-link-type="dfn" href="#iso-8859-2" id="ref-for-iso-8859-2-1">ISO-8859-2</a> 
      <td>"<code>csisolatin2</code>" 
     <tr>
      <td>"<code>iso-8859-2</code>" 
     <tr>
      <td>"<code>iso-ir-101</code>" 
     <tr>
      <td>"<code>iso8859-2</code>" 
     <tr>
      <td>"<code>iso88592</code>" 
     <tr>
      <td>"<code>iso_8859-2</code>" 
     <tr>
      <td>"<code>iso_8859-2:1987</code>" 
     <tr>
      <td>"<code>l2</code>" 
     <tr>
      <td>"<code>latin2</code>" 
     <tr>
      <td rowspan="9"><a data-link-type="dfn" href="#iso-8859-3" id="ref-for-iso-8859-3-1">ISO-8859-3</a> 
      <td>"<code>csisolatin3</code>" 
     <tr>
      <td>"<code>iso-8859-3</code>" 
     <tr>
      <td>"<code>iso-ir-109</code>" 
     <tr>
      <td>"<code>iso8859-3</code>" 
     <tr>
      <td>"<code>iso88593</code>" 
     <tr>
      <td>"<code>iso_8859-3</code>" 
     <tr>
      <td>"<code>iso_8859-3:1988</code>" 
     <tr>
      <td>"<code>l3</code>" 
     <tr>
      <td>"<code>latin3</code>" 
     <tr>
      <td rowspan="9"><a data-link-type="dfn" href="#iso-8859-4" id="ref-for-iso-8859-4-1">ISO-8859-4</a> 
      <td>"<code>csisolatin4</code>" 
     <tr>
      <td>"<code>iso-8859-4</code>" 
     <tr>
      <td>"<code>iso-ir-110</code>" 
     <tr>
      <td>"<code>iso8859-4</code>" 
     <tr>
      <td>"<code>iso88594</code>" 
     <tr>
      <td>"<code>iso_8859-4</code>" 
     <tr>
      <td>"<code>iso_8859-4:1988</code>" 
     <tr>
      <td>"<code>l4</code>" 
     <tr>
      <td>"<code>latin4</code>" 
     <tr>
      <td rowspan="8"><a data-link-type="dfn" href="#iso-8859-5" id="ref-for-iso-8859-5-1">ISO-8859-5</a> 
      <td>"<code>csisolatincyrillic</code>" 
     <tr>
      <td>"<code>cyrillic</code>" 
     <tr>
      <td>"<code>iso-8859-5</code>" 
     <tr>
      <td>"<code>iso-ir-144</code>" 
     <tr>
      <td>"<code>iso8859-5</code>" 
     <tr>
      <td>"<code>iso88595</code>" 
     <tr>
      <td>"<code>iso_8859-5</code>" 
     <tr>
      <td>"<code>iso_8859-5:1988</code>" 
     <tr>
      <td rowspan="14"><a data-link-type="dfn" href="#iso-8859-6" id="ref-for-iso-8859-6-1">ISO-8859-6</a> 
      <td>"<code>arabic</code>" 
     <tr>
      <td>"<code>asmo-708</code>" 
     <tr>
      <td>"<code>csiso88596e</code>" 
     <tr>
      <td>"<code>csiso88596i</code>" 
     <tr>
      <td>"<code>csisolatinarabic</code>" 
     <tr>
      <td>"<code>ecma-114</code>" 
     <tr>
      <td>"<code>iso-8859-6</code>" 
     <tr>
      <td>"<code>iso-8859-6-e</code>" 
     <tr>
      <td>"<code>iso-8859-6-i</code>" 
     <tr>
      <td>"<code>iso-ir-127</code>" 
     <tr>
      <td>"<code>iso8859-6</code>" 
     <tr>
      <td>"<code>iso88596</code>" 
     <tr>
      <td>"<code>iso_8859-6</code>" 
     <tr>
      <td>"<code>iso_8859-6:1987</code>" 
     <tr>
      <td rowspan="12"><a data-link-type="dfn" href="#iso-8859-7" id="ref-for-iso-8859-7-1">ISO-8859-7</a> 
      <td>"<code>csisolatingreek</code>" 
     <tr>
      <td>"<code>ecma-118</code>" 
     <tr>
      <td>"<code>elot_928</code>" 
     <tr>
      <td>"<code>greek</code>" 
     <tr>
      <td>"<code>greek8</code>" 
     <tr>
      <td>"<code>iso-8859-7</code>" 
     <tr>
      <td>"<code>iso-ir-126</code>" 
     <tr>
      <td>"<code>iso8859-7</code>" 
     <tr>
      <td>"<code>iso88597</code>" 
     <tr>
      <td>"<code>iso_8859-7</code>" 
     <tr>
      <td>"<code>iso_8859-7:1987</code>" 
     <tr>
      <td>"<code>sun_eu_greek</code>" 
     <tr>
      <td rowspan="11"><a data-link-type="dfn" href="#iso-8859-8" id="ref-for-iso-8859-8-1">ISO-8859-8</a> 
      <td>"<code>csiso88598e</code>" 
     <tr>
      <td>"<code>csisolatinhebrew</code>" 
     <tr>
      <td>"<code>hebrew</code>" 
     <tr>
      <td>"<code>iso-8859-8</code>" 
     <tr>
      <td>"<code>iso-8859-8-e</code>" 
     <tr>
      <td>"<code>iso-ir-138</code>" 
     <tr>
      <td>"<code>iso8859-8</code>" 
     <tr>
      <td>"<code>iso88598</code>" 
     <tr>
      <td>"<code>iso_8859-8</code>" 
     <tr>
      <td>"<code>iso_8859-8:1988</code>" 
     <tr>
      <td>"<code>visual</code>" 
     <tr>
      <td rowspan="3"><a data-link-type="dfn" href="#iso-8859-8-i" id="ref-for-iso-8859-8-i-1">ISO-8859-8-I</a> 
      <td>"<code>csiso88598i</code>" 
     <tr>
      <td>"<code>iso-8859-8-i</code>" 
     <tr>
      <td>"<code>logical</code>" 
     <tr>
      <td rowspan="7"><a data-link-type="dfn" href="#iso-8859-10" id="ref-for-iso-8859-10-1">ISO-8859-10</a> 
      <td>"<code>csisolatin6</code>" 
     <tr>
      <td>"<code>iso-8859-10</code>" 
     <tr>
      <td>"<code>iso-ir-157</code>" 
     <tr>
      <td>"<code>iso8859-10</code>" 
     <tr>
      <td>"<code>iso885910</code>" 
     <tr>
      <td>"<code>l6</code>" 
     <tr>
      <td>"<code>latin6</code>" 
     <tr>
      <td rowspan="3"><a data-link-type="dfn" href="#iso-8859-13" id="ref-for-iso-8859-13-1">ISO-8859-13</a> 
      <td>"<code>iso-8859-13</code>" 
     <tr>
      <td>"<code>iso8859-13</code>" 
     <tr>
      <td>"<code>iso885913</code>" 
     <tr>
      <td rowspan="3"><a data-link-type="dfn" href="#iso-8859-14" id="ref-for-iso-8859-14-1">ISO-8859-14</a> 
      <td>"<code>iso-8859-14</code>" 
     <tr>
      <td>"<code>iso8859-14</code>" 
     <tr>
      <td>"<code>iso885914</code>" 
     <tr>
      <td rowspan="6"><a data-link-type="dfn" href="#iso-8859-15" id="ref-for-iso-8859-15-1">ISO-8859-15</a> 
      <td>"<code>csisolatin9</code>" 
     <tr>
      <td>"<code>iso-8859-15</code>" 
     <tr>
      <td>"<code>iso8859-15</code>" 
     <tr>
      <td>"<code>iso885915</code>" 
     <tr>
      <td>"<code>iso_8859-15</code>" 
     <tr>
      <td>"<code>l9</code>" 
     <tr>
      <td><a data-link-type="dfn" href="#iso-8859-16" id="ref-for-iso-8859-16-1">ISO-8859-16</a> 
      <td>"<code>iso-8859-16</code>" 
     <tr>
      <td rowspan="5"><a data-link-type="dfn" href="#koi8-r" id="ref-for-koi8-r-1">KOI8-R</a> 
      <td>"<code>cskoi8r</code>" 
     <tr>
      <td>"<code>koi</code>" 
     <tr>
      <td>"<code>koi8</code>" 
     <tr>
      <td>"<code>koi8-r</code>" 
     <tr>
      <td>"<code>koi8_r</code>" 
     <tr>
      <td rowspan="2"><a data-link-type="dfn" href="#koi8-u" id="ref-for-koi8-u-1">KOI8-U</a> 
      <td>"<code>koi8-ru</code>" 
     <tr>
      <td>"<code>koi8-u</code>" 
     <tr>
      <td rowspan="4"><a data-link-type="dfn" href="#macintosh" id="ref-for-macintosh-1">macintosh</a> 
      <td>"<code>csmacintosh</code>" 
     <tr>
      <td>"<code>mac</code>" 
     <tr>
      <td>"<code>macintosh</code>" 
     <tr>
      <td>"<code>x-mac-roman</code>" 
     <tr>
      <td rowspan="6"><a data-link-type="dfn" href="#windows-874" id="ref-for-windows-874-1">windows-874</a> 
      <td>"<code>dos-874</code>" 
     <tr>
      <td>"<code>iso-8859-11</code>" 
     <tr>
      <td>"<code>iso8859-11</code>" 
     <tr>
      <td>"<code>iso885911</code>" 
     <tr>
      <td>"<code>tis-620</code>" 
     <tr>
      <td>"<code>windows-874</code>" 
     <tr>
      <td rowspan="3"><a data-link-type="dfn" href="#windows-1250" id="ref-for-windows-1250-1">windows-1250</a> 
      <td>"<code>cp1250</code>" 
     <tr>
      <td>"<code>windows-1250</code>" 
     <tr>
      <td>"<code>x-cp1250</code>" 
     <tr>
      <td rowspan="3"><a data-link-type="dfn" href="#windows-1251" id="ref-for-windows-1251-1">windows-1251</a> 
      <td>"<code>cp1251</code>" 
     <tr>
      <td>"<code>windows-1251</code>" 
     <tr>
      <td>"<code>x-cp1251</code>" 
     <tr>
      <td rowspan="17"><a data-link-type="dfn" href="#windows-1252" id="ref-for-windows-1252-2">windows-1252</a> 
      <td>"<code>ansi_x3.4-1968</code>" 
     <tr>
      <td>"<code>ascii</code>" 
     <tr>
      <td>"<code>cp1252</code>" 
     <tr>
      <td>"<code>cp819</code>" 
     <tr>
      <td>"<code>csisolatin1</code>" 
     <tr>
      <td>"<code>ibm819</code>" 
     <tr>
      <td>"<code>iso-8859-1</code>" 
     <tr>
      <td>"<code>iso-ir-100</code>" 
     <tr>
      <td>"<code>iso8859-1</code>" 
     <tr>
      <td>"<code>iso88591</code>" 
     <tr>
      <td>"<code>iso_8859-1</code>" 
     <tr>
      <td>"<code>iso_8859-1:1987</code>" 
     <tr>
      <td>"<code>l1</code>" 
     <tr>
      <td>"<code>latin1</code>" 
     <tr>
      <td>"<code>us-ascii</code>" 
     <tr>
      <td>"<code>windows-1252</code>" 
     <tr>
      <td>"<code>x-cp1252</code>" 
     <tr>
      <td rowspan="3"><a data-link-type="dfn" href="#windows-1253" id="ref-for-windows-1253-1">windows-1253</a> 
      <td>"<code>cp1253</code>" 
     <tr>
      <td>"<code>windows-1253</code>" 
     <tr>
      <td>"<code>x-cp1253</code>" 
     <tr>
      <td rowspan="12"><a data-link-type="dfn" href="#windows-1254" id="ref-for-windows-1254-1">windows-1254</a> 
      <td>"<code>cp1254</code>" 
     <tr>
      <td>"<code>csisolatin5</code>" 
     <tr>
      <td>"<code>iso-8859-9</code>" 
     <tr>
      <td>"<code>iso-ir-148</code>" 
     <tr>
      <td>"<code>iso8859-9</code>" 
     <tr>
      <td>"<code>iso88599</code>" 
     <tr>
      <td>"<code>iso_8859-9</code>" 
     <tr>
      <td>"<code>iso_8859-9:1989</code>" 
     <tr>
      <td>"<code>l5</code>" 
     <tr>
      <td>"<code>latin5</code>" 
     <tr>
      <td>"<code>windows-1254</code>" 
     <tr>
      <td>"<code>x-cp1254</code>" 
     <tr>
      <td rowspan="3"><a data-link-type="dfn" href="#windows-1255" id="ref-for-windows-1255-1">windows-1255</a> 
      <td>"<code>cp1255</code>" 
     <tr>
      <td>"<code>windows-1255</code>" 
     <tr>
      <td>"<code>x-cp1255</code>" 
     <tr>
      <td rowspan="3"><a data-link-type="dfn" href="#windows-1256" id="ref-for-windows-1256-1">windows-1256</a> 
      <td>"<code>cp1256</code>" 
     <tr>
      <td>"<code>windows-1256</code>" 
     <tr>
      <td>"<code>x-cp1256</code>" 
     <tr>
      <td rowspan="3"><a data-link-type="dfn" href="#windows-1257" id="ref-for-windows-1257-1">windows-1257</a> 
      <td>"<code>cp1257</code>" 
     <tr>
      <td>"<code>windows-1257</code>" 
     <tr>
      <td>"<code>x-cp1257</code>" 
     <tr>
      <td rowspan="3"><a data-link-type="dfn" href="#windows-1258" id="ref-for-windows-1258-1">windows-1258</a> 
      <td>"<code>cp1258</code>" 
     <tr>
      <td>"<code>windows-1258</code>" 
     <tr>
      <td>"<code>x-cp1258</code>" 
     <tr>
      <td rowspan="2"><a data-link-type="dfn" href="#x-mac-cyrillic" id="ref-for-x-mac-cyrillic-1">x-mac-cyrillic</a> 
      <td>"<code>x-mac-cyrillic</code>" 
     <tr>
      <td>"<code>x-mac-ukrainian</code>" 
    <tbody>
     <tr>
      <th colspan="2"><a href="#legacy-multi-byte-chinese-(simplified)-encodings">Legacy multi-byte Chinese (simplified) encodings</a> 
     <tr>
      <td rowspan="9"><a data-link-type="dfn" href="#gbk" id="ref-for-gbk-1">GBK</a> 
      <td>"<code>chinese</code>" 
     <tr>
      <td>"<code>csgb2312</code>" 
     <tr>
      <td>"<code>csiso58gb231280</code>" 
     <tr>
      <td>"<code>gb2312</code>" 
     <tr>
      <td>"<code>gb_2312</code>" 
     <tr>
      <td>"<code>gb_2312-80</code>" 
     <tr>
      <td>"<code>gbk</code>" 
     <tr>
      <td>"<code>iso-ir-58</code>" 
     <tr>
      <td>"<code>x-gbk</code>" 
     <tr>
      <td><a data-link-type="dfn" href="#gb18030" id="ref-for-gb18030-1">gb18030</a> 
      <td>"<code>gb18030</code>" 
    <tbody>
     <tr>
      <th colspan="2"><a href="#legacy-multi-byte-chinese-(traditional)-encodings">Legacy multi-byte Chinese (traditional) encodings</a> 
     <tr>
      <td rowspan="5"><a data-link-type="dfn" href="#big5" id="ref-for-big5-1">Big5</a> 
      <td>"<code>big5</code>" 
     <tr>
      <td>"<code>big5-hkscs</code>" 
     <tr>
      <td>"<code>cn-big5</code>" 
     <tr>
      <td>"<code>csbig5</code>" 
     <tr>
      <td>"<code>x-x-big5</code>" 
    <tbody>
     <tr>
      <th colspan="2"><a href="#legacy-multi-byte-japanese-encodings">Legacy multi-byte Japanese encodings</a> 
     <tr>
      <td rowspan="3"><a data-link-type="dfn" href="#euc-jp" id="ref-for-euc-jp-1">EUC-JP</a> 
      <td>"<code>cseucpkdfmtjapanese</code>" 
     <tr>
      <td>"<code>euc-jp</code>" 
     <tr>
      <td>"<code>x-euc-jp</code>" 
     <tr>
      <td rowspan="2"><a data-link-type="dfn" href="#iso-2022-jp" id="ref-for-iso-2022-jp-2">ISO-2022-JP</a> 
      <td>"<code>csiso2022jp</code>" 
     <tr>
      <td>"<code>iso-2022-jp</code>" 
     <tr>
      <td rowspan="8"><a data-link-type="dfn" href="#shift_jis" id="ref-for-shift_jis-2">Shift_JIS</a> 
      <td>"<code>csshiftjis</code>" 
     <tr>
      <td>"<code>ms932</code>" 
     <tr>
      <td>"<code>ms_kanji</code>" 
     <tr>
      <td>"<code>shift-jis</code>" 
     <tr>
      <td>"<code>shift_jis</code>" 
     <tr>
      <td>"<code>sjis</code>" 
     <tr>
      <td>"<code>windows-31j</code>" 
     <tr>
      <td>"<code>x-sjis</code>" 
    <tbody>
     <tr>
      <th colspan="2"><a href="#legacy-multi-byte-korean-encodings">Legacy multi-byte Korean encodings</a> 
     <tr>
      <td rowspan="10"><a data-link-type="dfn" href="#euc-kr" id="ref-for-euc-kr-1">EUC-KR</a> 
      <td>"<code>cseuckr</code>" 
     <tr>
      <td>"<code>csksc56011987</code>" 
     <tr>
      <td>"<code>euc-kr</code>" 
     <tr>
      <td>"<code>iso-ir-149</code>" 
     <tr>
      <td>"<code>korean</code>" 
     <tr>
      <td>"<code>ks_c_5601-1987</code>" 
     <tr>
      <td>"<code>ks_c_5601-1989</code>" 
     <tr>
      <td>"<code>ksc5601</code>" 
     <tr>
      <td>"<code>ksc_5601</code>" 
     <tr>
      <td>"<code>windows-949</code>" 
    <tbody>
     <tr>
      <th colspan="2"><a href="#legacy-miscellaneous-encodings">Legacy miscellaneous encodings</a> 
     <tr>
      <td rowspan="5"><a data-link-type="dfn" href="#replacement" id="ref-for-replacement-3">replacement</a> 
      <td>"<code>csiso2022kr</code>" 
     <tr>
      <td>"<code>hz-gb-2312</code>" 
     <tr>
      <td>"<code>iso-2022-cn</code>" 
     <tr>
      <td>"<code>iso-2022-cn-ext</code>" 
     <tr>
      <td>"<code>iso-2022-kr</code>" 
     <tr>
      <td><a data-link-type="dfn" href="#utf-16be" id="ref-for-utf-16be-3">UTF-16BE</a> 
      <td>"<code>utf-16be</code>" 
     <tr>
      <td rowspan="2"><a data-link-type="dfn" href="#utf-16le" id="ref-for-utf-16le-3">UTF-16LE</a> 
      <td>"<code>utf-16</code>" 
     <tr>
      <td>"<code>utf-16le</code>" 
     <tr>
      <td><a data-link-type="dfn" href="#x-user-defined" id="ref-for-x-user-defined-1">x-user-defined</a> 
      <td>"<code>x-user-defined</code>" 
   </table>
   <p class="note" role="note">All <a data-link-type="dfn" href="#encoding" id="ref-for-encoding-14">encodings</a> and their <a data-link-type="dfn" href="#label" id="ref-for-label-8">labels</a> are also available as non-normative <a href="https://encoding.spec.whatwg.org/encodings.json">encodings.json</a> resource. </p>
   <h3 class="heading settled" data-level="4.3" id="output-encodings"><span class="secno">4.3. </span><span class="content">Output encodings</span><a class="self-link" href="#output-encodings"></a></h3>
   <p>To <dfn class="dfn-paneled" data-dfn-type="dfn" data-export="" id="get-an-output-encoding">get an output encoding</dfn> from an <a data-link-type="dfn" href="#encoding" id="ref-for-encoding-15">encoding</a> <var>encoding</var>, run these steps: </p>
   <ol>
    <li>
     <p>If <var>encoding</var> is <a data-link-type="dfn" href="#replacement" id="ref-for-replacement-4">replacement</a>, <a data-link-type="dfn" href="#utf-16be" id="ref-for-utf-16be-4">UTF-16BE</a>, or <a data-link-type="dfn" href="#utf-16le" id="ref-for-utf-16le-4">UTF-16LE</a>, return <a data-link-type="dfn" href="#utf-8" id="ref-for-utf-8-5">UTF-8</a>. </p>
    <li>
     <p>Return <var>encoding</var>. </p>
   </ol>
   <p class="note" role="note">The <a data-link-type="dfn" href="#get-an-output-encoding" id="ref-for-get-an-output-encoding-1">get an output encoding</a> algorithm is useful for URL parsing and HTML
form submission, which both need exactly this. </p>
   <h2 class="heading settled" data-level="5" id="indexes"><span class="secno">5. </span><span class="content">Indexes</span><a class="self-link" href="#indexes"></a></h2>
   <p>Most legacy <a data-link-type="dfn" href="#encoding" id="ref-for-encoding-16">encodings</a> make use of an <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport="" id="index">index</dfn>. An <a data-link-type="dfn" href="#index" id="ref-for-index-1">index</a> is an ordered list of entries, each entry consisting of a pointer and a
corresponding code point. Within an <a data-link-type="dfn" href="#index" id="ref-for-index-2">index</a> pointers are unique and code points can be
duplicated. </p>
   <p class="note no-backref" role="note">An efficient implementation likely has two <a data-link-type="dfn" href="#index" id="ref-for-index-3">indexes</a> per <a data-link-type="dfn" href="#encoding" id="ref-for-encoding-17">encoding</a>. One optimized for its <a data-link-type="dfn" href="#decoder" id="ref-for-decoder-7">decoder</a> and one for its <a data-link-type="dfn" href="#encoder" id="ref-for-encoder-7">encoder</a>. </p>
   <p>To find the pointers and their corresponding code points in an <a data-link-type="dfn" href="#index" id="ref-for-index-4">index</a>,
let <var>lines</var> be the result of splitting the resource’s contents on U+000A.
Then remove each item in <var>lines</var> that is the empty string or starts with U+0023.
Then the pointers and their corresponding code points are found by splitting each item in <var>lines</var> on U+0009.
The first subitem is the pointer (as a decimal number) and the second is the corresponding code point (as a hexadecimal number).
Other subitems are not relevant. </p>
   <p class="note no-backref" role="note">To signify changes an <a data-link-type="dfn" href="#index" id="ref-for-index-5">index</a> includes an <i>Identifier</i> and a <i>Date</i>. If an <i>Identifier</i> has
changed, so has the <a data-link-type="dfn" href="#index" id="ref-for-index-6">index</a>. </p>
   <p>The <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport="" id="index-code-point">index code point</dfn> for <var>pointer</var> in <var>index</var> is the code point corresponding to <var>pointer</var> in <var>index</var>, or null if <var>pointer</var> is not in <var>index</var>. </p>
   <p>The <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport="" id="index-pointer">index pointer</dfn> for <var>code point</var> in <var>index</var> is the <em>first</em> pointer corresponding to <var>code point</var> in <var>index</var>, or null if <var>code point</var> is not in <var>index</var>. </p>
   <div class="note" id="visualization" role="note">
    <a class="self-link" href="#visualization"></a> 
    <p>There is a non-normative visualization for each <a data-link-type="dfn" href="#index" id="ref-for-index-7">index</a> other than <a data-link-type="dfn" href="#index-gb18030-ranges" id="ref-for-index-gb18030-ranges-1">index gb18030 ranges</a> and <a data-link-type="dfn" href="#index-iso-2022-jp-katakana" id="ref-for-index-iso-2022-jp-katakana-1">index ISO-2022-JP katakana</a>. <a data-link-type="dfn" href="#index-jis0208" id="ref-for-index-jis0208-1">index jis0208</a> also has an
 alternative <a data-link-type="dfn" href="#shift_jis" id="ref-for-shift_jis-3">Shift_JIS</a> visualization. Additionally, there is visualization of the Basic
 Multilingual Plane coverage of each index other than <a data-link-type="dfn" href="#index-gb18030-ranges" id="ref-for-index-gb18030-ranges-2">index gb18030 ranges</a> and <a data-link-type="dfn" href="#index-iso-2022-jp-katakana" id="ref-for-index-iso-2022-jp-katakana-2">index ISO-2022-JP katakana</a>. </p>
    <p>The legend for the visualizations is: </p>
    <ul class="visualizationlegend">
     <li class="unmapped">Unmapped 
     <li class="mid">Two bytes in UTF-8 
     <li class="mid contiguous">Two bytes in UTF-8, code point follows immediately the code point of
  previous pointer 
     <li class="upper">Three bytes in UTF-8 (non-PUA) 
     <li class="upper contiguous">Three bytes in UTF-8 (non-PUA), code point follows immediately the
  code point of previous pointer 
     <li class="pua">Private Use 
     <li class="pua contiguous">Private Use, code point follows immediately the code point of previous
  pointer 
     <li class="astral">Four bytes in UTF-8 
     <li class="astral contiguous">Four bytes in UTF-8, code point follows immediately the code point
  of previous pointer 
     <li class="duplicate">Duplicate code point already mapped at an earlier index 
     <li class="compatibility">CJK Compatibility Ideograph 
     <li class="ext">CJK Unified Ideographs Extension A 
    </ul>
   </div>
   <p>These are the <a data-link-type="dfn" href="#index" id="ref-for-index-8">indexes</a> defined by this
specification, excluding <a data-link-type="dfn" href="#index-single-byte" id="ref-for-index-single-byte-1">index single-byte</a>, which have their own table: </p>
   <table>
    <tbody>
     <tr>
      <th colspan="4"><a data-link-type="dfn" href="#index" id="ref-for-index-9">Index</a>
      <th>Notes 
     <tr>
      <td><dfn class="dfn-paneled" data-dfn-type="dfn" data-export="" id="index-big5">index Big5</dfn> 
      <td><a href="https://encoding.spec.whatwg.org/index-big5.txt">index-big5.txt</a> 
      <td><a href="big5.html">index Big5 visualization</a> 
      <td><a href="big5-bmp.html">index Big5 BMP coverage</a> 
      <td>This matches the Big5 standard in combination with the
  Hong Kong Supplementary Character Set and other common extensions. 
     <tr>
      <td><dfn class="dfn-paneled" data-dfn-type="dfn" data-export="" id="index-euc-kr">index EUC-KR</dfn> 
      <td><a href="https://encoding.spec.whatwg.org/index-euc-kr.txt">index-euc-kr.txt</a> 
      <td><a href="euc-kr.html">index EUC-KR visualization</a> 
      <td><a href="euc-kr-bmp.html">index EUC-KR BMP coverage</a> 
      <td>This matches the KS X 1001 standard and the Unified Hangul Code, more commonly known together
  as Windows Codepage 949. It covers the Hangul Syllables block of Unicode in its entirety. The
  Hangul block whose top left corner in the visualization is at pointer 9026 is in the Unicode
  order. Taken separately, the rest of the Hangul syllables in this index are in the Unicode order,
  too. 
     <tr>
      <td><dfn class="dfn-paneled" data-dfn-type="dfn" data-export="" id="index-gb18030">index gb18030</dfn> 
      <td><a href="https://encoding.spec.whatwg.org/index-gb18030.txt">index-gb18030.txt</a> 
      <td><a href="gb18030.html">index gb18030 visualization</a> 
      <td><a href="gb18030-bmp.html">index gb18030 BMP coverage</a> 
      <td>This matches the GB18030-2005 standard for code points encoded as two bytes, except for
  0xA3 0xA0 which maps to U+3000 to be compatible with deployed content. This index covers the
  CJK Unified Ideographs block of Unicode in its entirety. Entries from that block that are above or
  to the left of (the first) U+3000 in the visualization are in the Unicode order. 
     <tr>
      <td><dfn class="dfn-paneled" data-dfn-type="dfn" data-export="" id="index-gb18030-ranges">index gb18030 ranges</dfn> 
      <td colspan="3"><a href="https://encoding.spec.whatwg.org/index-gb18030-ranges.txt">index-gb18030-ranges.txt</a> 
      <td>This <a data-link-type="dfn" href="#index" id="ref-for-index-10">index</a> works different from all others. Listing all code points would result
  in over a million items whereas they can be represented neatly in 207 ranges combined with trivial
  limit checks. It therefore only superficially matches the GB18030-2005 standard for code points
  encoded as four bytes. See also <a data-link-type="dfn" href="#index-gb18030-ranges-code-point" id="ref-for-index-gb18030-ranges-code-point-1">index gb18030 ranges code point</a> and <a data-link-type="dfn" href="#index-gb18030-ranges-pointer" id="ref-for-index-gb18030-ranges-pointer-1">index gb18030 ranges pointer</a> below. 
     <tr>
      <td><dfn class="dfn-paneled" data-dfn-type="dfn" data-export="" id="index-jis0208">index jis0208</dfn> 
      <td><a href="https://encoding.spec.whatwg.org/index-jis0208.txt">index-jis0208.txt</a> 
      <td><a href="jis0208.html">index jis0208 visualization</a>, <a href="shift_jis.html">Shift_JIS visualization</a> 
      <td><a href="jis0208-bmp.html">index jis0208 BMP coverage</a> 
      <td>This is the JIS X 0208 standard including formerly proprietary
  extensions from IBM and NEC. 
     <tr>
      <td><dfn class="dfn-paneled" data-dfn-type="dfn" data-export="" id="index-jis0212">index jis0212</dfn> 
      <td><a href="https://encoding.spec.whatwg.org/index-jis0212.txt">index-jis0212.txt</a> 
      <td><a href="jis0212.html">index jis0212 visualization</a> 
      <td><a href="jis0212-bmp.html">index jis0212 BMP coverage</a> 
      <td>This is the JIS X 0212 standard. It is only used by the <a data-link-type="dfn" href="#euc-jp-decoder" id="ref-for-euc-jp-decoder-1">EUC-JP decoder</a> due to lack of widespread support elsewhere. 
     <tr>
      <td><dfn class="dfn-paneled" data-dfn-type="dfn" data-export="" id="index-iso-2022-jp-katakana">index ISO-2022-JP katakana</dfn> 
      <td colspan="3"><a href="https://encoding.spec.whatwg.org/index-iso-2022-jp-katakana.txt">index-iso-2022-jp-katakana.txt</a> 
      <td>This maps halfwidth to fullwidth katakana as per Unicode Normalization Form KC, except that
  U+FF9E and U+FF9F map to U+309B and U+309C rather than U+3099 and U+309A. It is only used by the <a data-link-type="dfn" href="#iso-2022-jp-encoder" id="ref-for-iso-2022-jp-encoder-1">ISO-2022-JP encoder</a>. <a data-link-type="biblio" href="#biblio-unicode">[UNICODE]</a> 
   </table>
   <p>The <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport="" id="index-gb18030-ranges-code-point">index gb18030 ranges code point</dfn> for <var>pointer</var> is
the return value of these steps: </p>
   <ol>
    <li>
     <p>If <var>pointer</var> is greater than 39419 and less than
 189000, or <var>pointer</var> is greater than 1237575, return null. </p>
    <li>
     <p>If <var>pointer</var> is 7457, return code point U+E7C7. </p>
    <li>
     <p>Let <var>offset</var> be the last pointer in <a data-link-type="dfn" href="#index-gb18030-ranges" id="ref-for-index-gb18030-ranges-3">index gb18030 ranges</a> that is equal to or less than <var>pointer</var> and let <var>code point offset</var> be its
 corresponding code point. </p>
    <li>
     <p>Return a code point whose value is <var>code point offset</var> + <var>pointer</var> − <var>offset</var>. </p>
   </ol>
   <p>The <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport="" id="index-gb18030-ranges-pointer">index gb18030 ranges pointer</dfn> for <var>code point</var> is
the return value of these steps: </p>
   <ol>
    <li>
     <p>If <var>code point</var> is U+E7C7, return pointer 7457. </p>
    <li>
     <p>Let <var>offset</var> be the last code point in <a data-link-type="dfn" href="#index-gb18030-ranges" id="ref-for-index-gb18030-ranges-4">index gb18030 ranges</a> that is equal to or less than <var>code point</var> and let <var>pointer offset</var> be its
 corresponding pointer. </p>
    <li>
     <p>Return a pointer whose value is <var>pointer offset</var> + <var>code point</var> − <var>offset</var>. </p>
   </ol>
   <p>The <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport="" id="index-shift_jis-pointer">index Shift_JIS pointer</dfn> for <var>code point</var> is the return value of these
steps: </p>
   <ol>
    <li>
     <p>Let <var>index</var> be <a data-link-type="dfn" href="#index-jis0208" id="ref-for-index-jis0208-2">index jis0208</a> excluding all entries whose pointer is in
  the range 8272 to 8835, inclusive. </p>
     <p class="note" role="note">The <a data-link-type="dfn" href="#index-jis0208" id="ref-for-index-jis0208-3">index jis0208</a> contains duplicate code points so the exclusion of
  these entries causes later code points to be used. </p>
    <li>
     <p>Return the <a data-link-type="dfn" href="#index-pointer" id="ref-for-index-pointer-1">index pointer</a> for <var>code point</var> in <var>index</var>. </p>
   </ol>
   <p>The <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport="" id="index-big5-pointer">index Big5 pointer</dfn> for <var>code point</var> is the return value of
these steps: </p>
   <ol>
    <li>
     <p>Let <var>index</var> be <a data-link-type="dfn" href="#index-big5" id="ref-for-index-big5-1">index Big5</a> excluding all entries whose pointer is less
  than (0xA1 - 0x81) × 157. </p>
     <p class="note" role="note">Avoid returning Hong Kong Supplementary Character Set extensions literally. </p>
    <li>
     <p>If <var>code point</var> is U+2550, U+255E, U+2561, U+256A, U+5341, or U+5345,
  return the <em>last</em> pointer corresponding to <var>code point</var> in <var>index</var>. </p>
     <p class="note" role="note">There are other duplicate code points, but for those the <em>first</em> pointer is
  to be used. </p>
    <li>
     <p>Return the <a data-link-type="dfn" href="#index-pointer" id="ref-for-index-pointer-2">index pointer</a> for <var>code point</var> in <var>index</var>. </p>
   </ol>
   <hr>
   <p class="note no-backref" role="note">All <a data-link-type="dfn" href="#index" id="ref-for-index-11">indexes</a> are also available as a non-normative <a href="https://encoding.spec.whatwg.org/indexes.json">indexes.json</a> resource. (<a data-link-type="dfn" href="#index-gb18030-ranges" id="ref-for-index-gb18030-ranges-5">Index gb18030 ranges</a> has a slightly
different format here, to be able to represent ranges.) </p>
   <h2 class="heading settled" data-level="6" id="specification-hooks"><span class="secno">6. </span><span class="content">Specification hooks</span><a class="self-link" href="#specification-hooks"></a></h2>
   <p class="note" role="note">The algorithms <a data-link-type="dfn" href="#decode" id="ref-for-decode-1">decode</a>, <a data-link-type="dfn" href="#utf-8-decode" id="ref-for-utf-8-decode-1">UTF-8 decode</a>, <a data-link-type="dfn" href="#utf-8-decode-without-bom" id="ref-for-utf-8-decode-without-bom-1">UTF-8 decode without BOM</a>, <a data-link-type="dfn" href="#utf-8-decode-without-bom-or-fail" id="ref-for-utf-8-decode-without-bom-or-fail-1">UTF-8 decode without BOM or fail</a>, <a data-link-type="dfn" href="#encode" id="ref-for-encode-1">encode</a>, and <a data-link-type="dfn" href="#utf-8-encode" id="ref-for-utf-8-encode-1">UTF-8 encode</a> are intended for usage by other specifications. <a data-link-type="dfn" href="#utf-8-decode" id="ref-for-utf-8-decode-2">UTF-8 decode</a> is to be used by new formats. The <a data-link-type="dfn" href="#concept-encoding-get" id="ref-for-concept-encoding-get-1">get an encoding</a> algorithm can be used first to turn a <a data-link-type="dfn" href="#label" id="ref-for-label-9">label</a> into an <a data-link-type="dfn" href="#encoding" id="ref-for-encoding-18">encoding</a>. </p>
   <p>To <dfn class="dfn-paneled" data-dfn-type="dfn" data-export="" id="decode">decode</dfn> a byte stream <var>stream</var> using
fallback encoding <var>encoding</var>, run these steps: </p>
   <ol>
    <li>
     <p>Let <var>buffer</var> be an empty byte sequence. </p>
    <li>
     <p>Let <var>BOM seen flag</var> be unset. </p>
    <li>
     <p><a data-link-type="dfn" href="#concept-stream-read" id="ref-for-concept-stream-read-2">Read</a> bytes from <var>stream</var> into <var>buffer</var> until either <var>buffer</var> contains three bytes or <a data-link-type="dfn" href="#concept-stream-read" id="ref-for-concept-stream-read-3">read</a> returns <a data-link-type="dfn" href="#end-of-stream" id="ref-for-end-of-stream-2">end-of-stream</a>. </p>
    <li>
     <p>For each of the rows in the table below, starting with the first
  one and going down, if the first bytes of <var>buffer</var> match
  all the bytes given in the first column, then set <var>encoding</var> to the <a data-link-type="dfn" href="#encoding" id="ref-for-encoding-19">encoding</a> given in the cell in the second column of
  that row and set <var>BOM seen flag</var>. </p>
     <table>
      <tbody>
       <tr>
        <th>Byte order mark
        <th>Encoding 
       <tr>
        <td>0xEF 0xBB 0xBF
        <td><a data-link-type="dfn" href="#utf-8" id="ref-for-utf-8-6">UTF-8</a> 
       <tr>
        <td>0xFE 0xFF
        <td><a data-link-type="dfn" href="#utf-16be" id="ref-for-utf-16be-5">UTF-16BE</a> 
       <tr>
        <td>0xFF 0xFE
        <td><a data-link-type="dfn" href="#utf-16le" id="ref-for-utf-16le-5">UTF-16LE</a> 
     </table>
     <p class="note" role="note">For compatibility with deployed content, the byte order mark (also known as BOM) is
  more authoritative than anything else. In a context where HTTP is used this is in violation of the
  semantics of the `<code>Content-Type</code>` header. </p>
    <li>
     <p>If <var>BOM seen flag</var> is unset <a data-link-type="dfn" href="#concept-stream-prepend" id="ref-for-concept-stream-prepend-2">prepend</a> <var>buffer</var> to <var>stream</var>. </p>
    <li>
     <p>Otherwise, if <var>BOM seen flag</var> is set, <var>encoding</var> is not <a data-link-type="dfn" href="#utf-8" id="ref-for-utf-8-7">UTF-8</a>, and <var>buffer</var> contains three bytes, <a data-link-type="dfn" href="#concept-stream-prepend" id="ref-for-concept-stream-prepend-3">prepend</a> the last byte of <var>buffer</var> to <var>stream</var>. </p>
    <li>
     <p>Let <var>output</var> be a code point <a data-link-type="dfn" href="#concept-stream" id="ref-for-concept-stream-10">stream</a>. </p>
    <li>
     <p><a data-link-type="dfn" href="#concept-encoding-run" id="ref-for-concept-encoding-run-1">Run</a> <var>encoding</var>’s <a data-link-type="dfn" href="#decoder" id="ref-for-decoder-8">decoder</a> with <var>stream</var> and <var>output</var>. </p>
    <li>
     <p>Return <var>output</var>. </p>
   </ol>
   <p>To <dfn class="dfn-paneled" data-dfn-type="dfn" data-export="" id="utf-8-decode">UTF-8 decode</dfn> a byte stream <var>stream</var>, run
these steps: </p>
   <ol>
    <li>
     <p>Let <var>buffer</var> be an empty byte sequence. </p>
    <li>
     <p><a data-link-type="dfn" href="#concept-stream-read" id="ref-for-concept-stream-read-4">Read</a> three bytes from <var>stream</var> into <var>buffer</var>. </p>
    <li>
     <p>If <var>buffer</var> does not match 0xEF 0xBB 0xBF, <a data-link-type="dfn" href="#concept-stream-prepend" id="ref-for-concept-stream-prepend-4">prepend</a> <var>buffer</var> to <var>stream</var>. </p>
    <li>
     <p>Let <var>output</var> be a code point <a data-link-type="dfn" href="#concept-stream" id="ref-for-concept-stream-11">stream</a>. </p>
    <li>
     <p><a data-link-type="dfn" href="#concept-encoding-run" id="ref-for-concept-encoding-run-2">Run</a> <a data-link-type="dfn" href="#utf-8" id="ref-for-utf-8-8">UTF-8</a>’s <a data-link-type="dfn" href="#decoder" id="ref-for-decoder-9">decoder</a> with <var>stream</var> and <var>output</var>. </p>
    <li>
     <p>Return <var>output</var>. </p>
   </ol>
   <p>To <dfn class="dfn-paneled" data-dfn-type="dfn" data-export="" id="utf-8-decode-without-bom">UTF-8 decode without BOM</dfn> a byte stream <var>stream</var>, run these
steps: </p>
   <ol>
    <li>
     <p>Let <var>output</var> be a code point <a data-link-type="dfn" href="#concept-stream" id="ref-for-concept-stream-12">stream</a>. </p>
    <li>
     <p><a data-link-type="dfn" href="#concept-encoding-run" id="ref-for-concept-encoding-run-3">Run</a> <a data-link-type="dfn" href="#utf-8" id="ref-for-utf-8-9">UTF-8</a>’s <a data-link-type="dfn" href="#decoder" id="ref-for-decoder-10">decoder</a> with <var>stream</var> and <var>output</var>. </p>
    <li>
     <p>Return <var>output</var>. </p>
   </ol>
   <p>To <dfn class="dfn-paneled" data-dfn-type="dfn" data-export="" id="utf-8-decode-without-bom-or-fail">UTF-8 decode without BOM or fail</dfn> a byte stream <var>stream</var>, run these steps: </p>
   <ol>
    <li>
     <p>Let <var>output</var> be a code point stream. </p>
    <li>
     <p>Let <var>potentialError</var> be the result of <a data-link-type="dfn" href="#concept-encoding-run" id="ref-for-concept-encoding-run-4">running</a> <a data-link-type="dfn" href="#utf-8" id="ref-for-utf-8-10">UTF-8</a>’s <a data-link-type="dfn" href="#decoder" id="ref-for-decoder-11">decoder</a> with <var>stream</var>, <var>output</var>, and
 "<code>fatal</code>". </p>
    <li>
     <p>If <var>potentialError</var> is <a data-link-type="dfn" href="#error" id="ref-for-error-3">error</a>, return failure. </p>
    <li>
     <p>Return <var>output</var>. </p>
   </ol>
   <hr>
   <p>To <dfn class="dfn-paneled" data-dfn-type="dfn" data-export="" id="encode">encode</dfn> a code point stream <var>stream</var> using
encoding <var>encoding</var>, run these steps: </p>
   <ol>
    <li>
     <p>Assert: <var>encoding</var> is not <a data-link-type="dfn" href="#replacement" id="ref-for-replacement-5">replacement</a>, <a data-link-type="dfn" href="#utf-16be" id="ref-for-utf-16be-6">UTF-16BE</a> or <a data-link-type="dfn" href="#utf-16le" id="ref-for-utf-16le-6">UTF-16LE</a>. </p>
    <li>
     <p>Let <var>output</var> be a byte <a data-link-type="dfn" href="#concept-stream" id="ref-for-concept-stream-13">stream</a>. </p>
    <li>
     <p><a data-link-type="dfn" href="#concept-encoding-run" id="ref-for-concept-encoding-run-5">Run</a> <var>encoding</var>’s <a data-link-type="dfn" href="#encoder" id="ref-for-encoder-8">encoder</a> with <var>stream</var>, <var>output</var>, and "<code>html</code>". </p>
    <li>
     <p>Return <var>output</var>. </p>
   </ol>
   <p class="note no-backref" role="note">This is mostly a legacy hook for URLs and HTML forms. Layering <a data-link-type="dfn" href="#utf-8-encode" id="ref-for-utf-8-encode-2">UTF-8 encode</a> on top is safe as it never triggers <a data-link-type="dfn" href="#error" id="ref-for-error-4">errors</a>. <a data-link-type="biblio" href="#biblio-url">[URL]</a> <a data-link-type="biblio" href="#biblio-html">[HTML]</a> </p>
   <p>To <dfn class="dfn-paneled" data-dfn-type="dfn" data-export="" id="utf-8-encode">UTF-8 encode</dfn> a code point stream <var>stream</var>,
return the result of <a data-link-type="dfn" href="#encode" id="ref-for-encode-2">encoding</a> <var>stream</var> using encoding <a data-link-type="dfn" href="#utf-8" id="ref-for-utf-8-11">UTF-8</a>. </p>
   <h2 class="heading settled" data-level="7" id="api"><span class="secno">7. </span><span class="content">API</span><a class="self-link" href="#api"></a></h2>
   <p>This section uses terminology from Web IDL. Non-browser user agents are not required to support
this API. </p>
   <p><a data-link-type="biblio" href="#biblio-webidl">[WEBIDL]</a></p>
   <div class="example" id="example-textencoder">
    <a class="self-link" href="#example-textencoder"></a> 
    <p>The following example uses the <code class="idl"><a data-link-type="idl" href="#textencoder" id="ref-for-textencoder-1">TextEncoder</a></code> object to encode
 an array of strings into an <code class="idl"><a data-link-type="idl" href="https://heycam.github.io/webidl/#idl-ArrayBuffer">ArrayBuffer</a></code>. The result is a <code class="idl"><a data-link-type="idl" href="https://heycam.github.io/webidl/#idl-Uint8Array">Uint8Array</a></code> containing the number
 of strings (as a <code class="idl"><a data-link-type="idl" href="https://heycam.github.io/webidl/#idl-Uint32Array">Uint32Array</a></code>),
 followed by the length of the first string (as a <code class="idl"><a data-link-type="idl" href="https://heycam.github.io/webidl/#idl-Uint32Array">Uint32Array</a></code>), the <a data-link-type="dfn" href="#utf-8" id="ref-for-utf-8-12">UTF-8</a> encoded string data, the length of the second string (as
 a <code class="idl"><a data-link-type="idl" href="https://heycam.github.io/webidl/#idl-Uint32Array">Uint32Array</a></code>), the string data,
 and so on. </p>
<pre><code class="lang-javascript highlight"><span class="kd">function</span> encodeArrayOfStrings<span class="p">(</span>strings<span class="p">)</span> <span class="p">{</span>
  <span class="kd">var</span> encoder<span class="p">,</span> encoded<span class="p">,</span> len<span class="p">,</span> bytes<span class="p">,</span> view<span class="p">,</span> offset<span class="p">;</span>

  encoder <span class="o">=</span> <span class="k">new</span> TextEncoder<span class="p">();</span>
  encoded <span class="o">=</span> <span class="p">[];</span>

  len <span class="o">=</span> Uint32Array<span class="p">.</span>BYTES_PER_ELEMENT<span class="p">;</span>
  <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> i <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> i <span class="o">&lt;</span> strings<span class="p">.</span>length<span class="p">;</span> i<span class="o">++</span><span class="p">)</span> <span class="p">{</span>
    len <span class="o">+=</span> Uint32Array<span class="p">.</span>BYTES_PER_ELEMENT<span class="p">;</span>
    encoded<span class="p">[</span>i<span class="p">]</span> <span class="o">=</span> encoder<span class="p">.</span>encode<span class="p">(</span>strings<span class="p">[</span>i<span class="p">]);</span>
    len <span class="o">+=</span> encoded<span class="p">[</span>i<span class="p">].</span>byteLength<span class="p">;</span>
  <span class="p">}</span>

  bytes <span class="o">=</span> <span class="k">new</span> Uint8Array<span class="p">(</span>len<span class="p">);</span>
  view <span class="o">=</span> <span class="k">new</span> DataView<span class="p">(</span>bytes<span class="p">.</span>buffer<span class="p">);</span>
  offset <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>

  view<span class="p">.</span>setUint32<span class="p">(</span>offset<span class="p">,</span> strings<span class="p">.</span>length<span class="p">);</span>
  offset <span class="o">+=</span> Uint32Array<span class="p">.</span>BYTES_PER_ELEMENT<span class="p">;</span>
  <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> i <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> i <span class="o">&lt;</span> encoded<span class="p">.</span>length<span class="p">;</span> i <span class="o">+=</span> <span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
    len <span class="o">=</span> encoded<span class="p">[</span>i<span class="p">].</span>byteLength<span class="p">;</span>
    view<span class="p">.</span>setUint32<span class="p">(</span>offset<span class="p">,</span> len<span class="p">);</span>
    offset <span class="o">+=</span> Uint32Array<span class="p">.</span>BYTES_PER_ELEMENT<span class="p">;</span>
    bytes<span class="p">.</span>set<span class="p">(</span>encoded<span class="p">[</span>i<span class="p">],</span> offset<span class="p">);</span>
    offset <span class="o">+=</span> len<span class="p">;</span>
  <span class="p">}</span>
  <span class="k">return</span> bytes<span class="p">.</span>buffer<span class="p">;</span>
<span class="p">}</span></code></pre>
    <p>The following example decodes an <code class="idl"><a data-link-type="idl" href="https://heycam.github.io/webidl/#idl-ArrayBuffer">ArrayBuffer</a></code> containing data encoded in the
 format produced by the previous example, or an equivalent algorithm for encodings other than <a data-link-type="dfn" href="#utf-8" id="ref-for-utf-8-13">UTF-8</a>, back into an array of strings. </p>
<pre><code class="lang-javascript highlight"><span class="kd">function</span> decodeArrayOfStrings<span class="p">(</span>buffer<span class="p">,</span> encoding<span class="p">)</span> <span class="p">{</span>
  <span class="kd">var</span> decoder<span class="p">,</span> view<span class="p">,</span> offset<span class="p">,</span> num_strings<span class="p">,</span> strings<span class="p">,</span> len<span class="p">;</span>

  decoder <span class="o">=</span> <span class="k">new</span> TextDecoder<span class="p">(</span>encoding<span class="p">);</span>
  view <span class="o">=</span> <span class="k">new</span> DataView<span class="p">(</span>buffer<span class="p">);</span>
  offset <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
  strings <span class="o">=</span> <span class="p">[];</span>

  num_strings <span class="o">=</span> view<span class="p">.</span>getUint32<span class="p">(</span>offset<span class="p">);</span>
  offset <span class="o">+=</span> Uint32Array<span class="p">.</span>BYTES_PER_ELEMENT<span class="p">;</span>
  <span class="k">for</span> <span class="p">(</span><span class="kd">var</span> i <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> i <span class="o">&lt;</span> num_strings<span class="p">;</span> i<span class="o">++</span><span class="p">)</span> <span class="p">{</span>
    len <span class="o">=</span> view<span class="p">.</span>getUint32<span class="p">(</span>offset<span class="p">);</span>
    offset <span class="o">+=</span> Uint32Array<span class="p">.</span>BYTES_PER_ELEMENT<span class="p">;</span>
    strings<span class="p">[</span>i<span class="p">]</span> <span class="o">=</span> decoder<span class="p">.</span>decode<span class="p">(</span>
      <span class="k">new</span> DataView<span class="p">(</span>view<span class="p">.</span>buffer<span class="p">,</span> offset<span class="p">,</span> len<span class="p">));</span>
    offset <span class="o">+=</span> len<span class="p">;</span>
  <span class="p">}</span>
  <span class="k">return</span> strings<span class="p">;</span>
<span class="p">}</span></code></pre>
   </div>
   <h3 class="heading settled" data-level="7.1" id="interface-textdecoder"><span class="secno">7.1. </span><span class="content">Interface <code class="idl"><a data-link-type="idl" href="#textdecoder" id="ref-for-textdecoder-1">TextDecoder</a></code></span><a class="self-link" href="#interface-textdecoder"></a></h3>
<pre class="idl highlight def"><span class="kt">dictionary</span> <dfn class="nv dfn-paneled idl-code" data-dfn-type="dictionary" data-export="" id="textdecoderoptions"><code>TextDecoderOptions</code></dfn> {
  <a class="n idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-boolean"><span class="kt">boolean</span></a> <dfn class="nv idl-code" data-default="false" data-dfn-for="TextDecoderOptions" data-dfn-type="dict-member" data-export="" data-type="boolean " id="dom-textdecoderoptions-fatal"><code>fatal</code><a class="self-link" href="#dom-textdecoderoptions-fatal"></a></dfn> = <span class="kt">false</span>;
  <a class="n idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-boolean"><span class="kt">boolean</span></a> <dfn class="nv idl-code" data-default="false" data-dfn-for="TextDecoderOptions" data-dfn-type="dict-member" data-export="" data-type="boolean " id="dom-textdecoderoptions-ignorebom"><code>ignoreBOM</code><a class="self-link" href="#dom-textdecoderoptions-ignorebom"></a></dfn> = <span class="kt">false</span>;
};

<span class="kt">dictionary</span> <dfn class="nv dfn-paneled idl-code" data-dfn-type="dictionary" data-export="" id="textdecodeoptions"><code>TextDecodeOptions</code></dfn> {
  <a class="n idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-boolean"><span class="kt">boolean</span></a> <dfn class="nv idl-code" data-default="false" data-dfn-for="TextDecodeOptions" data-dfn-type="dict-member" data-export="" data-type="boolean " id="dom-textdecodeoptions-stream"><code>stream</code><a class="self-link" href="#dom-textdecodeoptions-stream"></a></dfn> = <span class="kt">false</span>;
};

[<a class="nv idl-code" data-link-type="constructor" href="#dom-textdecoder" id="ref-for-dom-textdecoder-1">Constructor</a>(<span class="kt">optional</span> <a class="n idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-DOMString"><span class="kt">DOMString</span></a> <dfn class="nv idl-code" data-dfn-for="TextDecoder/TextDecoder(label, options)" data-dfn-type="argument" data-export="" id="dom-textdecoder-textdecoder-label-options-label"><code>label</code><a class="self-link" href="#dom-textdecoder-textdecoder-label-options-label"></a></dfn> = "utf-8", <span class="kt">optional</span> <a class="n" data-link-type="idl-name" href="#textdecoderoptions" id="ref-for-textdecoderoptions-1">TextDecoderOptions</a> <dfn class="nv idl-code" data-dfn-for="TextDecoder/TextDecoder(label, options)" data-dfn-type="argument" data-export="" id="dom-textdecoder-textdecoder-label-options-options"><code>options</code><a class="self-link" href="#dom-textdecoder-textdecoder-label-options-options"></a></dfn>),
 <a class="nv idl-code" data-link-type="extended-attribute" href="https://heycam.github.io/webidl/#Exposed">Exposed</a>=(<span class="n">Window</span>,<span class="n">Worker</span>)]
<span class="kt">interface</span> <dfn class="nv dfn-paneled idl-code" data-dfn-type="interface" data-export="" id="textdecoder"><code>TextDecoder</code></dfn> {
  <span class="kt">readonly</span> <span class="kt">attribute</span> <a class="n idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-DOMString"><span class="kt">DOMString</span></a> <a class="nv idl-code" data-link-type="attribute" data-readonly="" data-type="DOMString" href="#dom-textdecoder-encoding" id="ref-for-dom-textdecoder-encoding-1">encoding</a>;
  <span class="kt">readonly</span> <span class="kt">attribute</span> <a class="n idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-boolean"><span class="kt">boolean</span></a> <a class="nv idl-code" data-link-type="attribute" data-readonly="" data-type="boolean" href="#dom-textdecoder-fatal" id="ref-for-dom-textdecoder-fatal-1">fatal</a>;
  <span class="kt">readonly</span> <span class="kt">attribute</span> <a class="n idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-boolean"><span class="kt">boolean</span></a> <a class="nv idl-code" data-link-type="attribute" data-readonly="" data-type="boolean" href="#dom-textdecoder-ignorebom" id="ref-for-dom-textdecoder-ignorebom-1">ignoreBOM</a>;
  <a class="n idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-USVString"><span class="kt">USVString</span></a> <a class="nv idl-code" data-link-type="method" href="#dom-textdecoder-decode" id="ref-for-dom-textdecoder-decode-1">decode</a>(<span class="kt">optional</span> <a class="n" data-link-type="idl-name" href="https://heycam.github.io/webidl/#BufferSource">BufferSource</a> <dfn class="nv idl-code" data-dfn-for="TextDecoder/decode(input, options), TextDecoder/decode(input), TextDecoder/decode()" data-dfn-type="argument" data-export="" id="dom-textdecoder-decode-input-options-input"><code>input</code><a class="self-link" href="#dom-textdecoder-decode-input-options-input"></a></dfn>, <span class="kt">optional</span> <a class="n" data-link-type="idl-name" href="#textdecodeoptions" id="ref-for-textdecodeoptions-1">TextDecodeOptions</a> <dfn class="nv idl-code" data-dfn-for="TextDecoder/decode(input, options), TextDecoder/decode(input), TextDecoder/decode()" data-dfn-type="argument" data-export="" id="dom-textdecoder-decode-input-options-options"><code>options</code><a class="self-link" href="#dom-textdecoder-decode-input-options-options"></a></dfn>);
};</pre>
   <p>A <code class="idl"><a data-link-type="idl" href="#textdecoder" id="ref-for-textdecoder-2">TextDecoder</a></code> object has an associated <dfn class="dfn-paneled" data-dfn-for="TextDecoder" data-dfn-type="dfn" data-noexport="" id="textdecoder-encoding">encoding</dfn>, <dfn class="dfn-paneled" data-dfn-for="TextDecoder" data-dfn-type="dfn" data-noexport="" id="textdecoder-decoder">decoder</dfn>, <dfn class="dfn-paneled" data-dfn-for="TextDecoder" data-dfn-type="dfn" data-noexport="" id="textdecoder-stream">stream</dfn>, <dfn class="dfn-paneled" data-dfn-for="TextDecoder" data-dfn-type="dfn" data-noexport="" id="textdecoder-ignore-bom-flag">ignore BOM flag</dfn> (initially unset), <dfn class="dfn-paneled" data-dfn-for="TextDecoder" data-dfn-type="dfn" data-noexport="" id="textdecoder-bom-seen-flag">BOM seen flag</dfn> (initially unset), <dfn class="dfn-paneled" data-dfn-for="TextDecoder" data-dfn-type="dfn" data-noexport="" id="textdecoder-error-mode">error mode</dfn> (initially "<code>replacement</code>"), and <dfn class="dfn-paneled" data-dfn-for="TextDecoder" data-dfn-type="dfn" data-noexport="" id="textdecoder-do-not-flush-flag">do not flush flag</dfn> (initially unset). </p>
   <p>A <code class="idl"><a data-link-type="idl" href="#textdecoder" id="ref-for-textdecoder-3">TextDecoder</a></code> object also has an associated <dfn class="dfn-paneled" data-dfn-for="TextDecoder" data-dfn-type="dfn" data-noexport="" id="concept-td-serialize">serialize stream</dfn> algorithm, that given a <a data-link-type="dfn" href="#concept-stream" id="ref-for-concept-stream-14">stream</a> <var>stream</var>, runs these steps: </p>
   <ol>
    <li>
     <p>Let <var>output</var> be the empty string. </p>
    <li>
     <p>While true: </p>
     <ol>
      <li>
       <p>Let <var>token</var> be the result of <a data-link-type="dfn" href="#concept-stream-read" id="ref-for-concept-stream-read-5">reading</a> from <var>stream</var>. </p>
      <li>
       <p>If <a data-link-type="dfn" href="#textdecoder-encoding" id="ref-for-textdecoder-encoding-1">encoding</a> is <a data-link-type="dfn" href="#utf-8" id="ref-for-utf-8-14">UTF-8</a>, <a data-link-type="dfn" href="#utf-16be" id="ref-for-utf-16be-7">UTF-16BE</a>, or <a data-link-type="dfn" href="#utf-16le" id="ref-for-utf-16le-7">UTF-16LE</a>, and <a data-link-type="dfn" href="#textdecoder-ignore-bom-flag" id="ref-for-textdecoder-ignore-bom-flag-1">ignore BOM flag</a> and <a data-link-type="dfn" href="#textdecoder-bom-seen-flag" id="ref-for-textdecoder-bom-seen-flag-1">BOM seen flag</a> are unset, then: </p>
       <ol>
        <li>
         <p>If <var>token</var> is U+FEFF, then set <a data-link-type="dfn" href="#textdecoder-bom-seen-flag" id="ref-for-textdecoder-bom-seen-flag-2">BOM seen flag</a>. </p>
        <li>
         <p>Otherwise, if <var>token</var> is not <a data-link-type="dfn" href="#end-of-stream" id="ref-for-end-of-stream-3">end-of-stream</a>, then set <a data-link-type="dfn" href="#textdecoder-bom-seen-flag" id="ref-for-textdecoder-bom-seen-flag-3">BOM seen flag</a> and append <var>token</var> to <var>output</var>. </p>
        <li>
         <p>Otherwise, return <var>output</var>. </p>
       </ol>
      <li>
       <p>Otherwise, if <var>token</var> is not <a data-link-type="dfn" href="#end-of-stream" id="ref-for-end-of-stream-4">end-of-stream</a>, then append <var>token</var> to <var>output</var>. </p>
      <li>
       <p>Otherwise, return <var>output</var>. </p>
     </ol>
   </ol>
   <p class="note" role="note">This algorithm is intentionally different with respect to BOM handling from
the <a data-link-type="dfn" href="#decode" id="ref-for-decode-2">decode</a> algorithm used by the rest of the platform to give API users more
control. </p>
   <hr>
   <dl class="domintro">
    <dt><code><var>decoder</var> = new <a class="idl-code" data-link-type="constructor" href="#dom-textdecoder" id="ref-for-dom-textdecoder-2">TextDecoder([<var>label</var> = "utf-8" [, <var>options</var>]])</a></code> 
    <dd>
     <p>Returns a new <code class="idl"><a data-link-type="idl" href="#textdecoder" id="ref-for-textdecoder-4">TextDecoder</a></code> object. </p>
     <p>If <var>label</var> is either not a <a data-link-type="dfn" href="#label" id="ref-for-label-10">label</a> or is a <a data-link-type="dfn" href="#label" id="ref-for-label-11">label</a> for <a data-link-type="dfn" href="#replacement" id="ref-for-replacement-6">replacement</a>, <a data-link-type="dfn" href="https://heycam.github.io/webidl/#dfn-throw">throws</a> a <code class="idl"><a data-link-type="idl" href="https://heycam.github.io/webidl/#exceptiondef-rangeerror">RangeError</a></code>. </p>
    <dt><code><var>decoder</var> . <a class="idl-code" data-link-type="attribute" href="#dom-textdecoder-encoding" id="ref-for-dom-textdecoder-encoding-2">encoding</a></code> 
    <dd>
     <p>Returns <a data-link-type="dfn" href="#textdecoder-encoding" id="ref-for-textdecoder-encoding-2">encoding</a>’s <a data-link-type="dfn" href="#name" id="ref-for-name-3">name</a>, lowercased. </p>
    <dt><code><var>decoder</var> . <a class="idl-code" data-link-type="attribute" href="#dom-textdecoder-fatal" id="ref-for-dom-textdecoder-fatal-2">fatal</a></code> 
    <dd>
     <p>Returns true if <a data-link-type="dfn" href="#textdecoder-error-mode" id="ref-for-textdecoder-error-mode-1">error mode</a> is "<code>fatal</code>", and false
 otherwise. </p>
    <dt><code><var>decoder</var> . <a class="idl-code" data-link-type="attribute" href="#dom-textdecoder-ignorebom" id="ref-for-dom-textdecoder-ignorebom-2">ignoreBOM</a></code> 
    <dd>
     <p>Returns true if <a data-link-type="dfn" href="#textdecoder-ignore-bom-flag" id="ref-for-textdecoder-ignore-bom-flag-2">ignore BOM flag</a> is set, and false otherwise. </p>
    <dt><code><var>decoder</var> . <a class="idl-code" data-link-type="method" href="#dom-textdecoder-decode" id="ref-for-dom-textdecoder-decode-2">decode([<var>input</var> [, <var>options</var>]])</a></code> 
    <dd>
     <p>Returns the result of running <a data-link-type="dfn" href="#textdecoder-encoding" id="ref-for-textdecoder-encoding-3">encoding</a>’s <a data-link-type="dfn" href="#decoder" id="ref-for-decoder-12">decoder</a>. The
  method can be invoked zero or more times with <var>options</var>’s <code>stream</code> set to
  true, and then once without <var>options</var>’s <code>stream</code> (or set to false), to process
  a fragmented stream. If the invocation without <var>options</var>’s <code>stream</code> (or set to
  false) has no <var>input</var>, it’s clearest to omit both arguments. </p>
<pre class="example" id="example-end-of-stream"><a class="self-link" href="#example-end-of-stream"></a><code class="lang-javascript highlight"><span class="kd">var</span> string <span class="o">=</span> <span class="s2">""</span><span class="p">,</span> decoder <span class="o">=</span> <span class="k">new</span> TextDecoder<span class="p">(</span>encoding<span class="p">),</span> buffer<span class="p">;</span>
<span class="k">while</span><span class="p">(</span>buffer <span class="o">=</span> next_chunk<span class="p">())</span> <span class="p">{</span>
  string <span class="o">+=</span> decoder<span class="p">.</span>decode<span class="p">(</span>buffer<span class="p">,</span> <span class="p">{</span>stream<span class="o">:</span><span class="kc">true</span><span class="p">});</span>
<span class="p">}</span>
string <span class="o">+=</span> decoder<span class="p">.</span>decode<span class="p">();</span> <span class="c1">// end-of-stream</span></code></pre>
     <p>If the <a data-link-type="dfn" href="#textdecoder-error-mode" id="ref-for-textdecoder-error-mode-2">error mode</a> is "<code>fatal</code>" and <a data-link-type="dfn" href="#textdecoder-encoding" id="ref-for-textdecoder-encoding-4">encoding</a>’s <a data-link-type="dfn" href="#decoder" id="ref-for-decoder-13">decoder</a> returns <a data-link-type="dfn" href="#error" id="ref-for-error-5">error</a>, <a data-link-type="dfn" href="https://heycam.github.io/webidl/#dfn-throw">throws</a> a <code class="idl"><a data-link-type="idl" href="https://heycam.github.io/webidl/#exceptiondef-typeerror">TypeError</a></code>. </p>
   </dl>
   <p>The <dfn class="dfn-paneled idl-code" data-dfn-for="TextDecoder" data-dfn-type="constructor" data-export="" id="dom-textdecoder"><code><code>TextDecoder(<var>label</var>, <var>options</var>)</code></code></dfn> constructor, when invoked, must run these steps: </p>
   <ol>
    <li>
     <p>Let <var>encoding</var> be the result of <a data-link-type="dfn" href="#concept-encoding-get" id="ref-for-concept-encoding-get-2">getting an encoding</a> from <var>label</var>. </p>
    <li>
     <p>If <var>encoding</var> is failure or <a data-link-type="dfn" href="#replacement" id="ref-for-replacement-7">replacement</a>, then <a data-link-type="dfn" href="https://heycam.github.io/webidl/#dfn-throw">throw</a> a <code class="idl"><a data-link-type="idl" href="https://heycam.github.io/webidl/#exceptiondef-rangeerror">RangeError</a></code>. </p>
    <li>
     <p>Let <var>dec</var> be a new <code class="idl"><a data-link-type="idl" href="#textdecoder" id="ref-for-textdecoder-5">TextDecoder</a></code> object. </p>
    <li>
     <p>Set <var>dec</var>’s <a data-link-type="dfn" href="#textdecoder-encoding" id="ref-for-textdecoder-encoding-5">encoding</a> to <var>encoding</var>. </p>
    <li>
     <p>If <var>options</var>’s <code>fatal</code> member is true, then set <var>dec</var>’s <a data-link-type="dfn" href="#textdecoder-error-mode" id="ref-for-textdecoder-error-mode-3">error mode</a> to "<code>fatal</code>". </p>
    <li>
     <p>If <var>options</var>’s <code>ignoreBOM</code> member is true, then set <var>dec</var>’s <a data-link-type="dfn" href="#textdecoder-ignore-bom-flag" id="ref-for-textdecoder-ignore-bom-flag-3">ignore BOM flag</a>. </p>
    <li>
     <p>Return <var>dec</var>. </p>
   </ol>
   <p>The <dfn class="dfn-paneled idl-code" data-dfn-for="TextDecoder" data-dfn-type="attribute" data-export="" id="dom-textdecoder-encoding"><code><code>encoding</code></code></dfn> attribute’s getter must return <a data-link-type="dfn" href="#textdecoder-encoding" id="ref-for-textdecoder-encoding-6">encoding</a>’s <a data-link-type="dfn" href="#name" id="ref-for-name-4">name</a> in <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#ascii-lowercase">ASCII lowercase</a>. </p>
   <p>The <dfn class="dfn-paneled idl-code" data-dfn-for="TextDecoder" data-dfn-type="attribute" data-export="" id="dom-textdecoder-fatal"><code><code>fatal</code></code></dfn> attribute’s getter must return true
if <a data-link-type="dfn" href="#textdecoder-error-mode" id="ref-for-textdecoder-error-mode-4">error mode</a> is "<code>fatal</code>", and false otherwise. </p>
   <p>The <dfn class="dfn-paneled idl-code" data-dfn-for="TextDecoder" data-dfn-type="attribute" data-export="" id="dom-textdecoder-ignorebom"><code><code>ignoreBOM</code></code></dfn> attribute’s getter must return
true if <a data-link-type="dfn" href="#textdecoder-ignore-bom-flag" id="ref-for-textdecoder-ignore-bom-flag-4">ignore BOM flag</a> is set, and false otherwise. </p>
   <p>The <dfn class="dfn-paneled idl-code" data-dfn-for="TextDecoder" data-dfn-type="method" data-export="" data-lt="decode(input, options)|decode(input)|decode()" id="dom-textdecoder-decode"><code><code>decode(<var>input</var>, <var>options</var>)</code></code></dfn> method, when invoked, must run these steps: </p>
   <ol>
    <li>
     <p>If the <a data-link-type="dfn" href="#textdecoder-do-not-flush-flag" id="ref-for-textdecoder-do-not-flush-flag-1">do not flush flag</a> is unset, set <a data-link-type="dfn" href="#textdecoder-decoder" id="ref-for-textdecoder-decoder-1">decoder</a> to a new <a data-link-type="dfn" href="#textdecoder-encoding" id="ref-for-textdecoder-encoding-7">encoding</a>’s <a data-link-type="dfn" href="#decoder" id="ref-for-decoder-14">decoder</a>, set <a data-link-type="dfn" href="#textdecoder-stream" id="ref-for-textdecoder-stream-1">stream</a> to a new <a data-link-type="dfn" href="#concept-stream" id="ref-for-concept-stream-15">stream</a>, and unset the <a data-link-type="dfn" href="#textdecoder-bom-seen-flag" id="ref-for-textdecoder-bom-seen-flag-4">BOM seen flag</a>. </p>
    <li>
     <p>If <var>options</var>’s <code>stream</code> is true, set the <a data-link-type="dfn" href="#textdecoder-do-not-flush-flag" id="ref-for-textdecoder-do-not-flush-flag-2">do not flush flag</a>, and unset the <a data-link-type="dfn" href="#textdecoder-do-not-flush-flag" id="ref-for-textdecoder-do-not-flush-flag-3">do not flush flag</a> otherwise. </p>
    <li>
     <p>If <var>input</var> is given, then <a data-link-type="dfn" href="#concept-stream-push" id="ref-for-concept-stream-push-3">push</a> a <a data-link-type="dfn" href="https://heycam.github.io/webidl/#dfn-get-buffer-source-copy">copy of</a> <var>input</var> to <a data-link-type="dfn" href="#textdecoder-stream" id="ref-for-textdecoder-stream-2">stream</a>. </p>
     <p class="note" role="note">Implementations are strongly encouraged to use an implementation strategy that
  avoids this copy. When doing so they will have to make sure that changes to <var>input</var> do
  not affect future calls to <a class="idl-code" data-link-type="method" href="#dom-textdecoder-decode" id="ref-for-dom-textdecoder-decode-3"><code>decode()</code></a>. </p>
    <li>
     <p>Let <var>output</var> be a new <a data-link-type="dfn" href="#concept-stream" id="ref-for-concept-stream-16">stream</a>. </p>
    <li>
     <p>While true: </p>
     <ol>
      <li>
       <p>Let <var>token</var> be the result of <a data-link-type="dfn" href="#concept-stream-read" id="ref-for-concept-stream-read-6">reading</a> from <a data-link-type="dfn" href="#textdecoder-stream" id="ref-for-textdecoder-stream-3">stream</a>. </p>
      <li>
       <p>If <var>token</var> is <a data-link-type="dfn" href="#end-of-stream" id="ref-for-end-of-stream-5">end-of-stream</a> and the <a data-link-type="dfn" href="#textdecoder-do-not-flush-flag" id="ref-for-textdecoder-do-not-flush-flag-4">do not flush flag</a> is set, then return <var>output</var>, <a data-link-type="dfn" href="#concept-td-serialize" id="ref-for-concept-td-serialize-1">serialized</a>. </p>
       <p class="note" role="note">The way streaming works is to not handle <a data-link-type="dfn" href="#end-of-stream" id="ref-for-end-of-stream-6">end-of-stream</a> here when the <a data-link-type="dfn" href="#textdecoder-do-not-flush-flag" id="ref-for-textdecoder-do-not-flush-flag-5">do not flush flag</a> is set and to not unset that flag. That way in a
    subsequent invocation <a data-link-type="dfn" href="#textdecoder-decoder" id="ref-for-textdecoder-decoder-2">decoder</a> is not set anew in the first step of the
    algorithm and its state is preserved. </p>
      <li>
       <p>Otherwise: </p>
       <ol>
        <li>
         <p>Let <var>result</var> be the result of <a data-link-type="dfn" href="#concept-encoding-process" id="ref-for-concept-encoding-process-2">processing</a> <var>token</var> for <a data-link-type="dfn" href="#textdecoder-decoder" id="ref-for-textdecoder-decoder-3">decoder</a>, <a data-link-type="dfn" href="#textdecoder-stream" id="ref-for-textdecoder-stream-4">stream</a>, <var>output</var>, and <a data-link-type="dfn" href="#textdecoder-error-mode" id="ref-for-textdecoder-error-mode-5">error mode</a>. </p>
        <li>
         <p>If <var>result</var> is <a data-link-type="dfn" href="#finished" id="ref-for-finished-2">finished</a>, then return <var>output</var>, <a data-link-type="dfn" href="#concept-td-serialize" id="ref-for-concept-td-serialize-2">serialized</a>. </p>
        <li>
         <p>Otherwise, if <var>result</var> is <a data-link-type="dfn" href="#error" id="ref-for-error-6">error</a>, then <a data-link-type="dfn" href="https://heycam.github.io/webidl/#dfn-throw">throw</a> a <code class="idl"><a data-link-type="idl" href="https://heycam.github.io/webidl/#exceptiondef-typeerror">TypeError</a></code>. </p>
       </ol>
     </ol>
   </ol>
   <h3 class="heading settled" data-level="7.2" id="interface-textencoder"><span class="secno">7.2. </span><span class="content">Interface <code class="idl"><a data-link-type="idl" href="#textencoder" id="ref-for-textencoder-2">TextEncoder</a></code></span><a class="self-link" href="#interface-textencoder"></a></h3>
<pre class="idl highlight def">[<a class="nv idl-code" data-link-type="constructor" href="#dom-textencoder" id="ref-for-dom-textencoder-1">Constructor</a>,
 <a class="nv idl-code" data-link-type="extended-attribute" href="https://heycam.github.io/webidl/#Exposed">Exposed</a>=(<span class="n">Window</span>,<span class="n">Worker</span>)]
<span class="kt">interface</span> <dfn class="nv dfn-paneled idl-code" data-dfn-type="interface" data-export="" id="textencoder"><code>TextEncoder</code></dfn> {
  <span class="kt">readonly</span> <span class="kt">attribute</span> <a class="n idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-DOMString"><span class="kt">DOMString</span></a> <a class="nv idl-code" data-link-type="attribute" data-readonly="" data-type="DOMString" href="#dom-textencoder-encoding" id="ref-for-dom-textencoder-encoding-1">encoding</a>;
  [<a class="nv idl-code" data-link-type="extended-attribute" href="https://heycam.github.io/webidl/#NewObject">NewObject</a>] <a class="n idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-Uint8Array"><span class="kt">Uint8Array</span></a> <a class="nv idl-code" data-link-type="method" href="#dom-textencoder-encode" id="ref-for-dom-textencoder-encode-1">encode</a>(<span class="kt">optional</span> <a class="n idl-code" data-link-type="interface" href="https://heycam.github.io/webidl/#idl-USVString"><span class="kt">USVString</span></a> <dfn class="nv idl-code" data-dfn-for="TextEncoder/encode(input), TextEncoder/encode()" data-dfn-type="argument" data-export="" id="dom-textencoder-encode-input-input"><code>input</code><a class="self-link" href="#dom-textencoder-encode-input-input"></a></dfn> = "");
};</pre>
   <p>A <code class="idl"><a data-link-type="idl" href="#textencoder" id="ref-for-textencoder-3">TextEncoder</a></code> object has an associated <dfn class="dfn-paneled" data-dfn-for="TextEncoder" data-dfn-type="dfn" data-noexport="" id="textencoder-encoder">encoder</dfn>. </p>
   <p class="note no-backref" role="note">A <code class="idl"><a data-link-type="idl" href="#textencoder" id="ref-for-textencoder-4">TextEncoder</a></code> object offers no <var>label</var> argument as it only
supports <a data-link-type="dfn" href="#utf-8" id="ref-for-utf-8-15">UTF-8</a>. It also offers no <code>stream</code> option as no <a data-link-type="dfn" href="#encoder" id="ref-for-encoder-9">encoder</a> requires buffering of scalar values. </p>
   <hr>
   <dl class="domintro">
    <dt><code><var>encoder</var> = new <a class="idl-code" data-link-type="constructor" href="#dom-textencoder" id="ref-for-dom-textencoder-2">TextEncoder()</a></code> 
    <dd>
     <p>Returns a new <code class="idl"><a data-link-type="idl" href="#textencoder" id="ref-for-textencoder-5">TextEncoder</a></code> object. </p>
    <dt><code><var>encoder</var> . <a class="idl-code" data-link-type="attribute" href="#dom-textencoder-encoding" id="ref-for-dom-textencoder-encoding-2">encoding</a></code> 
    <dd>
     <p>Returns "<code>utf-8</code>". </p>
    <dt><code><var>encoder</var> . <a class="idl-code" data-link-type="method" href="#dom-textencoder-encode" id="ref-for-dom-textencoder-encode-2">encode([<var>input</var> = ""])</a></code> 
    <dd>
     <p>Returns the result of running <a data-link-type="dfn" href="#utf-8" id="ref-for-utf-8-16">UTF-8</a>’s <a data-link-type="dfn" href="#encoder" id="ref-for-encoder-10">encoder</a>. </p>
   </dl>
   <p>The <dfn class="dfn-paneled idl-code" data-dfn-for="TextEncoder" data-dfn-type="constructor" data-export="" id="dom-textencoder"><code><code>TextEncoder()</code></code></dfn> constructor, when invoked, must run these steps: </p>
   <ol>
    <li>
     <p>Let <var>enc</var> be a new <code class="idl"><a data-link-type="idl" href="#textencoder" id="ref-for-textencoder-6">TextEncoder</a></code> object. </p>
    <li>
     <p>Set <var>enc</var>’s <a data-link-type="dfn" href="#textencoder-encoder" id="ref-for-textencoder-encoder-1">encoder</a> to <a data-link-type="dfn" href="#utf-8" id="ref-for-utf-8-17">UTF-8</a>’s <a data-link-type="dfn" href="#encoder" id="ref-for-encoder-11">encoder</a>. </p>
    <li>
     <p>Return <var>enc</var>. </p>
   </ol>
   <p>The <dfn class="dfn-paneled idl-code" data-dfn-for="TextEncoder" data-dfn-type="attribute" data-export="" id="dom-textencoder-encoding"><code><code>encoding</code></code></dfn> attribute’s getter must return
"<code>utf-8</code>". </p>
   <p>The <dfn class="dfn-paneled idl-code" data-dfn-for="TextEncoder" data-dfn-type="method" data-export="" data-lt="encode(input)|encode()" id="dom-textencoder-encode"><code><code>encode(<var>input</var>)</code></code></dfn> method, when invoked,
must run these steps: </p>
   <ol>
    <li>
     <p>Convert <var>input</var> to a <a data-link-type="dfn" href="#concept-stream" id="ref-for-concept-stream-17">stream</a>. </p>
    <li>
     <p>Let <var>output</var> be a new <a data-link-type="dfn" href="#concept-stream" id="ref-for-concept-stream-18">stream</a>. </p>
    <li>
     <p>While true: </p>
     <ol>
      <li>
       <p>Let <var>token</var> be the result of <a data-link-type="dfn" href="#concept-stream-read" id="ref-for-concept-stream-read-7">reading</a> from <var>input</var>. </p>
      <li>
       <p>Let <var>result</var> be the result of <a data-link-type="dfn" href="#concept-encoding-process" id="ref-for-concept-encoding-process-3">processing</a> <var>token</var> for <a data-link-type="dfn" href="#textencoder-encoder" id="ref-for-textencoder-encoder-2">encoder</a>, <var>input</var>, <var>output</var>. </p>
      <li>
       <p>If <var>result</var> is <a data-link-type="dfn" href="#finished" id="ref-for-finished-3">finished</a>, convert <var>output</var> into a
    byte sequence, and then return a <code class="idl"><a data-link-type="idl" href="https://heycam.github.io/webidl/#idl-Uint8Array">Uint8Array</a></code> object wrapping an <code class="idl"><a data-link-type="idl" href="https://heycam.github.io/webidl/#idl-ArrayBuffer">ArrayBuffer</a></code> containing <var>output</var>. </p>
       <p class="note" role="note"><a data-link-type="dfn" href="#utf-8" id="ref-for-utf-8-18">UTF-8</a> cannot return <a data-link-type="dfn" href="#error" id="ref-for-error-7">error</a>. </p>
     </ol>
   </ol>
   <h2 class="heading settled" data-level="8" id="the-encoding"><span class="secno">8. </span><span class="content">The encoding</span><a class="self-link" href="#the-encoding"></a></h2>
   <h3 class="heading settled dfn-paneled" data-dfn-type="dfn" data-export="" data-level="8.1" data-lt="UTF-8" id="utf-8"><span class="secno">8.1. </span><span class="content">UTF-8</span></h3>
   <h4 class="heading settled dfn-paneled" data-dfn-type="dfn" data-export="" data-level="8.1.1" data-lt="UTF-8 decoder" id="utf-8-decoder"><span class="secno">8.1.1. </span><span class="content">UTF-8 decoder</span></h4>
   <p><a data-link-type="dfn" href="#utf-8" id="ref-for-utf-8-19">UTF-8</a>’s <a data-link-type="dfn" href="#decoder" id="ref-for-decoder-15">decoder</a>’s has an associated <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport="" id="utf-8-code-point">UTF-8 code point</dfn>, <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport="" id="utf-8-bytes-seen">UTF-8 bytes seen</dfn>, and <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport="" id="utf-8-bytes-needed">UTF-8 bytes needed</dfn> (all initially 0), a <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport="" id="utf-8-lower-boundary">UTF-8 lower boundary</dfn> (initially 0x80), and a <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport="" id="utf-8-upper-boundary">UTF-8 upper boundary</dfn> (initially 0xBF). </p>
   <p><a data-link-type="dfn" href="#utf-8" id="ref-for-utf-8-20">UTF-8</a>’s <a data-link-type="dfn" href="#decoder" id="ref-for-decoder-16">decoder</a>’s <a data-link-type="dfn" href="#handler" id="ref-for-handler-3">handler</a>, given a <var>stream</var> and <var>byte</var>, runs these steps: </p>
   <ol>
    <li>
     <p>If <var>byte</var> is <a data-link-type="dfn" href="#end-of-stream" id="ref-for-end-of-stream-7">end-of-stream</a> and <a data-link-type="dfn" href="#utf-8-bytes-needed" id="ref-for-utf-8-bytes-needed-1">UTF-8 bytes needed</a> is not 0, set <a data-link-type="dfn" href="#utf-8-bytes-needed" id="ref-for-utf-8-bytes-needed-2">UTF-8 bytes needed</a> to 0 and return <a data-link-type="dfn" href="#error" id="ref-for-error-8">error</a>. </p>
    <li>
     <p>If <var>byte</var> is <a data-link-type="dfn" href="#end-of-stream" id="ref-for-end-of-stream-8">end-of-stream</a>, return <a data-link-type="dfn" href="#finished" id="ref-for-finished-4">finished</a>. </p>
    <li>
     <p>If <a data-link-type="dfn" href="#utf-8-bytes-needed" id="ref-for-utf-8-bytes-needed-3">UTF-8 bytes needed</a> is 0, based on <var>byte</var>: </p>
     <dl class="switch">
      <dt>0x00 to 0x7F 
      <dd>
       <p>Return a code point whose value is <var>byte</var>. </p>
      <dt>0xC2 to 0xDF 
      <dd>
       <ol>
        <li>
         <p>Set <a data-link-type="dfn" href="#utf-8-bytes-needed" id="ref-for-utf-8-bytes-needed-4">UTF-8 bytes needed</a> to 1. </p>
        <li>
         <p>Set <a data-link-type="dfn" href="#utf-8-code-point" id="ref-for-utf-8-code-point-1">UTF-8 code point</a> to <var>byte</var> &amp; 0x1F. </p>
         <p class="note" role="note">The five least significant bits of <var>byte</var>. </p>
       </ol>
      <dt>0xE0 to 0xEF 
      <dd>
       <ol>
        <li>
         <p>If <var>byte</var> is 0xE0, set <a data-link-type="dfn" href="#utf-8-lower-boundary" id="ref-for-utf-8-lower-boundary-1">UTF-8 lower boundary</a> to 0xA0. </p>
        <li>
         <p>If <var>byte</var> is 0xED, set <a data-link-type="dfn" href="#utf-8-upper-boundary" id="ref-for-utf-8-upper-boundary-1">UTF-8 upper boundary</a> to 0x9F. </p>
        <li>
         <p>Set <a data-link-type="dfn" href="#utf-8-bytes-needed" id="ref-for-utf-8-bytes-needed-5">UTF-8 bytes needed</a> to 2. </p>
        <li>
         <p>Set <a data-link-type="dfn" href="#utf-8-code-point" id="ref-for-utf-8-code-point-2">UTF-8 code point</a> to <var>byte</var> &amp; 0xF. </p>
         <p class="note" role="note">The four least significant bits of <var>byte</var>. </p>
       </ol>
      <dt>0xF0 to 0xF4 
      <dd>
       <ol>
        <li>
         <p>If <var>byte</var> is 0xF0, set <a data-link-type="dfn" href="#utf-8-lower-boundary" id="ref-for-utf-8-lower-boundary-2">UTF-8 lower boundary</a> to 0x90. </p>
        <li>
         <p>If <var>byte</var> is 0xF4, set <a data-link-type="dfn" href="#utf-8-upper-boundary" id="ref-for-utf-8-upper-boundary-2">UTF-8 upper boundary</a> to 0x8F. </p>
        <li>
         <p>Set <a data-link-type="dfn" href="#utf-8-bytes-needed" id="ref-for-utf-8-bytes-needed-6">UTF-8 bytes needed</a> to 3. </p>
        <li>
         <p>Set <a data-link-type="dfn" href="#utf-8-code-point" id="ref-for-utf-8-code-point-3">UTF-8 code point</a> to <var>byte</var> &amp; 0x7. </p>
         <p class="note" role="note">The three least significant bits of <var>byte</var>. </p>
       </ol>
      <dt>Otherwise 
      <dd>
       <p>Return <a data-link-type="dfn" href="#error" id="ref-for-error-9">error</a>. </p>
     </dl>
     <p>Return <a data-link-type="dfn" href="#continue" id="ref-for-continue-4">continue</a>. </p>
    <li>
     <p>If <var>byte</var> is not in the range <a data-link-type="dfn" href="#utf-8-lower-boundary" id="ref-for-utf-8-lower-boundary-3">UTF-8 lower boundary</a> to <a data-link-type="dfn" href="#utf-8-upper-boundary" id="ref-for-utf-8-upper-boundary-3">UTF-8 upper boundary</a>, inclusive, then: </p>
     <ol>
      <li>
       <p>Set <a data-link-type="dfn" href="#utf-8-code-point" id="ref-for-utf-8-code-point-4">UTF-8 code point</a>, <a data-link-type="dfn" href="#utf-8-bytes-needed" id="ref-for-utf-8-bytes-needed-7">UTF-8 bytes needed</a>, and <a data-link-type="dfn" href="#utf-8-bytes-seen" id="ref-for-utf-8-bytes-seen-1">UTF-8 bytes seen</a> to 0,
   set <a data-link-type="dfn" href="#utf-8-lower-boundary" id="ref-for-utf-8-lower-boundary-4">UTF-8 lower boundary</a> to 0x80, and set <a data-link-type="dfn" href="#utf-8-upper-boundary" id="ref-for-utf-8-upper-boundary-4">UTF-8 upper boundary</a> to 0xBF. </p>
      <li>
       <p><a data-link-type="dfn" href="#concept-stream-prepend" id="ref-for-concept-stream-prepend-5">Prepend</a> <var>byte</var> to <var>stream</var>. </p>
      <li>
       <p>Return <a data-link-type="dfn" href="#error" id="ref-for-error-10">error</a>. </p>
     </ol>
    <li>
     <p>Set <a data-link-type="dfn" href="#utf-8-lower-boundary" id="ref-for-utf-8-lower-boundary-5">UTF-8 lower boundary</a> to 0x80 and <a data-link-type="dfn" href="#utf-8-upper-boundary" id="ref-for-utf-8-upper-boundary-5">UTF-8 upper boundary</a> to 0xBF. </p>
    <li>
     <p>Set <a data-link-type="dfn" href="#utf-8-code-point" id="ref-for-utf-8-code-point-5">UTF-8 code point</a> to (<a data-link-type="dfn" href="#utf-8-code-point" id="ref-for-utf-8-code-point-6">UTF-8 code point</a> &lt;&lt; 6) |
  (<var>byte</var> &amp; 0x3F) </p>
     <p class="note no-backref" role="note">Shift the existing bits of <a data-link-type="dfn" href="#utf-8-code-point" id="ref-for-utf-8-code-point-7">UTF-8 code point</a> left by six
  places and set the newly-vacated six least significant bits to the six least significant bits of <var>byte</var>. </p>
    <li>
     <p>Increase <a data-link-type="dfn" href="#utf-8-bytes-seen" id="ref-for-utf-8-bytes-seen-2">UTF-8 bytes seen</a> by one. </p>
    <li>
     <p>If <a data-link-type="dfn" href="#utf-8-bytes-seen" id="ref-for-utf-8-bytes-seen-3">UTF-8 bytes seen</a> is not equal to <a data-link-type="dfn" href="#utf-8-bytes-needed" id="ref-for-utf-8-bytes-needed-8">UTF-8 bytes needed</a>, return <a data-link-type="dfn" href="#continue" id="ref-for-continue-5">continue</a>. </p>
    <li>
     <p>Let <var>code point</var> be <a data-link-type="dfn" href="#utf-8-code-point" id="ref-for-utf-8-code-point-8">UTF-8 code point</a>. </p>
    <li>
     <p>Set <a data-link-type="dfn" href="#utf-8-code-point" id="ref-for-utf-8-code-point-9">UTF-8 code point</a>, <a data-link-type="dfn" href="#utf-8-bytes-needed" id="ref-for-utf-8-bytes-needed-9">UTF-8 bytes needed</a>, and <a data-link-type="dfn" href="#utf-8-bytes-seen" id="ref-for-utf-8-bytes-seen-4">UTF-8 bytes seen</a> to 0. </p>
    <li>
     <p>Return a code point whose value is <var>code point</var>. </p>
   </ol>
   <p class="note" role="note">The constraints in the <a data-link-type="dfn" href="#utf-8-decoder" id="ref-for-utf-8-decoder-1">UTF-8 decoder</a> above match
“Best Practices for Using U+FFFD” from the Unicode standard. No other
behavior is permitted per the Encoding Standard (other algorithms that
achieve the same result are obviously fine, even encouraged). <a data-link-type="biblio" href="#biblio-unicode">[UNICODE]</a> </p>
   <h4 class="heading settled" data-dfn-type="dfn" data-export="" data-level="8.1.2" data-lt="UTF-8 encoder" id="utf-8-encoder"><span class="secno">8.1.2. </span><span class="content">UTF-8 encoder</span><a class="self-link" href="#utf-8-encoder"></a></h4>
   <p><a data-link-type="dfn" href="#utf-8" id="ref-for-utf-8-21">UTF-8</a>’s <a data-link-type="dfn" href="#encoder" id="ref-for-encoder-12">encoder</a>’s <a data-link-type="dfn" href="#handler" id="ref-for-handler-4">handler</a>, given a <var>stream</var> and <var>code point</var>, runs these steps: </p>
   <ol>
    <li>
     <p>If <var>code point</var> is <a data-link-type="dfn" href="#end-of-stream" id="ref-for-end-of-stream-9">end-of-stream</a>, return <a data-link-type="dfn" href="#finished" id="ref-for-finished-5">finished</a>. </p>
    <li>
     <p>If <var>code point</var> is an <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#ascii-code-point">ASCII code point</a>, return
 a byte whose value is <var>code point</var>. </p>
    <li>
     <p>Set <var>count</var> and <var>offset</var> based on the
  range <var>code point</var> is in: </p>
     <dl class="switch">
      <dt>U+0080 to U+07FF, inclusive 
      <dd>1 and 0xC0 
      <dt>U+0800 to U+FFFF, inclusive 
      <dd>2 and 0xE0 
      <dt>U+10000 to U+10FFFF, inclusive 
      <dd>3 and 0xF0 
     </dl>
    <li>
     <p>Let <var>bytes</var> be a byte sequence whose first byte is
 (<var>code point</var> >> (6 × <var>count</var>)) + <var>offset</var>. </p>
    <li>
     <p>While <var>count</var> is greater than 0: </p>
     <ol>
      <li>
       <p>Set <var>temp</var> to <var>code point</var> >> (6 × (<var>count</var> − 1)). </p>
      <li>
       <p>Append to <var>bytes</var> 0x80 | (<var>temp</var> &amp; 0x3F). </p>
      <li>
       <p>Decrease <var>count</var> by one. </p>
     </ol>
    <li>
     <p>Return bytes <var>bytes</var>, in order. </p>
   </ol>
   <p class="note" role="note">This algorithm has identical results to the one described in the Unicode standard. It
is included here for completeness. <a data-link-type="biblio" href="#biblio-unicode">[UNICODE]</a> </p>
   <h2 class="heading settled" data-level="9" id="legacy-single-byte-encodings"><span class="secno">9. </span><span class="content">Legacy single-byte encodings</span><a class="self-link" href="#legacy-single-byte-encodings"></a></h2>
   <p>An <a data-link-type="dfn" href="#encoding" id="ref-for-encoding-20">encoding</a> where each byte is either a single code point or
nothing, is a <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport="" id="single-byte-encoding">single-byte encoding</dfn>. <a data-link-type="dfn" href="#single-byte-encoding" id="ref-for-single-byte-encoding-1">Single-byte encodings</a> share the <a data-link-type="dfn" href="#decoder" id="ref-for-decoder-17">decoder</a> and <a data-link-type="dfn" href="#encoder" id="ref-for-encoder-13">encoder</a>. <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport="" id="index-single-byte">Index single-byte</dfn>,
as referenced by the <a data-link-type="dfn" href="#single-byte-decoder" id="ref-for-single-byte-decoder-1">single-byte decoder</a> and <a data-link-type="dfn" href="#single-byte-encoder" id="ref-for-single-byte-encoder-1">single-byte encoder</a>,  is defined by the following table, and
depends on the <a data-link-type="dfn" href="#single-byte-encoding" id="ref-for-single-byte-encoding-2">single-byte encoding</a> in use. All but two <a data-link-type="dfn" href="#single-byte-encoding" id="ref-for-single-byte-encoding-3">single-byte encodings</a> have a
unique <a data-link-type="dfn" href="#index" id="ref-for-index-12">index</a>. </p>
   <table>
    <tbody>
     <tr>
      <td><dfn class="dfn-paneled" data-dfn-type="dfn" data-export="" id="ibm866">IBM866</dfn>
      <td><a href="https://encoding.spec.whatwg.org/index-ibm866.txt">index-ibm866.txt</a>
      <td><a href="https://encoding.spec.whatwg.org/ibm866.html">index IBM866 visualization</a>
      <td><a href="https://encoding.spec.whatwg.org/ibm866-bmp.html">index IBM866 BMP coverage</a> 
     <tr>
      <td><dfn class="dfn-paneled" data-dfn-type="dfn" data-export="" id="iso-8859-2">ISO-8859-2</dfn>
      <td><a href="https://encoding.spec.whatwg.org/index-iso-8859-2.txt">index-iso-8859-2.txt</a>
      <td><a href="https://encoding.spec.whatwg.org/iso-8859-2.html">index ISO-8859-2 visualization</a>
      <td><a href="https://encoding.spec.whatwg.org/iso-8859-2-bmp.html">index ISO-8859-2 BMP coverage</a> 
     <tr>
      <td><dfn class="dfn-paneled" data-dfn-type="dfn" data-export="" id="iso-8859-3">ISO-8859-3</dfn>
      <td><a href="https://encoding.spec.whatwg.org/index-iso-8859-3.txt">index-iso-8859-3.txt</a>
      <td><a href="https://encoding.spec.whatwg.org/iso-8859-3.html">index ISO-8859-3 visualization</a>
      <td><a href="https://encoding.spec.whatwg.org/iso-8859-3-bmp.html">index ISO-8859-3 BMP coverage</a> 
     <tr>
      <td><dfn class="dfn-paneled" data-dfn-type="dfn" data-export="" id="iso-8859-4">ISO-8859-4</dfn>
      <td><a href="https://encoding.spec.whatwg.org/index-iso-8859-4.txt">index-iso-8859-4.txt</a>
      <td><a href="https://encoding.spec.whatwg.org/iso-8859-4.html">index ISO-8859-4 visualization</a>
      <td><a href="https://encoding.spec.whatwg.org/iso-8859-4-bmp.html">index ISO-8859-4 BMP coverage</a> 
     <tr>
      <td><dfn class="dfn-paneled" data-dfn-type="dfn" data-export="" id="iso-8859-5">ISO-8859-5</dfn>
      <td><a href="https://encoding.spec.whatwg.org/index-iso-8859-5.txt">index-iso-8859-5.txt</a>
      <td><a href="https://encoding.spec.whatwg.org/iso-8859-5.html">index ISO-8859-5 visualization</a>
      <td><a href="https://encoding.spec.whatwg.org/iso-8859-5-bmp.html">index ISO-8859-5 BMP coverage</a> 
     <tr>
      <td><dfn class="dfn-paneled" data-dfn-type="dfn" data-export="" id="iso-8859-6">ISO-8859-6</dfn>
      <td><a href="https://encoding.spec.whatwg.org/index-iso-8859-6.txt">index-iso-8859-6.txt</a>
      <td><a href="https://encoding.spec.whatwg.org/iso-8859-6.html">index ISO-8859-6 visualization</a>
      <td><a href="https://encoding.spec.whatwg.org/iso-8859-6-bmp.html">index ISO-8859-6 BMP coverage</a> 
     <tr>
      <td><dfn class="dfn-paneled" data-dfn-type="dfn" data-export="" id="iso-8859-7">ISO-8859-7</dfn>
      <td><a href="https://encoding.spec.whatwg.org/index-iso-8859-7.txt">index-iso-8859-7.txt</a>
      <td><a href="https://encoding.spec.whatwg.org/iso-8859-7.html">index ISO-8859-7 visualization</a>
      <td><a href="https://encoding.spec.whatwg.org/iso-8859-7-bmp.html">index ISO-8859-7 BMP coverage</a> 
     <tr>
      <td><dfn class="dfn-paneled" data-dfn-type="dfn" data-export="" id="iso-8859-8">ISO-8859-8</dfn>
      <td rowspan="2"><a href="https://encoding.spec.whatwg.org/index-iso-8859-8.txt">index-iso-8859-8.txt</a>
      <td rowspan="2"><a href="https://encoding.spec.whatwg.org/iso-8859-8.html">index ISO-8859-8 visualization</a>
      <td rowspan="2"><a href="https://encoding.spec.whatwg.org/iso-8859-8-bmp.html">index ISO-8859-8 BMP coverage</a> 
     <tr>
      <td><dfn class="dfn-paneled" data-dfn-type="dfn" data-export="" id="iso-8859-8-i">ISO-8859-8-I</dfn> 
     <tr>
      <td><dfn class="dfn-paneled" data-dfn-type="dfn" data-export="" id="iso-8859-10">ISO-8859-10</dfn>
      <td><a href="https://encoding.spec.whatwg.org/index-iso-8859-10.txt">index-iso-8859-10.txt</a>
      <td><a href="https://encoding.spec.whatwg.org/iso-8859-10.html">index ISO-8859-10 visualization</a>
      <td><a href="https://encoding.spec.whatwg.org/iso-8859-10-bmp.html">index ISO-8859-10 BMP coverage</a> 
     <tr>
      <td><dfn class="dfn-paneled" data-dfn-type="dfn" data-export="" id="iso-8859-13">ISO-8859-13</dfn>
      <td><a href="https://encoding.spec.whatwg.org/index-iso-8859-13.txt">index-iso-8859-13.txt</a>
      <td><a href="https://encoding.spec.whatwg.org/iso-8859-13.html">index ISO-8859-13 visualization</a>
      <td><a href="https://encoding.spec.whatwg.org/iso-8859-13-bmp.html">index ISO-8859-13 BMP coverage</a> 
     <tr>
      <td><dfn class="dfn-paneled" data-dfn-type="dfn" data-export="" id="iso-8859-14">ISO-8859-14</dfn>
      <td><a href="https://encoding.spec.whatwg.org/index-iso-8859-14.txt">index-iso-8859-14.txt</a>
      <td><a href="https://encoding.spec.whatwg.org/iso-8859-14.html">index ISO-8859-14 visualization</a>
      <td><a href="https://encoding.spec.whatwg.org/iso-8859-14-bmp.html">index ISO-8859-14 BMP coverage</a> 
     <tr>
      <td><dfn class="dfn-paneled" data-dfn-type="dfn" data-export="" id="iso-8859-15">ISO-8859-15</dfn>
      <td><a href="https://encoding.spec.whatwg.org/index-iso-8859-15.txt">index-iso-8859-15.txt</a>
      <td><a href="https://encoding.spec.whatwg.org/iso-8859-15.html">index ISO-8859-15 visualization</a>
      <td><a href="https://encoding.spec.whatwg.org/iso-8859-15-bmp.html">index ISO-8859-15 BMP coverage</a> 
     <tr>
      <td><dfn class="dfn-paneled" data-dfn-type="dfn" data-export="" id="iso-8859-16">ISO-8859-16</dfn>
      <td><a href="https://encoding.spec.whatwg.org/index-iso-8859-16.txt">index-iso-8859-16.txt</a>
      <td><a href="https://encoding.spec.whatwg.org/iso-8859-16.html">index ISO-8859-16 visualization</a>
      <td><a href="https://encoding.spec.whatwg.org/iso-8859-16-bmp.html">index ISO-8859-16 BMP coverage</a> 
     <tr>
      <td><dfn class="dfn-paneled" data-dfn-type="dfn" data-export="" id="koi8-r">KOI8-R</dfn>
      <td><a href="https://encoding.spec.whatwg.org/index-koi8-r.txt">index-koi8-r.txt</a>
      <td><a href="https://encoding.spec.whatwg.org/koi8-r.html">index KOI8-R visualization</a>
      <td><a href="https://encoding.spec.whatwg.org/koi8-r-bmp.html">index KOI8-R BMP coverage</a> 
     <tr>
      <td><dfn class="dfn-paneled" data-dfn-type="dfn" data-export="" id="koi8-u">KOI8-U</dfn>
      <td><a href="https://encoding.spec.whatwg.org/index-koi8-u.txt">index-koi8-u.txt</a>
      <td><a href="https://encoding.spec.whatwg.org/koi8-u.html">index KOI8-U visualization</a>
      <td><a href="https://encoding.spec.whatwg.org/koi8-u-bmp.html">index KOI8-U BMP coverage</a> 
     <tr>
      <td><dfn class="dfn-paneled" data-dfn-type="dfn" data-export="" id="macintosh">macintosh</dfn>
      <td><a href="https://encoding.spec.whatwg.org/index-macintosh.txt">index-macintosh.txt</a>
      <td><a href="https://encoding.spec.whatwg.org/macintosh.html">index macintosh visualization</a>
      <td><a href="https://encoding.spec.whatwg.org/macintosh-bmp.html">index macintosh BMP coverage</a> 
     <tr>
      <td><dfn class="dfn-paneled" data-dfn-type="dfn" data-export="" id="windows-874">windows-874</dfn>
      <td><a href="https://encoding.spec.whatwg.org/index-windows-874.txt">index-windows-874.txt</a>
      <td><a href="https://encoding.spec.whatwg.org/windows-874.html">index windows-874 visualization</a>
      <td><a href="https://encoding.spec.whatwg.org/windows-874-bmp.html">index windows-874 BMP coverage</a> 
     <tr>
      <td><dfn class="dfn-paneled" data-dfn-type="dfn" data-export="" id="windows-1250">windows-1250</dfn>
      <td><a href="https://encoding.spec.whatwg.org/index-windows-1250.txt">index-windows-1250.txt</a>
      <td><a href="https://encoding.spec.whatwg.org/windows-1250.html">index windows-1250 visualization</a>
      <td><a href="https://encoding.spec.whatwg.org/windows-1250-bmp.html">index windows-1250 BMP coverage</a> 
     <tr>
      <td><dfn class="dfn-paneled" data-dfn-type="dfn" data-export="" id="windows-1251">windows-1251</dfn>
      <td><a href="https://encoding.spec.whatwg.org/index-windows-1251.txt">index-windows-1251.txt</a>
      <td><a href="https://encoding.spec.whatwg.org/windows-1251.html">index windows-1251 visualization</a>
      <td><a href="https://encoding.spec.whatwg.org/windows-1251-bmp.html">index windows-1251 BMP coverage</a> 
     <tr>
      <td><dfn class="dfn-paneled" data-dfn-type="dfn" data-export="" id="windows-1252">windows-1252</dfn>
      <td><a href="https://encoding.spec.whatwg.org/index-windows-1252.txt">index-windows-1252.txt</a>
      <td><a href="https://encoding.spec.whatwg.org/windows-1252.html">index windows-1252 visualization</a>
      <td><a href="https://encoding.spec.whatwg.org/windows-1252-bmp.html">index windows-1252 BMP coverage</a> 
     <tr>
      <td><dfn class="dfn-paneled" data-dfn-type="dfn" data-export="" id="windows-1253">windows-1253</dfn>
      <td><a href="https://encoding.spec.whatwg.org/index-windows-1253.txt">index-windows-1253.txt</a>
      <td><a href="https://encoding.spec.whatwg.org/windows-1253.html">index windows-1253 visualization</a>
      <td><a href="https://encoding.spec.whatwg.org/windows-1253-bmp.html">index windows-1253 BMP coverage</a> 
     <tr>
      <td><dfn class="dfn-paneled" data-dfn-type="dfn" data-export="" id="windows-1254">windows-1254</dfn>
      <td><a href="https://encoding.spec.whatwg.org/index-windows-1254.txt">index-windows-1254.txt</a>
      <td><a href="https://encoding.spec.whatwg.org/windows-1254.html">index windows-1254 visualization</a>
      <td><a href="https://encoding.spec.whatwg.org/windows-1254-bmp.html">index windows-1254 BMP coverage</a> 
     <tr>
      <td><dfn class="dfn-paneled" data-dfn-type="dfn" data-export="" id="windows-1255">windows-1255</dfn>
      <td><a href="https://encoding.spec.whatwg.org/index-windows-1255.txt">index-windows-1255.txt</a>
      <td><a href="https://encoding.spec.whatwg.org/windows-1255.html">index windows-1255 visualization</a>
      <td><a href="https://encoding.spec.whatwg.org/windows-1255-bmp.html">index windows-1255 BMP coverage</a> 
     <tr>
      <td><dfn class="dfn-paneled" data-dfn-type="dfn" data-export="" id="windows-1256">windows-1256</dfn>
      <td><a href="https://encoding.spec.whatwg.org/index-windows-1256.txt">index-windows-1256.txt</a>
      <td><a href="https://encoding.spec.whatwg.org/windows-1256.html">index windows-1256 visualization</a>
      <td><a href="https://encoding.spec.whatwg.org/windows-1256-bmp.html">index windows-1256 BMP coverage</a> 
     <tr>
      <td><dfn class="dfn-paneled" data-dfn-type="dfn" data-export="" id="windows-1257">windows-1257</dfn>
      <td><a href="https://encoding.spec.whatwg.org/index-windows-1257.txt">index-windows-1257.txt</a>
      <td><a href="https://encoding.spec.whatwg.org/windows-1257.html">index windows-1257 visualization</a>
      <td><a href="https://encoding.spec.whatwg.org/windows-1257-bmp.html">index windows-1257 BMP coverage</a> 
     <tr>
      <td><dfn class="dfn-paneled" data-dfn-type="dfn" data-export="" id="windows-1258">windows-1258</dfn>
      <td><a href="https://encoding.spec.whatwg.org/index-windows-1258.txt">index-windows-1258.txt</a>
      <td><a href="https://encoding.spec.whatwg.org/windows-1258.html">index windows-1258 visualization</a>
      <td><a href="https://encoding.spec.whatwg.org/windows-1258-bmp.html">index windows-1258 BMP coverage</a> 
     <tr>
      <td><dfn class="dfn-paneled" data-dfn-type="dfn" data-export="" id="x-mac-cyrillic">x-mac-cyrillic</dfn>
      <td><a href="https://encoding.spec.whatwg.org/index-x-mac-cyrillic.txt">index-x-mac-cyrillic.txt</a>
      <td><a href="https://encoding.spec.whatwg.org/x-mac-cyrillic.html">index x-mac-cyrillic visualization</a>
      <td><a href="https://encoding.spec.whatwg.org/x-mac-cyrillic-bmp.html">index x-mac-cyrillic BMP coverage</a> 
   </table>
   <p class="note" role="note"><a data-link-type="dfn" href="#iso-8859-8" id="ref-for-iso-8859-8-2">ISO-8859-8</a> and <a data-link-type="dfn" href="#iso-8859-8-i" id="ref-for-iso-8859-8-i-2">ISO-8859-8-I</a> are
distinct <a data-link-type="dfn" href="#encoding" id="ref-for-encoding-21">encoding</a> <a data-link-type="dfn" href="#name" id="ref-for-name-5">names</a>, because <a data-link-type="dfn" href="#iso-8859-8" id="ref-for-iso-8859-8-3">ISO-8859-8</a> has influence on the layout direction. And although
historically this might have been the case for <a data-link-type="dfn" href="#iso-8859-6" id="ref-for-iso-8859-6-2">ISO-8859-6</a> and
"ISO-8859-6-I" as well, that is no longer true. </p>
   <h3 class="heading settled dfn-paneled" data-dfn-type="dfn" data-export="" data-level="9.1" data-lt="single-byte decoder" id="single-byte-decoder"><span class="secno">9.1. </span><span class="content">single-byte decoder</span></h3>
   <p><a data-link-type="dfn" href="#single-byte-encoding" id="ref-for-single-byte-encoding-4">Single-byte encodings</a>’s <a data-link-type="dfn" href="#decoder" id="ref-for-decoder-18">decoder</a>’s <a data-link-type="dfn" href="#handler" id="ref-for-handler-5">handler</a>, given a <var>stream</var> and <var>byte</var>, runs these steps: </p>
   <ol>
    <li>
     <p>If <var>byte</var> is <a data-link-type="dfn" href="#end-of-stream" id="ref-for-end-of-stream-10">end-of-stream</a>, return <a data-link-type="dfn" href="#finished" id="ref-for-finished-6">finished</a>. </p>
    <li>
     <p>If <var>byte</var> is an <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#ascii-byte">ASCII byte</a>, return a code point whose value
 is <var>byte</var>. </p>
    <li>
     <p>Let <var>code point</var> be the <a data-link-type="dfn" href="#index-code-point" id="ref-for-index-code-point-1">index code point</a> for <var>byte</var> − 0x80 in <a data-link-type="dfn" href="#index-single-byte" id="ref-for-index-single-byte-2">index single-byte</a>. </p>
    <li>
     <p>If <var>code point</var> is null, return <a data-link-type="dfn" href="#error" id="ref-for-error-11">error</a>. </p>
    <li>
     <p>Return a code point whose value is <var>code point</var>. </p>
   </ol>
   <h3 class="heading settled dfn-paneled" data-dfn-type="dfn" data-export="" data-level="9.2" data-lt="single-byte encoder" id="single-byte-encoder"><span class="secno">9.2. </span><span class="content">single-byte encoder</span></h3>
   <p><a data-link-type="dfn" href="#single-byte-encoding" id="ref-for-single-byte-encoding-5">Single-byte encodings</a>’s <a data-link-type="dfn" href="#encoder" id="ref-for-encoder-14">encoder</a>’s <a data-link-type="dfn" href="#handler" id="ref-for-handler-6">handler</a>, given a <var>stream</var> and <var>code point</var>, runs these steps: </p>
   <ol>
    <li>
     <p>If <var>code point</var> is <a data-link-type="dfn" href="#end-of-stream" id="ref-for-end-of-stream-11">end-of-stream</a>, return <a data-link-type="dfn" href="#finished" id="ref-for-finished-7">finished</a>. </p>
    <li>
     <p>If <var>code point</var> is an <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#ascii-code-point">ASCII code point</a>, return
 a byte whose value is <var>code point</var>. </p>
    <li>
     <p>Let <var>pointer</var> be the <a data-link-type="dfn" href="#index-pointer" id="ref-for-index-pointer-3">index pointer</a> for <var>code point</var> in <a data-link-type="dfn" href="#index-single-byte" id="ref-for-index-single-byte-3">index single-byte</a>. </p>
    <li>
     <p>If <var>pointer</var> is null, return <a data-link-type="dfn" href="#error" id="ref-for-error-12">error</a> with <var>code point</var>. </p>
    <li>
     <p>Return a byte whose value is <var>pointer</var> + 0x80. </p>
   </ol>
   <h2 class="heading settled" data-level="10" id="legacy-multi-byte-chinese-(simplified)-encodings"><span class="secno">10. </span><span class="content">Legacy multi-byte Chinese (simplified) encodings</span><a class="self-link" href="#legacy-multi-byte-chinese-%28simplified%29-encodings"></a></h2>
   <h3 class="heading settled dfn-paneled" data-dfn-type="dfn" data-export="" data-level="10.1" data-lt="GBK" id="gbk"><span class="secno">10.1. </span><span class="content">GBK</span></h3>
   <h4 class="heading settled" data-dfn-type="dfn" data-export="" data-level="10.1.1" data-lt="GBK decoder" id="gbk-decoder"><span class="secno">10.1.1. </span><span class="content">GBK decoder</span><a class="self-link" href="#gbk-decoder"></a></h4>
   <p><a data-link-type="dfn" href="#gbk" id="ref-for-gbk-2">GBK</a>’s <a data-link-type="dfn" href="#decoder" id="ref-for-decoder-19">decoder</a> is <a data-link-type="dfn" href="#gb18030" id="ref-for-gb18030-2">gb18030</a>’s <a data-link-type="dfn" href="#decoder" id="ref-for-decoder-20">decoder</a>. </p>
   <h4 class="heading settled" data-dfn-type="dfn" data-export="" data-level="10.1.2" data-lt="GBK encoder" id="gbk-encoder"><span class="secno">10.1.2. </span><span class="content">GBK encoder</span><a class="self-link" href="#gbk-encoder"></a></h4>
   <p><a data-link-type="dfn" href="#gbk" id="ref-for-gbk-3">GBK</a>’s <a data-link-type="dfn" href="#encoder" id="ref-for-encoder-15">encoder</a> is <a data-link-type="dfn" href="#gb18030" id="ref-for-gb18030-3">gb18030</a>’s <a data-link-type="dfn" href="#encoder" id="ref-for-encoder-16">encoder</a> with its <a data-link-type="dfn" href="#gbk-flag" id="ref-for-gbk-flag-1">GBK flag</a> set. </p>
   <p class="note no-backref" role="note">Not fully aliasing <a data-link-type="dfn" href="#gbk" id="ref-for-gbk-4">GBK</a> with <a data-link-type="dfn" href="#gb18030" id="ref-for-gb18030-4">gb18030</a> is a conservative move to decrease the chances of breaking legacy servers and other
consumers of content generated with <a data-link-type="dfn" href="#gbk" id="ref-for-gbk-5">GBK</a>’s <a data-link-type="dfn" href="#encoder" id="ref-for-encoder-17">encoder</a>. </p>
   <h3 class="heading settled dfn-paneled" data-dfn-type="dfn" data-export="" data-level="10.2" data-lt="gb18030" id="gb18030"><span class="secno">10.2. </span><span class="content">gb18030</span></h3>
   <h4 class="heading settled" data-dfn-type="dfn" data-export="" data-level="10.2.1" data-lt="gb18030 decoder" id="gb18030-decoder"><span class="secno">10.2.1. </span><span class="content">gb18030 decoder</span><a class="self-link" href="#gb18030-decoder"></a></h4>
   <p><a data-link-type="dfn" href="#gb18030" id="ref-for-gb18030-5">gb18030</a>’s <a data-link-type="dfn" href="#decoder" id="ref-for-decoder-21">decoder</a> has an associated <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport="" id="gb18030-first">gb18030 first</dfn>, <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport="" id="gb18030-second">gb18030 second</dfn>, and <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport="" id="gb18030-third">gb18030 third</dfn> (all initially 0x00). </p>
   <p><a data-link-type="dfn" href="#gb18030" id="ref-for-gb18030-6">gb18030</a>’s <a data-link-type="dfn" href="#decoder" id="ref-for-decoder-22">decoder</a>’s <a data-link-type="dfn" href="#handler" id="ref-for-handler-7">handler</a>, given a <var>stream</var> and <var>byte</var>, runs these steps: </p>
   <ol>
    <li>
     <p>If <var>byte</var> is <a data-link-type="dfn" href="#end-of-stream" id="ref-for-end-of-stream-12">end-of-stream</a> and <a data-link-type="dfn" href="#gb18030-first" id="ref-for-gb18030-first-1">gb18030 first</a>, <a data-link-type="dfn" href="#gb18030-second" id="ref-for-gb18030-second-1">gb18030 second</a>, and <a data-link-type="dfn" href="#gb18030-third" id="ref-for-gb18030-third-1">gb18030 third</a> are 0x00, return <a data-link-type="dfn" href="#finished" id="ref-for-finished-8">finished</a>. </p>
    <li>
     <p>If <var>byte</var> is <a data-link-type="dfn" href="#end-of-stream" id="ref-for-end-of-stream-13">end-of-stream</a>, and <a data-link-type="dfn" href="#gb18030-first" id="ref-for-gb18030-first-2">gb18030 first</a>, <a data-link-type="dfn" href="#gb18030-second" id="ref-for-gb18030-second-2">gb18030 second</a>, or <a data-link-type="dfn" href="#gb18030-third" id="ref-for-gb18030-third-2">gb18030 third</a> is not 0x00, set <a data-link-type="dfn" href="#gb18030-first" id="ref-for-gb18030-first-3">gb18030 first</a>, <a data-link-type="dfn" href="#gb18030-second" id="ref-for-gb18030-second-3">gb18030 second</a>, and <a data-link-type="dfn" href="#gb18030-third" id="ref-for-gb18030-third-3">gb18030 third</a> to 0x00, and return <a data-link-type="dfn" href="#error" id="ref-for-error-13">error</a>. </p>
    <li>
     <p>If <a data-link-type="dfn" href="#gb18030-third" id="ref-for-gb18030-third-4">gb18030 third</a> is not 0x00, then: </p>
     <ol>
      <li>
       <p>If <var>byte</var> is not in the range 0x30 to 0x39, inclusive, then: </p>
       <ol>
        <li>
         <p><a data-link-type="dfn" href="#concept-stream-prepend" id="ref-for-concept-stream-prepend-6">Prepend</a> <a data-link-type="dfn" href="#gb18030-second" id="ref-for-gb18030-second-4">gb18030 second</a>, <a data-link-type="dfn" href="#gb18030-third" id="ref-for-gb18030-third-5">gb18030 third</a>, and <var>byte</var> to <var>stream</var>. </p>
        <li>
         <p>Set <a data-link-type="dfn" href="#gb18030-first" id="ref-for-gb18030-first-4">gb18030 first</a>, <a data-link-type="dfn" href="#gb18030-second" id="ref-for-gb18030-second-5">gb18030 second</a>, and <a data-link-type="dfn" href="#gb18030-third" id="ref-for-gb18030-third-6">gb18030 third</a> to 0x00. </p>
        <li>
         <p>Return <a data-link-type="dfn" href="#error" id="ref-for-error-14">error</a>. </p>
       </ol>
      <li>
       <p>Let <var>code point</var> be the <a data-link-type="dfn" href="#index-gb18030-ranges-code-point" id="ref-for-index-gb18030-ranges-code-point-2">index gb18030 ranges code point</a> for
   ((<a data-link-type="dfn" href="#gb18030-first" id="ref-for-gb18030-first-5">gb18030 first</a> − 0x81) × (10 × 126 × 10)) +
   ((<a data-link-type="dfn" href="#gb18030-second" id="ref-for-gb18030-second-6">gb18030 second</a> − 0x30) × (10 × 126)) +
   ((<a data-link-type="dfn" href="#gb18030-third" id="ref-for-gb18030-third-7">gb18030 third</a> − 0x81) × 10) + <var>byte</var> − 0x30. </p>
      <li>
       <p>If <var>code point</var> is null, return <a data-link-type="dfn" href="#error" id="ref-for-error-15">error</a>. </p>
      <li>
       <p>Return a code point whose value is <var>code point</var>. </p>
     </ol>
    <li>
     <p>If <a data-link-type="dfn" href="#gb18030-second" id="ref-for-gb18030-second-7">gb18030 second</a> is not 0x00, then: </p>
     <ol>
      <li>
       <p>If <var>byte</var> is in the range 0x81 to 0xFE, inclusive, set <a data-link-type="dfn" href="#gb18030-third" id="ref-for-gb18030-third-8">gb18030 third</a> to <var>byte</var> and return <a data-link-type="dfn" href="#continue" id="ref-for-continue-6">continue</a>. </p>
      <li>
       <p><a data-link-type="dfn" href="#concept-stream-prepend" id="ref-for-concept-stream-prepend-7">Prepend</a> <a data-link-type="dfn" href="#gb18030-second" id="ref-for-gb18030-second-8">gb18030 second</a> followed by <var>byte</var> to <var>stream</var>, set <a data-link-type="dfn" href="#gb18030-first" id="ref-for-gb18030-first-6">gb18030 first</a> and <a data-link-type="dfn" href="#gb18030-second" id="ref-for-gb18030-second-9">gb18030 second</a> to 0x00, and return <a data-link-type="dfn" href="#error" id="ref-for-error-16">error</a>. </p>
     </ol>
    <li>
     <p>If <a data-link-type="dfn" href="#gb18030-first" id="ref-for-gb18030-first-7">gb18030 first</a> is not 0x00, then: </p>
     <ol>
      <li>
       <p>If <var>byte</var> is in the range 0x30 to 0x39, inclusive, set <a data-link-type="dfn" href="#gb18030-second" id="ref-for-gb18030-second-10">gb18030 second</a> to <var>byte</var> and return <a data-link-type="dfn" href="#continue" id="ref-for-continue-7">continue</a>. </p>
      <li>
       <p>Let <var>lead</var> be <a data-link-type="dfn" href="#gb18030-first" id="ref-for-gb18030-first-8">gb18030 first</a>, let <var>pointer</var> be null, and set <a data-link-type="dfn" href="#gb18030-first" id="ref-for-gb18030-first-9">gb18030 first</a> to 0x00. </p>
      <li>
       <p>Let <var>offset</var> be 0x40 if <var>byte</var> is
   less than 0x7F and 0x41 otherwise. </p>
      <li>
       <p>If <var>byte</var> is in the range 0x40 to 0x7E, inclusive, or
   0x80 to 0xFE, inclusive, set <var>pointer</var> to
   (<var>lead</var> − 0x81) × 190 + (<var>byte</var> − <var>offset</var>). </p>
      <li>
       <p>Let <var>code point</var> be null if <var>pointer</var> is null and the <a data-link-type="dfn" href="#index-code-point" id="ref-for-index-code-point-2">index code point</a> for <var>pointer</var> in <a data-link-type="dfn" href="#index-gb18030" id="ref-for-index-gb18030-1">index gb18030</a> otherwise. </p>
      <li>
       <p>If <var>code point</var> is non-null, return a code point whose value is <var>code point</var>. </p>
      <li>
       <p>If <var>byte</var> is an <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#ascii-byte">ASCII byte</a>, <a data-link-type="dfn" href="#concept-stream-prepend" id="ref-for-concept-stream-prepend-8">prepend</a> <var>byte</var> to <var>stream</var>. </p>
      <li>
       <p>Return <a data-link-type="dfn" href="#error" id="ref-for-error-17">error</a>. </p>
     </ol>
    <li>
     <p>If <var>byte</var> is an <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#ascii-byte">ASCII byte</a>, return
 a code point whose value is <var>byte</var>. </p>
    <li>
     <p>If <var>byte</var> is 0x80, return code point U+20AC. </p>
    <li>
     <p>If <var>byte</var> is in the range 0x81 to 0xFE, inclusive, set <a data-link-type="dfn" href="#gb18030-first" id="ref-for-gb18030-first-10">gb18030 first</a> to <var>byte</var> and return <a data-link-type="dfn" href="#continue" id="ref-for-continue-8">continue</a>. </p>
    <li>
     <p>Return <a data-link-type="dfn" href="#error" id="ref-for-error-18">error</a>. </p>
   </ol>
   <h4 class="heading settled" data-dfn-type="dfn" data-export="" data-level="10.2.2" data-lt="gb18030 encoder" id="gb18030-encoder"><span class="secno">10.2.2. </span><span class="content">gb18030 encoder</span><a class="self-link" href="#gb18030-encoder"></a></h4>
   <p><a data-link-type="dfn" href="#gb18030" id="ref-for-gb18030-7">gb18030</a>’s <a data-link-type="dfn" href="#encoder" id="ref-for-encoder-18">encoder</a> has an associated <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport="" id="gbk-flag">GBK flag</dfn> (initially unset). </p>
   <p><a data-link-type="dfn" href="#gb18030" id="ref-for-gb18030-8">gb18030</a>’s <a data-link-type="dfn" href="#encoder" id="ref-for-encoder-19">encoder</a>’s <a data-link-type="dfn" href="#handler" id="ref-for-handler-8">handler</a>, given a <var>stream</var> and <var>code point</var>, runs these steps: </p>
   <ol>
    <li>
     <p>If <var>code point</var> is <a data-link-type="dfn" href="#end-of-stream" id="ref-for-end-of-stream-14">end-of-stream</a>, return <a data-link-type="dfn" href="#finished" id="ref-for-finished-9">finished</a>. </p>
    <li>
     <p>If <var>code point</var> is an <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#ascii-code-point">ASCII code point</a>, return
 a byte whose value is <var>code point</var>. </p>
    <li>
     <p>If <var>code point</var> is U+E5E5, return <a data-link-type="dfn" href="#error" id="ref-for-error-19">error</a> with <var>code point</var>. </p>
     <p class="note" role="note"><a data-link-type="dfn" href="#index-gb18030" id="ref-for-index-gb18030-2">Index gb18030</a> maps 0xA3 0xA0 to U+3000 rather than U+E5E5 for
  compatibility with deployed content. Therefore it cannot roundtrip. </p>
    <li>
     <p>If the <a data-link-type="dfn" href="#gbk-flag" id="ref-for-gbk-flag-2">GBK flag</a> is set and <var>code point</var> is
 U+20AC, return byte 0x80. </p>
    <li>
     <p>Let <var>pointer</var> be the <a data-link-type="dfn" href="#index-pointer" id="ref-for-index-pointer-4">index pointer</a> for <var>code point</var> in <a data-link-type="dfn" href="#index-gb18030" id="ref-for-index-gb18030-3">index gb18030</a>. </p>
    <li>
     <p>If <var>pointer</var> is non-null, then: </p>
     <ol>
      <li>
       <p>Let <var>lead</var> be <var>pointer</var> / 190 + 0x81. </p>
      <li>
       <p>Let <var>trail</var> be <var>pointer</var> % 190. </p>
      <li>
       <p>Let <var>offset</var> be 0x40 if <var>trail</var> is
   less than 0x3F and 0x41 otherwise. </p>
      <li>
       <p>Return two bytes whose values are <var>lead</var> and <var>trail</var> + <var>offset</var>. </p>
     </ol>
    <li>
     <p>If <a data-link-type="dfn" href="#gbk-flag" id="ref-for-gbk-flag-3">GBK flag</a> is set, return <a data-link-type="dfn" href="#error" id="ref-for-error-20">error</a> with <var>code point</var>. </p>
    <li>
     <p>Set <var>pointer</var> to the <a data-link-type="dfn" href="#index-gb18030-ranges-pointer" id="ref-for-index-gb18030-ranges-pointer-2">index gb18030 ranges pointer</a> for <var>code point</var>. </p>
    <li>
     <p>Let <var>byte1</var> be <var>pointer</var> / (10 × 126 × 10). </p>
    <li>
     <p>Set <var>pointer</var> to <var>pointer</var> % (10 × 126 × 10). </p>
    <li>
     <p>Let <var>byte2</var> be <var>pointer</var> / (10 × 126). </p>
    <li>
     <p>Set <var>pointer</var> to <var>pointer</var> % (10 × 126). </p>
    <li>
     <p>Let <var>byte3</var> be <var>pointer</var> / 10. </p>
    <li>
     <p>Let <var>byte4</var> be <var>pointer</var> % 10. </p>
    <li>
     <p>Return four bytes whose values are <var>byte1</var> + 0x81, <var>byte2</var> + 0x30, <var>byte3</var> + 0x81, <var>byte4</var> + 0x30. </p>
   </ol>
   <h2 class="heading settled" data-level="11" id="legacy-multi-byte-chinese-(traditional)-encodings"><span class="secno">11. </span><span class="content">Legacy multi-byte Chinese (traditional) encodings</span><a class="self-link" href="#legacy-multi-byte-chinese-%28traditional%29-encodings"></a></h2>
   <h3 class="heading settled dfn-paneled" data-dfn-type="dfn" data-export="" data-level="11.1" data-lt="Big5" id="big5"><span class="secno">11.1. </span><span class="content">Big5</span></h3>
   <h4 class="heading settled" data-dfn-type="dfn" data-export="" data-level="11.1.1" data-lt="Big5 decoder" id="big5-decoder"><span class="secno">11.1.1. </span><span class="content">Big5 decoder</span><a class="self-link" href="#big5-decoder"></a></h4>
   <p><a data-link-type="dfn" href="#big5" id="ref-for-big5-2">Big5</a>’s <a data-link-type="dfn" href="#decoder" id="ref-for-decoder-23">decoder</a> has an associated <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport="" id="big5-lead">Big5 lead</dfn> (initially 0x00). </p>
   <p><a data-link-type="dfn" href="#big5" id="ref-for-big5-3">Big5</a>’s <a data-link-type="dfn" href="#decoder" id="ref-for-decoder-24">decoder</a>’s <a data-link-type="dfn" href="#handler" id="ref-for-handler-9">handler</a>, given a <var>stream</var> and <var>byte</var>, runs these steps:</p>
   <ol>
    <li>
     <p>If <var>byte</var> is <a data-link-type="dfn" href="#end-of-stream" id="ref-for-end-of-stream-15">end-of-stream</a> and <a data-link-type="dfn" href="#big5-lead" id="ref-for-big5-lead-1">Big5 lead</a> is not 0x00, set <a data-link-type="dfn" href="#big5-lead" id="ref-for-big5-lead-2">Big5 lead</a> to 0x00 and return <a data-link-type="dfn" href="#error" id="ref-for-error-21">error</a>. </p>
    <li>
     <p>If <var>byte</var> is <a data-link-type="dfn" href="#end-of-stream" id="ref-for-end-of-stream-16">end-of-stream</a> and <a data-link-type="dfn" href="#big5-lead" id="ref-for-big5-lead-3">Big5 lead</a> is 0x00, return <a data-link-type="dfn" href="#finished" id="ref-for-finished-10">finished</a>. </p>
    <li>
     <p>If <a data-link-type="dfn" href="#big5-lead" id="ref-for-big5-lead-4">Big5 lead</a> is not 0x00, let <var>lead</var> be <a data-link-type="dfn" href="#big5-lead" id="ref-for-big5-lead-5">Big5 lead</a>, let <var>pointer</var> be null, set <a data-link-type="dfn" href="#big5-lead" id="ref-for-big5-lead-6">Big5 lead</a> to 0x00, and then: </p>
     <ol>
      <li>
       <p>Let <var>offset</var> be 0x40 if <var>byte</var> is
   less than 0x7F and 0x62 otherwise. </p>
      <li>
       <p>If <var>byte</var> is in the range 0x40 to 0x7E, inclusive, or
   0xA1 to 0xFE, inclusive, set <var>pointer</var> to
   (<var>lead</var> − 0x81) × 157 + (<var>byte</var> − <var>offset</var>). </p>
      <li>
       <p>If there is a row in the table below whose first column is <var>pointer</var>, return the <em>two</em> code points listed in
    its second column (the third column is irrelevant): </p>
       <table>
        <tbody>
         <tr>
          <th>Pointer
          <th>Code points
          <th>Notes 
         <tr>
          <td>1133
          <td>U+00CA U+0304
          <td>Ê̄ (LATIN CAPITAL LETTER E WITH CIRCUMFLEX AND MACRON) 
         <tr>
          <td>1135
          <td>U+00CA U+030C
          <td>Ê̌ (LATIN CAPITAL LETTER E WITH CIRCUMFLEX AND CARON) 
         <tr>
          <td>1164
          <td>U+00EA U+0304
          <td>ê̄ (LATIN SMALL LETTER E WITH CIRCUMFLEX AND MACRON) 
         <tr>
          <td>1166
          <td>U+00EA U+030C
          <td>ê̌ (LATIN SMALL LETTER E WITH CIRCUMFLEX AND CARON) 
       </table>
       <p class="note" role="note">Since <a data-link-type="dfn" href="#index" id="ref-for-index-13">indexes</a> are limited to
    single code points this table is used for these pointers. </p>
      <li>
       <p>Let <var>code point</var> be null if <var>pointer</var> is null and the <a data-link-type="dfn" href="#index-code-point" id="ref-for-index-code-point-3">index code point</a> for <var>pointer</var> in <a data-link-type="dfn" href="#index-big5" id="ref-for-index-big5-2">index Big5</a> otherwise. </p>
      <li>
       <p>If <var>code point</var> is non-null, return a code point whose value is <var>code point</var>. </p>
      <li>
       <p>If <var>byte</var> is an <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#ascii-byte">ASCII byte</a>, <a data-link-type="dfn" href="#concept-stream-prepend" id="ref-for-concept-stream-prepend-9">prepend</a> <var>byte</var> to <var>stream</var>. </p>
      <li>
       <p>Return <a data-link-type="dfn" href="#error" id="ref-for-error-22">error</a>. </p>
     </ol>
    <li>
     <p>If <var>byte</var> is an <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#ascii-byte">ASCII byte</a>, return
 a code point whose value is <var>byte</var>. </p>
    <li>
     <p>If <var>byte</var> is in the range 0x81 to 0xFE, inclusive, set <a data-link-type="dfn" href="#big5-lead" id="ref-for-big5-lead-7">Big5 lead</a> to <var>byte</var> and return <a data-link-type="dfn" href="#continue" id="ref-for-continue-9">continue</a>. </p>
    <li>
     <p>Return <a data-link-type="dfn" href="#error" id="ref-for-error-23">error</a>. </p>
   </ol>
   <h4 class="heading settled" data-dfn-type="dfn" data-export="" data-level="11.1.2" data-lt="Big5 encoder" id="big5-encoder"><span class="secno">11.1.2. </span><span class="content">Big5 encoder</span><a class="self-link" href="#big5-encoder"></a></h4>
   <p><a data-link-type="dfn" href="#big5" id="ref-for-big5-4">Big5</a>’s <a data-link-type="dfn" href="#encoder" id="ref-for-encoder-20">encoder</a>’s <a data-link-type="dfn" href="#handler" id="ref-for-handler-10">handler</a>, given a <var>stream</var> and <var>code point</var>, runs these steps: </p>
   <ol>
    <li>
     <p>If <var>code point</var> is <a data-link-type="dfn" href="#end-of-stream" id="ref-for-end-of-stream-17">end-of-stream</a>, return <a data-link-type="dfn" href="#finished" id="ref-for-finished-11">finished</a>. </p>
    <li>
     <p>If <var>code point</var> is an <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#ascii-code-point">ASCII code point</a>, return
 a byte whose value is <var>code point</var>. </p>
    <li>
     <p>Let <var>pointer</var> be the <a data-link-type="dfn" href="#index-big5-pointer" id="ref-for-index-big5-pointer-1">index Big5 pointer</a> for <var>code point</var>. </p>
    <li>
     <p>If <var>pointer</var> is null, return <a data-link-type="dfn" href="#error" id="ref-for-error-24">error</a> with <var>code point</var>. </p>
    <li>
     <p>Let <var>lead</var> be <var>pointer</var> / 157 + 0x81. </p>
    <li>
     <p>Let <var>trail</var> be <var>pointer</var> % 157. </p>
    <li>
     <p>Let <var>offset</var> be 0x40 if <var>trail</var> is
 less than 0x3F and 0x62 otherwise. </p>
    <li>
     <p>Return two bytes whose values are <var>lead</var> and <var>trail</var> + <var>offset</var>. </p>
   </ol>
   <h2 class="heading settled" data-level="12" id="legacy-multi-byte-japanese-encodings"><span class="secno">12. </span><span class="content">Legacy multi-byte Japanese encodings</span><a class="self-link" href="#legacy-multi-byte-japanese-encodings"></a></h2>
   <h3 class="heading settled dfn-paneled" data-dfn-type="dfn" data-export="" data-level="12.1" data-lt="EUC-JP" id="euc-jp"><span class="secno">12.1. </span><span class="content">EUC-JP</span></h3>
   <h4 class="heading settled dfn-paneled" data-dfn-type="dfn" data-export="" data-level="12.1.1" data-lt="EUC-JP decoder" id="euc-jp-decoder"><span class="secno">12.1.1. </span><span class="content">EUC-JP decoder</span></h4>
   <p><a data-link-type="dfn" href="#euc-jp" id="ref-for-euc-jp-2">EUC-JP</a>’s <a data-link-type="dfn" href="#decoder" id="ref-for-decoder-25">decoder</a> has an associated <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport="" id="euc-jp-jis0212-flag">EUC-JP jis0212 flag</dfn> (initially unset) and <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport="" id="euc-jp-lead">EUC-JP lead</dfn> (initially 0x00). </p>
   <p><a data-link-type="dfn" href="#euc-jp" id="ref-for-euc-jp-3">EUC-JP</a>’s <a data-link-type="dfn" href="#decoder" id="ref-for-decoder-26">decoder</a>’s <a data-link-type="dfn" href="#handler" id="ref-for-handler-11">handler</a>, given a <var>stream</var> and <var>byte</var>, runs these steps: </p>
   <ol>
    <li>
     <p>If <var>byte</var> is <a data-link-type="dfn" href="#end-of-stream" id="ref-for-end-of-stream-18">end-of-stream</a> and <a data-link-type="dfn" href="#euc-jp-lead" id="ref-for-euc-jp-lead-1">EUC-JP lead</a> is not 0x00, set <a data-link-type="dfn" href="#euc-jp-lead" id="ref-for-euc-jp-lead-2">EUC-JP lead</a> to 0x00, and return <a data-link-type="dfn" href="#error" id="ref-for-error-25">error</a>. </p>
    <li>
     <p>If <var>byte</var> is <a data-link-type="dfn" href="#end-of-stream" id="ref-for-end-of-stream-19">end-of-stream</a> and <a data-link-type="dfn" href="#euc-jp-lead" id="ref-for-euc-jp-lead-3">EUC-JP lead</a> is 0x00, return <a data-link-type="dfn" href="#finished" id="ref-for-finished-12">finished</a>. </p>
    <li>
     <p>If <a data-link-type="dfn" href="#euc-jp-lead" id="ref-for-euc-jp-lead-4">EUC-JP lead</a> is 0x8E and <var>byte</var> is
 in the range 0xA1 to 0xDF, inclusive, set <a data-link-type="dfn" href="#euc-jp-lead" id="ref-for-euc-jp-lead-5">EUC-JP lead</a> to 0x00 and return
 a code point whose value is 0xFF61 − 0xA1 + <var>byte</var>. </p>
    <li>
     <p>If <a data-link-type="dfn" href="#euc-jp-lead" id="ref-for-euc-jp-lead-6">EUC-JP lead</a> is 0x8F and <var>byte</var> is in the range
 0xA1 to 0xFE, inclusive, set the <a data-link-type="dfn" href="#euc-jp-jis0212-flag" id="ref-for-euc-jp-jis0212-flag-1">EUC-JP jis0212 flag</a>, set <a data-link-type="dfn" href="#euc-jp-lead" id="ref-for-euc-jp-lead-7">EUC-JP lead</a> to <var>byte</var>, and return <a data-link-type="dfn" href="#continue" id="ref-for-continue-10">continue</a>. </p>
    <li>
     <p>If <a data-link-type="dfn" href="#euc-jp-lead" id="ref-for-euc-jp-lead-8">EUC-JP lead</a> is not 0x00, let <var>lead</var> be <a data-link-type="dfn" href="#euc-jp-lead" id="ref-for-euc-jp-lead-9">EUC-JP lead</a>, set <a data-link-type="dfn" href="#euc-jp-lead" id="ref-for-euc-jp-lead-10">EUC-JP lead</a> to 0x00, and then: </p>
     <ol>
      <li>
       <p>Let <var>code point</var> be null. </p>
      <li>
       <p>If <var>lead</var> and <var>byte</var> are both in the
   range 0xA1 to 0xFE, inclusive, set <var>code point</var> to the <a data-link-type="dfn" href="#index-code-point" id="ref-for-index-code-point-4">index code point</a> for
   (<var>lead</var> − 0xA1) × 94 + <var>byte</var> − 0xA1
   in <a data-link-type="dfn" href="#index-jis0208" id="ref-for-index-jis0208-4">index jis0208</a> if the <a data-link-type="dfn" href="#euc-jp-jis0212-flag" id="ref-for-euc-jp-jis0212-flag-2">EUC-JP jis0212 flag</a> is unset and in <a data-link-type="dfn" href="#index-jis0212" id="ref-for-index-jis0212-1">index jis0212</a> otherwise. </p>
      <li>
       <p>Unset the <a data-link-type="dfn" href="#euc-jp-jis0212-flag" id="ref-for-euc-jp-jis0212-flag-3">EUC-JP jis0212 flag</a>. </p>
      <li>
       <p>If <var>code point</var> is non-null, return a code point whose value is <var>code point</var>. </p>
      <li>
       <p>If <var>byte</var> is an <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#ascii-byte">ASCII byte</a>, <a data-link-type="dfn" href="#concept-stream-prepend" id="ref-for-concept-stream-prepend-10">prepend</a> <var>byte</var> to <var>stream</var>. </p>
      <li>
       <p>Return <a data-link-type="dfn" href="#error" id="ref-for-error-26">error</a>. </p>
     </ol>
    <li>
     <p>If <var>byte</var> is an <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#ascii-byte">ASCII byte</a>, return
 a code point whose value is <var>byte</var>. </p>
    <li>
     <p>If <var>byte</var> is 0x8E, 0x8F, or in the range 0xA1 to
 0xFE, inclusive, set <a data-link-type="dfn" href="#euc-jp-lead" id="ref-for-euc-jp-lead-11">EUC-JP lead</a> to <var>byte</var> and return <a data-link-type="dfn" href="#continue" id="ref-for-continue-11">continue</a>. </p>
    <li>
     <p>Return <a data-link-type="dfn" href="#error" id="ref-for-error-27">error</a>. </p>
   </ol>
   <h4 class="heading settled" data-dfn-type="dfn" data-export="" data-level="12.1.2" data-lt="EUC-JP encoder" id="euc-jp-encoder"><span class="secno">12.1.2. </span><span class="content">EUC-JP encoder</span><a class="self-link" href="#euc-jp-encoder"></a></h4>
   <p><a data-link-type="dfn" href="#euc-jp" id="ref-for-euc-jp-4">EUC-JP</a>’s <a data-link-type="dfn" href="#encoder" id="ref-for-encoder-21">encoder</a>’s <a data-link-type="dfn" href="#handler" id="ref-for-handler-12">handler</a>, given a <var>stream</var> and <var>code point</var>, runs these steps: </p>
   <ol>
    <li>
     <p>If <var>code point</var> is <a data-link-type="dfn" href="#end-of-stream" id="ref-for-end-of-stream-20">end-of-stream</a>, return <a data-link-type="dfn" href="#finished" id="ref-for-finished-13">finished</a>. </p>
    <li>
     <p>If <var>code point</var> is an <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#ascii-code-point">ASCII code point</a>, return
 a byte whose value is <var>code point</var>. </p>
    <li>
     <p>If <var>code point</var> is U+00A5, return byte 0x5C. </p>
    <li>
     <p>If <var>code point</var> is U+203E, return byte 0x7E. </p>
    <li>
     <p>If <var>code point</var> is in the range U+FF61 to U+FF9F, inclusive, return
 two bytes whose values are 0x8E and <var>code point</var> − 0xFF61 + 0xA1. </p>
    <li>
     <p>If <var>code point</var> is U+2212, set it to U+FF0D. </p>
    <li>
     <p>Let <var>pointer</var> be the <a data-link-type="dfn" href="#index-pointer" id="ref-for-index-pointer-5">index pointer</a> for <var>code point</var> in <a data-link-type="dfn" href="#index-jis0208" id="ref-for-index-jis0208-5">index jis0208</a>. </p>
     <p class="note" role="note">If <var>pointer</var> is non-null, it is less than 8836 due to the nature of <a data-link-type="dfn" href="#index-jis0208" id="ref-for-index-jis0208-6">index jis0208</a> and the <a data-link-type="dfn" href="#index-pointer" id="ref-for-index-pointer-6">index pointer</a> operation. </p>
    <li>
     <p>If <var>pointer</var> is null, return <a data-link-type="dfn" href="#error" id="ref-for-error-28">error</a> with <var>code point</var>. </p>
    <li>
     <p>Let <var>lead</var> be <var>pointer</var> / 94 + 0xA1. </p>
    <li>
     <p>Let <var>trail</var> be <var>pointer</var> % 94 + 0xA1. </p>
    <li>
     <p>Return two bytes whose values are <var>lead</var> and <var>trail</var>. </p>
   </ol>
   <h3 class="heading settled dfn-paneled" data-dfn-type="dfn" data-export="" data-level="12.2" data-lt="ISO-2022-JP" id="iso-2022-jp"><span class="secno">12.2. </span><span class="content">ISO-2022-JP</span></h3>
   <h4 class="heading settled" data-dfn-type="dfn" data-export="" data-level="12.2.1" data-lt="ISO-2022-JP decoder" id="iso-2022-jp-decoder"><span class="secno">12.2.1. </span><span class="content">ISO-2022-JP decoder</span><a class="self-link" href="#iso-2022-jp-decoder"></a></h4>
   <p><a data-link-type="dfn" href="#iso-2022-jp" id="ref-for-iso-2022-jp-3">ISO-2022-JP</a>’s <a data-link-type="dfn" href="#decoder" id="ref-for-decoder-27">decoder</a> has an associated <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport="" id="iso-2022-jp-decoder-state">ISO-2022-JP decoder state</dfn> (initially <a data-link-type="dfn" href="#iso-2022-jp-decoder-ascii" id="ref-for-iso-2022-jp-decoder-ascii-1">ASCII</a>), <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport="" id="iso-2022-jp-decoder-output-state">ISO-2022-JP decoder output state</dfn> (initially <a data-link-type="dfn" href="#iso-2022-jp-decoder-ascii" id="ref-for-iso-2022-jp-decoder-ascii-2">ASCII</a>), <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport="" id="iso-2022-jp-lead">ISO-2022-JP lead</dfn> (initially 0x00), and <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport="" id="iso-2022-jp-output-flag">ISO-2022-JP output flag</dfn> (initially unset). </p>
   <p><a data-link-type="dfn" href="#iso-2022-jp" id="ref-for-iso-2022-jp-4">ISO-2022-JP</a>’s <a data-link-type="dfn" href="#decoder" id="ref-for-decoder-28">decoder</a>’s <a data-link-type="dfn" href="#handler" id="ref-for-handler-13">handler</a>, given a <var>stream</var> and <var>byte</var>, runs these steps, switching on <a data-link-type="dfn" href="#iso-2022-jp-decoder-state" id="ref-for-iso-2022-jp-decoder-state-1">ISO-2022-JP decoder state</a>: </p>
   <dl class="switch">
    <dt><dfn class="dfn-paneled" data-dfn-type="dfn" data-lt="ISO-2022-JP decoder ASCII" data-noexport="" id="iso-2022-jp-decoder-ascii">ASCII</dfn> 
    <dd>
     <p>Based on <var>byte</var>: </p>
     <dl class="switch">
      <dt>0x1B 
      <dd>
       <p>Set <a data-link-type="dfn" href="#iso-2022-jp-decoder-state" id="ref-for-iso-2022-jp-decoder-state-2">ISO-2022-JP decoder state</a> to <a data-link-type="dfn" href="#iso-2022-jp-decoder-escape-start" id="ref-for-iso-2022-jp-decoder-escape-start-1">escape start</a> and return <a data-link-type="dfn" href="#continue" id="ref-for-continue-12">continue</a>. </p>
      <dt>0x00 to 0x7F, excluding 0x0E, 0x0F, and 0x1B 
      <dd>
       <p>Unset the <a data-link-type="dfn" href="#iso-2022-jp-output-flag" id="ref-for-iso-2022-jp-output-flag-1">ISO-2022-JP output flag</a> and return a code point whose
   value is <var>byte</var>. </p>
      <dt><a data-link-type="dfn" href="#end-of-stream" id="ref-for-end-of-stream-21">end-of-stream</a> 
      <dd>
       <p>Return <a data-link-type="dfn" href="#finished" id="ref-for-finished-14">finished</a>. </p>
      <dt>Otherwise 
      <dd>
       <p>Unset the <a data-link-type="dfn" href="#iso-2022-jp-output-flag" id="ref-for-iso-2022-jp-output-flag-2">ISO-2022-JP output flag</a> and return <a data-link-type="dfn" href="#error" id="ref-for-error-29">error</a>. </p>
     </dl>
    <dt><dfn class="dfn-paneled" data-dfn-type="dfn" data-lt="ISO-2022-JP decoder Roman" data-noexport="" id="iso-2022-jp-decoder-roman">Roman</dfn> 
    <dd>
     <p>Based on <var>byte</var>: </p>
     <dl class="switch">
      <dt>0x1B 
      <dd>
       <p>Set <a data-link-type="dfn" href="#iso-2022-jp-decoder-state" id="ref-for-iso-2022-jp-decoder-state-3">ISO-2022-JP decoder state</a> to <a data-link-type="dfn" href="#iso-2022-jp-decoder-escape-start" id="ref-for-iso-2022-jp-decoder-escape-start-2">escape start</a> and return <a data-link-type="dfn" href="#continue" id="ref-for-continue-13">continue</a>. </p>
      <dt>0x5C 
      <dd>
       <p>Unset the <a data-link-type="dfn" href="#iso-2022-jp-output-flag" id="ref-for-iso-2022-jp-output-flag-3">ISO-2022-JP output flag</a> and return code point U+00A5. </p>
      <dt>0x7E 
      <dd>
       <p>Unset the <a data-link-type="dfn" href="#iso-2022-jp-output-flag" id="ref-for-iso-2022-jp-output-flag-4">ISO-2022-JP output flag</a> and return code point U+203E. </p>
      <dt>0x00 to 0x7F, excluding 0x0E, 0x0F, 0x1B, 0x5C, and 0x7E 
      <dd>
       <p>Unset the <a data-link-type="dfn" href="#iso-2022-jp-output-flag" id="ref-for-iso-2022-jp-output-flag-5">ISO-2022-JP output flag</a> and return a code point whose
   value is <var>byte</var>. </p>
      <dt><a data-link-type="dfn" href="#end-of-stream" id="ref-for-end-of-stream-22">end-of-stream</a> 
      <dd>
       <p>Return <a data-link-type="dfn" href="#finished" id="ref-for-finished-15">finished</a>. </p>
      <dt>Otherwise 
      <dd>
       <p>Unset the <a data-link-type="dfn" href="#iso-2022-jp-output-flag" id="ref-for-iso-2022-jp-output-flag-6">ISO-2022-JP output flag</a> and return <a data-link-type="dfn" href="#error" id="ref-for-error-30">error</a>. </p>
     </dl>
    <dt><dfn class="dfn-paneled" data-dfn-type="dfn" data-lt="ISO-2022-JP decoder katakana" data-noexport="" id="iso-2022-jp-decoder-katakana">katakana</dfn> 
    <dd>
     <p>Based on <var>byte</var>: </p>
     <dl class="switch">
      <dt>0x1B 
      <dd>
       <p>Set <a data-link-type="dfn" href="#iso-2022-jp-decoder-state" id="ref-for-iso-2022-jp-decoder-state-4">ISO-2022-JP decoder state</a> to <a data-link-type="dfn" href="#iso-2022-jp-decoder-escape-start" id="ref-for-iso-2022-jp-decoder-escape-start-3">escape start</a> and return <a data-link-type="dfn" href="#continue" id="ref-for-continue-14">continue</a>. </p>
      <dt>0x21 to 0x5F 
      <dd>
       <p>Unset the <a data-link-type="dfn" href="#iso-2022-jp-output-flag" id="ref-for-iso-2022-jp-output-flag-7">ISO-2022-JP output flag</a> and return a code point whose
   value is 0xFF61 − 0x21 + <var>byte</var>. </p>
      <dt><a data-link-type="dfn" href="#end-of-stream" id="ref-for-end-of-stream-23">end-of-stream</a> 
      <dd>
       <p>Return <a data-link-type="dfn" href="#finished" id="ref-for-finished-16">finished</a>. </p>
      <dt>Otherwise 
      <dd>
       <p>Unset the <a data-link-type="dfn" href="#iso-2022-jp-output-flag" id="ref-for-iso-2022-jp-output-flag-8">ISO-2022-JP output flag</a> and return <a data-link-type="dfn" href="#error" id="ref-for-error-31">error</a>. </p>
     </dl>
    <dt><dfn class="dfn-paneled" data-dfn-type="dfn" data-lt="ISO-2022-JP decoder lead byte" data-noexport="" id="iso-2022-jp-decoder-lead-byte">Lead byte</dfn> 
    <dd>
     <p>Based on <var>byte</var>: </p>
     <dl class="switch">
      <dt>0x1B 
      <dd>
       <p>Set <a data-link-type="dfn" href="#iso-2022-jp-decoder-state" id="ref-for-iso-2022-jp-decoder-state-5">ISO-2022-JP decoder state</a> to <a data-link-type="dfn" href="#iso-2022-jp-decoder-escape-start" id="ref-for-iso-2022-jp-decoder-escape-start-4">escape start</a> and return <a data-link-type="dfn" href="#continue" id="ref-for-continue-15">continue</a>. </p>
      <dt>0x21 to 0x7E 
      <dd>
       <p>Unset the <a data-link-type="dfn" href="#iso-2022-jp-output-flag" id="ref-for-iso-2022-jp-output-flag-9">ISO-2022-JP output flag</a>, set <a data-link-type="dfn" href="#iso-2022-jp-lead" id="ref-for-iso-2022-jp-lead-1">ISO-2022-JP lead</a> to <var>byte</var>, <a data-link-type="dfn" href="#iso-2022-jp-decoder-state" id="ref-for-iso-2022-jp-decoder-state-6">ISO-2022-JP decoder state</a> to <a data-link-type="dfn" href="#iso-2022-jp-decoder-trail-byte" id="ref-for-iso-2022-jp-decoder-trail-byte-1">trail byte</a>, and return <a data-link-type="dfn" href="#continue" id="ref-for-continue-16">continue</a>. </p>
      <dt><a data-link-type="dfn" href="#end-of-stream" id="ref-for-end-of-stream-24">end-of-stream</a> 
      <dd>
       <p>Return <a data-link-type="dfn" href="#finished" id="ref-for-finished-17">finished</a>. </p>
      <dt>Otherwise 
      <dd>
       <p>Unset the <a data-link-type="dfn" href="#iso-2022-jp-output-flag" id="ref-for-iso-2022-jp-output-flag-10">ISO-2022-JP output flag</a> and return <a data-link-type="dfn" href="#error" id="ref-for-error-32">error</a>. </p>
     </dl>
    <dt><dfn class="dfn-paneled" data-dfn-type="dfn" data-lt="ISO-2022-JP decoder trail byte" data-noexport="" id="iso-2022-jp-decoder-trail-byte">Trail byte</dfn> 
    <dd>
     <p>Based on <var>byte</var>: </p>
     <dl class="switch">
      <dt>0x1B 
      <dd>
       <p>Set <a data-link-type="dfn" href="#iso-2022-jp-decoder-state" id="ref-for-iso-2022-jp-decoder-state-7">ISO-2022-JP decoder state</a> to <a data-link-type="dfn" href="#iso-2022-jp-decoder-escape-start" id="ref-for-iso-2022-jp-decoder-escape-start-5">escape start</a> and return <a data-link-type="dfn" href="#error" id="ref-for-error-33">error</a>. </p>
      <dt>0x21 to 0x7E 
      <dd>
       <ol>
        <li>
         <p>Set the <a data-link-type="dfn" href="#iso-2022-jp-decoder-state" id="ref-for-iso-2022-jp-decoder-state-8">ISO-2022-JP decoder state</a> to <a data-link-type="dfn" href="#iso-2022-jp-decoder-lead-byte" id="ref-for-iso-2022-jp-decoder-lead-byte-1">lead byte</a>. </p>
        <li>
         <p>Let <var>pointer</var> be
     (<a data-link-type="dfn" href="#iso-2022-jp-lead" id="ref-for-iso-2022-jp-lead-2">ISO-2022-JP lead</a> − 0x21) × 94 + <var>byte</var> − 0x21. </p>
        <li>
         <p>Let <var>code point</var> be the <a data-link-type="dfn" href="#index-code-point" id="ref-for-index-code-point-5">index code point</a> for <var>pointer</var> in <a data-link-type="dfn" href="#index-jis0208" id="ref-for-index-jis0208-7">index jis0208</a>. </p>
        <li>
         <p>If <var>code point</var> is null, return <a data-link-type="dfn" href="#error" id="ref-for-error-34">error</a>. </p>
        <li>
         <p>Return a code point whose value is <var>code point</var>. </p>
       </ol>
      <dt><a data-link-type="dfn" href="#end-of-stream" id="ref-for-end-of-stream-25">end-of-stream</a> 
      <dd>
       <p>Set the <a data-link-type="dfn" href="#iso-2022-jp-decoder-state" id="ref-for-iso-2022-jp-decoder-state-9">ISO-2022-JP decoder state</a> to <a data-link-type="dfn" href="#iso-2022-jp-decoder-lead-byte" id="ref-for-iso-2022-jp-decoder-lead-byte-2">lead byte</a>, <a data-link-type="dfn" href="#concept-stream-prepend" id="ref-for-concept-stream-prepend-11">prepend</a> <var>byte</var> to <var>stream</var>, and return <a data-link-type="dfn" href="#error" id="ref-for-error-35">error</a>. </p>
      <dt>Otherwise 
      <dd>
       <p>Set <a data-link-type="dfn" href="#iso-2022-jp-decoder-state" id="ref-for-iso-2022-jp-decoder-state-10">ISO-2022-JP decoder state</a> to <a data-link-type="dfn" href="#iso-2022-jp-decoder-lead-byte" id="ref-for-iso-2022-jp-decoder-lead-byte-3">lead byte</a> and return <a data-link-type="dfn" href="#error" id="ref-for-error-36">error</a>. </p>
     </dl>
    <dt><dfn class="dfn-paneled" data-dfn-type="dfn" data-lt="ISO-2022-JP decoder escape start" data-noexport="" id="iso-2022-jp-decoder-escape-start">Escape start</dfn> 
    <dd>
     <ol>
      <li>
       <p>If <var>byte</var> is either 0x24 or 0x28, set <a data-link-type="dfn" href="#iso-2022-jp-lead" id="ref-for-iso-2022-jp-lead-3">ISO-2022-JP lead</a> to <var>byte</var>, <a data-link-type="dfn" href="#iso-2022-jp-decoder-state" id="ref-for-iso-2022-jp-decoder-state-11">ISO-2022-JP decoder state</a> to <a data-link-type="dfn" href="#iso-2022-jp-decoder-escape" id="ref-for-iso-2022-jp-decoder-escape-1">escape</a>, and return <a data-link-type="dfn" href="#continue" id="ref-for-continue-17">continue</a>. </p>
      <li>
       <p><a data-link-type="dfn" href="#concept-stream-prepend" id="ref-for-concept-stream-prepend-12">Prepend</a> <var>byte</var> to <var>stream</var>. </p>
      <li>
       <p>Unset the <a data-link-type="dfn" href="#iso-2022-jp-output-flag" id="ref-for-iso-2022-jp-output-flag-11">ISO-2022-JP output flag</a>, set <a data-link-type="dfn" href="#iso-2022-jp-decoder-state" id="ref-for-iso-2022-jp-decoder-state-12">ISO-2022-JP decoder state</a> to <a data-link-type="dfn" href="#iso-2022-jp-decoder-output-state" id="ref-for-iso-2022-jp-decoder-output-state-1">ISO-2022-JP decoder output state</a>, and return <a data-link-type="dfn" href="#error" id="ref-for-error-37">error</a>. </p>
     </ol>
    <dt><dfn class="dfn-paneled" data-dfn-type="dfn" data-lt="ISO-2022-JP decoder escape" data-noexport="" id="iso-2022-jp-decoder-escape">Escape</dfn> 
    <dd>
     <ol>
      <li>
       <p>Let <var>lead</var> be <a data-link-type="dfn" href="#iso-2022-jp-lead" id="ref-for-iso-2022-jp-lead-4">ISO-2022-JP lead</a> and set <a data-link-type="dfn" href="#iso-2022-jp-lead" id="ref-for-iso-2022-jp-lead-5">ISO-2022-JP lead</a> to 0x00. </p>
      <li>
       <p>Let <var>state</var> be null. </p>
      <li>
       <p>If <var>lead</var> is 0x28 and <var>byte</var> is 0x42, set <var>state</var> to <a data-link-type="dfn" href="#iso-2022-jp-decoder-ascii" id="ref-for-iso-2022-jp-decoder-ascii-3">ASCII</a>. </p>
      <li>
       <p>If <var>lead</var> is 0x28 and <var>byte</var> is 0x4A, set <var>state</var> to <a data-link-type="dfn" href="#iso-2022-jp-decoder-roman" id="ref-for-iso-2022-jp-decoder-roman-1">Roman</a>. </p>
      <li>
       <p>If <var>lead</var> is 0x28 and <var>byte</var> is 0x49, set <var>state</var> to <a data-link-type="dfn" href="#iso-2022-jp-decoder-katakana" id="ref-for-iso-2022-jp-decoder-katakana-1">katakana</a>. </p>
      <li>
       <p>If <var>lead</var> is 0x24 and <var>byte</var> is either
   0x40 or 0x42, set <var>state</var> to <a data-link-type="dfn" href="#iso-2022-jp-decoder-lead-byte" id="ref-for-iso-2022-jp-decoder-lead-byte-4">lead byte</a>. </p>
      <li>
       <p>If <var>state</var> is non-null, then: </p>
       <ol>
        <li>
         <p>Set <a data-link-type="dfn" href="#iso-2022-jp-decoder-state" id="ref-for-iso-2022-jp-decoder-state-13">ISO-2022-JP decoder state</a> and <a data-link-type="dfn" href="#iso-2022-jp-decoder-output-state" id="ref-for-iso-2022-jp-decoder-output-state-2">ISO-2022-JP decoder output state</a> to <var>state</var>. </p>
        <li>
         <p>Let <var>output flag</var> be the <a data-link-type="dfn" href="#iso-2022-jp-output-flag" id="ref-for-iso-2022-jp-output-flag-12">ISO-2022-JP output flag</a>. </p>
        <li>
         <p>Set the <a data-link-type="dfn" href="#iso-2022-jp-output-flag" id="ref-for-iso-2022-jp-output-flag-13">ISO-2022-JP output flag</a>. </p>
        <li>
         <p>Return <a data-link-type="dfn" href="#continue" id="ref-for-continue-18">continue</a>, if <var>output flag</var> is unset, and <a data-link-type="dfn" href="#error" id="ref-for-error-38">error</a> otherwise. </p>
       </ol>
      <li>
       <p><a data-link-type="dfn" href="#concept-stream-prepend" id="ref-for-concept-stream-prepend-13">Prepend</a> <var>lead</var> and <var>byte</var> to <var>stream</var>. </p>
      <li>
       <p>Unset the <a data-link-type="dfn" href="#iso-2022-jp-output-flag" id="ref-for-iso-2022-jp-output-flag-14">ISO-2022-JP output flag</a>, set <a data-link-type="dfn" href="#iso-2022-jp-decoder-state" id="ref-for-iso-2022-jp-decoder-state-14">ISO-2022-JP decoder state</a> to <a data-link-type="dfn" href="#iso-2022-jp-decoder-output-state" id="ref-for-iso-2022-jp-decoder-output-state-3">ISO-2022-JP decoder output state</a> and return <a data-link-type="dfn" href="#error" id="ref-for-error-39">error</a>. </p>
     </ol>
   </dl>
   <h4 class="heading settled dfn-paneled" data-dfn-type="dfn" data-export="" data-level="12.2.2" data-lt="ISO-2022-JP encoder" id="iso-2022-jp-encoder"><span class="secno">12.2.2. </span><span class="content">ISO-2022-JP encoder</span></h4>
   <p><a data-link-type="dfn" href="#iso-2022-jp" id="ref-for-iso-2022-jp-5">ISO-2022-JP</a>’s <a data-link-type="dfn" href="#encoder" id="ref-for-encoder-22">encoder</a> has an associated <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport="" id="iso-2022-jp-encoder-state">ISO-2022-JP encoder state</dfn> which is <dfn class="dfn-paneled" data-dfn-type="dfn" data-lt="ISO-2022-JP encoder ASCII" data-noexport="" id="iso-2022-jp-encoder-ascii">ASCII</dfn>, <dfn class="dfn-paneled" data-dfn-type="dfn" data-lt="ISO-2022-JP encoder Roman" data-noexport="" id="iso-2022-jp-encoder-roman">Roman</dfn>, or <dfn class="dfn-paneled" data-dfn-type="dfn" data-lt="ISO-2022-JP encoder jis0208" data-noexport="" id="iso-2022-jp-encoder-jis0208">jis0208</dfn> (initially <a data-link-type="dfn" href="#iso-2022-jp-encoder-ascii" id="ref-for-iso-2022-jp-encoder-ascii-1">ASCII</a>). </p>
   <p><a data-link-type="dfn" href="#iso-2022-jp" id="ref-for-iso-2022-jp-6">ISO-2022-JP</a>’s <a data-link-type="dfn" href="#encoder" id="ref-for-encoder-23">encoder</a>’s <a data-link-type="dfn" href="#handler" id="ref-for-handler-14">handler</a>, given a <var>stream</var> and <var>code point</var>, runs these steps: </p>
   <ol>
    <li>
     <p>If <var>code point</var> is <a data-link-type="dfn" href="#end-of-stream" id="ref-for-end-of-stream-26">end-of-stream</a> and <a data-link-type="dfn" href="#iso-2022-jp-encoder-state" id="ref-for-iso-2022-jp-encoder-state-1">ISO-2022-JP encoder state</a> is not <a data-link-type="dfn" href="#iso-2022-jp-encoder-ascii" id="ref-for-iso-2022-jp-encoder-ascii-2">ASCII</a>, <a data-link-type="dfn" href="#concept-stream-prepend" id="ref-for-concept-stream-prepend-14">prepend</a> <var>code point</var> to <var>stream</var>, set <a data-link-type="dfn" href="#iso-2022-jp-encoder-state" id="ref-for-iso-2022-jp-encoder-state-2">ISO-2022-JP encoder state</a> to <a data-link-type="dfn" href="#iso-2022-jp-encoder-ascii" id="ref-for-iso-2022-jp-encoder-ascii-3">ASCII</a>, and return three bytes
 0x1B 0x28 0x42. </p>
    <li>
     <p>If <var>code point</var> is <a data-link-type="dfn" href="#end-of-stream" id="ref-for-end-of-stream-27">end-of-stream</a> and <a data-link-type="dfn" href="#iso-2022-jp-encoder-state" id="ref-for-iso-2022-jp-encoder-state-3">ISO-2022-JP encoder state</a> is <a data-link-type="dfn" href="#iso-2022-jp-encoder-ascii" id="ref-for-iso-2022-jp-encoder-ascii-4">ASCII</a>, return <a data-link-type="dfn" href="#finished" id="ref-for-finished-18">finished</a>. </p>
    <li>
     <p>If <a data-link-type="dfn" href="#iso-2022-jp-encoder-state" id="ref-for-iso-2022-jp-encoder-state-4">ISO-2022-JP encoder state</a> is <a data-link-type="dfn" href="#iso-2022-jp-encoder-ascii" id="ref-for-iso-2022-jp-encoder-ascii-5">ASCII</a> or <a data-link-type="dfn" href="#iso-2022-jp-encoder-roman" id="ref-for-iso-2022-jp-encoder-roman-1">Roman</a>, and <var>code point</var> is U+000E, U+000F,
  or U+001B, return <a data-link-type="dfn" href="#error" id="ref-for-error-40">error</a> with U+FFFD. </p>
     <p class="note" role="note">This returns U+FFFD rather than <var>code point</var> to prevent attacks. </p>
    <li>
     <p>If <a data-link-type="dfn" href="#iso-2022-jp-encoder-state" id="ref-for-iso-2022-jp-encoder-state-5">ISO-2022-JP encoder state</a> is <a data-link-type="dfn" href="#iso-2022-jp-encoder-ascii" id="ref-for-iso-2022-jp-encoder-ascii-6">ASCII</a> and <var>code point</var> is an <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#ascii-code-point">ASCII code point</a>, return a byte whose value is <var>code point</var>. </p>
    <li>
     <p>If <a data-link-type="dfn" href="#iso-2022-jp-encoder-state" id="ref-for-iso-2022-jp-encoder-state-6">ISO-2022-JP encoder state</a> is <a data-link-type="dfn" href="#iso-2022-jp-encoder-roman" id="ref-for-iso-2022-jp-encoder-roman-2">Roman</a> and <var>code point</var> is an <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#ascii-code-point">ASCII code point</a>, excluding U+005C and U+007E, or is U+00A5 or
  U+203E, then: </p>
     <ol>
      <li>
       <p>If <var>code point</var> is an <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#ascii-code-point">ASCII code point</a>, return a byte
   whose value is <var>code point</var>. </p>
      <li>
       <p>If <var>code point</var> is U+00A5, return byte 0x5C. </p>
      <li>
       <p>If <var>code point</var> is U+203E, return byte 0x7E. </p>
     </ol>
    <li>
     <p>If <var>code point</var> is an <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#ascii-code-point">ASCII code point</a>, and <a data-link-type="dfn" href="#iso-2022-jp-encoder-state" id="ref-for-iso-2022-jp-encoder-state-7">ISO-2022-JP encoder state</a> is not <a data-link-type="dfn" href="#iso-2022-jp-encoder-ascii" id="ref-for-iso-2022-jp-encoder-ascii-7">ASCII</a>, <a data-link-type="dfn" href="#concept-stream-prepend" id="ref-for-concept-stream-prepend-15">prepend</a> <var>code point</var> to <var>stream</var>, set <a data-link-type="dfn" href="#iso-2022-jp-encoder-state" id="ref-for-iso-2022-jp-encoder-state-8">ISO-2022-JP encoder state</a> to <a data-link-type="dfn" href="#iso-2022-jp-encoder-ascii" id="ref-for-iso-2022-jp-encoder-ascii-8">ASCII</a>, and return three bytes
 0x1B 0x28 0x42. </p>
    <li>
     <p>If <var>code point</var> is either U+00A5 or U+203E, and <a data-link-type="dfn" href="#iso-2022-jp-encoder-state" id="ref-for-iso-2022-jp-encoder-state-9">ISO-2022-JP encoder state</a> is not <a data-link-type="dfn" href="#iso-2022-jp-encoder-roman" id="ref-for-iso-2022-jp-encoder-roman-3">Roman</a>, <a data-link-type="dfn" href="#concept-stream-prepend" id="ref-for-concept-stream-prepend-16">prepend</a> <var>code point</var> to <var>stream</var>, set <a data-link-type="dfn" href="#iso-2022-jp-encoder-state" id="ref-for-iso-2022-jp-encoder-state-10">ISO-2022-JP encoder state</a> to <a data-link-type="dfn" href="#iso-2022-jp-encoder-roman" id="ref-for-iso-2022-jp-encoder-roman-4">Roman</a>, and return three bytes
 0x1B 0x28 0x4A. </p>
    <li>
     <p>If <var>code point</var> is U+2212, set it to U+FF0D. </p>
    <li>
     <p>If <var>code point</var> is in the range U+FF61 to U+FF9F, inclusive, set it to the <a data-link-type="dfn" href="#index-code-point" id="ref-for-index-code-point-6">index code point</a> for <var>code point</var> − 0xFF61 in <a data-link-type="dfn" href="#index-iso-2022-jp-katakana" id="ref-for-index-iso-2022-jp-katakana-3">index ISO-2022-JP katakana</a>. </p>
    <li>
     <p>Let <var>pointer</var> be the <a data-link-type="dfn" href="#index-pointer" id="ref-for-index-pointer-7">index pointer</a> for <var>code point</var> in <a data-link-type="dfn" href="#index-jis0208" id="ref-for-index-jis0208-8">index jis0208</a>. </p>
     <p class="note" role="note">If <var>pointer</var> is non-null, it is less than 8836 due to the nature of <a data-link-type="dfn" href="#index-jis0208" id="ref-for-index-jis0208-9">index jis0208</a> and the <a data-link-type="dfn" href="#index-pointer" id="ref-for-index-pointer-8">index pointer</a> operation. </p>
    <li>
     <p>If <var>pointer</var> is null, return <a data-link-type="dfn" href="#error" id="ref-for-error-41">error</a> with <var>code point</var>. </p>
    <li>
     <p>If <a data-link-type="dfn" href="#iso-2022-jp-encoder-state" id="ref-for-iso-2022-jp-encoder-state-11">ISO-2022-JP encoder state</a> is not <a data-link-type="dfn" href="#iso-2022-jp-encoder-jis0208" id="ref-for-iso-2022-jp-encoder-jis0208-1">jis0208</a>, <a data-link-type="dfn" href="#concept-stream-prepend" id="ref-for-concept-stream-prepend-17">prepend</a> <var>code point</var> to <var>stream</var>, set <a data-link-type="dfn" href="#iso-2022-jp-encoder-state" id="ref-for-iso-2022-jp-encoder-state-12">ISO-2022-JP encoder state</a> to <a data-link-type="dfn" href="#iso-2022-jp-encoder-jis0208" id="ref-for-iso-2022-jp-encoder-jis0208-2">jis0208</a>, and return three bytes
 0x1B 0x24 0x42. </p>
    <li>
     <p>Let <var>lead</var> be <var>pointer</var> / 94 + 0x21. </p>
    <li>
     <p>Let <var>trail</var> be <var>pointer</var> % 94 + 0x21. </p>
    <li>
     <p>Return two bytes whose values are <var>lead</var> and <var>trail</var>. </p>
   </ol>
   <h3 class="heading settled dfn-paneled" data-dfn-type="dfn" data-export="" data-level="12.3" data-lt="Shift_JIS" id="shift_jis"><span class="secno">12.3. </span><span class="content">Shift_JIS</span></h3>
   <h4 class="heading settled" data-dfn-type="dfn" data-export="" data-level="12.3.1" data-lt="Shift_JIS decoder" id="shift_jis-decoder"><span class="secno">12.3.1. </span><span class="content">Shift_JIS decoder</span><a class="self-link" href="#shift_jis-decoder"></a></h4>
   <p><a data-link-type="dfn" href="#shift_jis" id="ref-for-shift_jis-4">Shift_JIS</a>’s <a data-link-type="dfn" href="#decoder" id="ref-for-decoder-29">decoder</a> has an associated <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport="" id="shift_jis-lead">Shift_JIS lead</dfn> (initially 0x00). </p>
   <p><a data-link-type="dfn" href="#shift_jis" id="ref-for-shift_jis-5">Shift_JIS</a>’s <a data-link-type="dfn" href="#decoder" id="ref-for-decoder-30">decoder</a>’s <a data-link-type="dfn" href="#handler" id="ref-for-handler-15">handler</a>, given a <var>stream</var> and <var>byte</var>, runs these steps: </p>
   <ol>
    <li>
     <p>If <var>byte</var> is <a data-link-type="dfn" href="#end-of-stream" id="ref-for-end-of-stream-28">end-of-stream</a> and <a data-link-type="dfn" href="#shift_jis-lead" id="ref-for-shift_jis-lead-1">Shift_JIS lead</a> is not 0x00, set <a data-link-type="dfn" href="#shift_jis-lead" id="ref-for-shift_jis-lead-2">Shift_JIS lead</a> to 0x00 and
 return <a data-link-type="dfn" href="#error" id="ref-for-error-42">error</a>. </p>
    <li>
     <p>If <var>byte</var> is <a data-link-type="dfn" href="#end-of-stream" id="ref-for-end-of-stream-29">end-of-stream</a> and <a data-link-type="dfn" href="#shift_jis-lead" id="ref-for-shift_jis-lead-3">Shift_JIS lead</a> is 0x00, return <a data-link-type="dfn" href="#finished" id="ref-for-finished-19">finished</a>. </p>
    <li>
     <p>If <a data-link-type="dfn" href="#shift_jis-lead" id="ref-for-shift_jis-lead-4">Shift_JIS lead</a> is not 0x00, let <var>lead</var> be <a data-link-type="dfn" href="#shift_jis-lead" id="ref-for-shift_jis-lead-5">Shift_JIS lead</a>, let <var>pointer</var> be null, set <a data-link-type="dfn" href="#shift_jis-lead" id="ref-for-shift_jis-lead-6">Shift_JIS lead</a> to 0x00, and then: </p>
     <ol>
      <li>
       <p>Let <var>offset</var> be 0x40, if <var>byte</var> is
   less than 0x7F, and 0x41 otherwise. </p>
      <li>
       <p>Let <var>lead offset</var> be 0x81, if <var>lead</var> is less than 0xA0, and 0xC1 otherwise. </p>
      <li>
       <p>If <var>byte</var> is in the range 0x40 to 0x7E, inclusive, or
   0x80 to 0xFC, inclusive, set <var>pointer</var> to
   (<var>lead</var> − <var>lead offset</var>) × 188 + <var>byte</var> − <var>offset</var>. </p>
      <li>
       <p>If <var>pointer</var> is in the range 8836 to 10715, inclusive, return a code point whose
    value is 0xE000 − 8836 + <var>pointer</var>. </p>
       <p class="note" role="note">This is interoperable legacy from Windows known as EUDC. </p>
      <li>
       <p>Let <var>code point</var> be null, if <var>pointer</var> is null, and the <a data-link-type="dfn" href="#index-code-point" id="ref-for-index-code-point-7">index code point</a> for <var>pointer</var> in <a data-link-type="dfn" href="#index-jis0208" id="ref-for-index-jis0208-10">index jis0208</a> otherwise. </p>
      <li>
       <p>If <var>code point</var> is non-null, return a code point whose value is <var>code point</var>. </p>
      <li>
       <p>If <var>byte</var> is an <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#ascii-byte">ASCII byte</a>, <a data-link-type="dfn" href="#concept-stream-prepend" id="ref-for-concept-stream-prepend-18">prepend</a> <var>byte</var> to <var>stream</var>. </p>
      <li>
       <p>Return <a data-link-type="dfn" href="#error" id="ref-for-error-43">error</a>. </p>
     </ol>
    <li>
     <p>If <var>byte</var> is an <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#ascii-byte">ASCII byte</a> or 0x80, return a code point
 whose value is <var>byte</var>. </p>
    <li>
     <p>If <var>byte</var> is in the range 0xA1 to 0xDF, inclusive, return
 a code point whose value is 0xFF61 − 0xA1 + <var>byte</var>. </p>
    <li>
     <p>If <var>byte</var> is in the range 0x81 to 0x9F, inclusive, or 0xE0 to 0xFC,
 inclusive, set <a data-link-type="dfn" href="#shift_jis-lead" id="ref-for-shift_jis-lead-7">Shift_JIS lead</a> to <var>byte</var> and return <a data-link-type="dfn" href="#continue" id="ref-for-continue-19">continue</a>. </p>
    <li>
     <p>Return <a data-link-type="dfn" href="#error" id="ref-for-error-44">error</a>. </p>
   </ol>
   <h4 class="heading settled" data-dfn-type="dfn" data-export="" data-level="12.3.2" data-lt="Shift_JIS encoder" id="shift_jis-encoder"><span class="secno">12.3.2. </span><span class="content">Shift_JIS encoder</span><a class="self-link" href="#shift_jis-encoder"></a></h4>
   <p><a data-link-type="dfn" href="#shift_jis" id="ref-for-shift_jis-6">Shift_JIS</a>’s <a data-link-type="dfn" href="#encoder" id="ref-for-encoder-24">encoder</a>’s <a data-link-type="dfn" href="#handler" id="ref-for-handler-16">handler</a>, given a <var>stream</var> and <var>code point</var>, runs these steps: </p>
   <ol>
    <li>
     <p>If <var>code point</var> is <a data-link-type="dfn" href="#end-of-stream" id="ref-for-end-of-stream-30">end-of-stream</a>, return <a data-link-type="dfn" href="#finished" id="ref-for-finished-20">finished</a>. </p>
    <li>
     <p>If <var>code point</var> is an <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#ascii-code-point">ASCII code point</a> or U+0080, return
 a byte whose value is <var>code point</var>. </p>
    <li>
     <p>If <var>code point</var> is U+00A5, return byte 0x5C. </p>
    <li>
     <p>If <var>code point</var> is U+203E, return byte 0x7E. </p>
    <li>
     <p>If <var>code point</var> is in the range U+FF61 to U+FF9F, inclusive, return
 a byte whose value is <var>code point</var> − 0xFF61 + 0xA1. </p>
    <li>
     <p>If <var>code point</var> is U+2212, set it to U+FF0D. </p>
    <li>
     <p>Let <var>pointer</var> be the <a data-link-type="dfn" href="#index-shift_jis-pointer" id="ref-for-index-shift_jis-pointer-1">index Shift_JIS pointer</a> for <var>code point</var>. </p>
    <li>
     <p>If <var>pointer</var> is null, return <a data-link-type="dfn" href="#error" id="ref-for-error-45">error</a> with <var>code point</var>. </p>
    <li>
     <p>Let <var>lead</var> be <var>pointer</var> / 188. </p>
    <li>
     <p>Let <var>lead offset</var> be 0x81, if <var>lead</var> is
 less than 0x1F, and 0xC1 otherwise. </p>
    <li>
     <p>Let <var>trail</var> be <var>pointer</var> % 188. </p>
    <li>
     <p>Let <var>offset</var> be 0x40, if <var>trail</var> is
 less than 0x3F, and 0x41 otherwise. </p>
    <li>
     <p>Return two bytes whose values are <var>lead</var> + <var>lead offset</var> and <var>trail</var> + <var>offset</var>. </p>
   </ol>
   <h2 class="heading settled" data-level="13" id="legacy-multi-byte-korean-encodings"><span class="secno">13. </span><span class="content">Legacy multi-byte Korean encodings</span><a class="self-link" href="#legacy-multi-byte-korean-encodings"></a></h2>
   <h3 class="heading settled dfn-paneled" data-dfn-type="dfn" data-export="" data-level="13.1" data-lt="EUC-KR" id="euc-kr"><span class="secno">13.1. </span><span class="content">EUC-KR</span></h3>
   <h4 class="heading settled" data-dfn-type="dfn" data-export="" data-level="13.1.1" data-lt="EUC-KR decoder" id="euc-kr-decoder"><span class="secno">13.1.1. </span><span class="content">EUC-KR decoder</span><a class="self-link" href="#euc-kr-decoder"></a></h4>
   <p><a data-link-type="dfn" href="#euc-kr" id="ref-for-euc-kr-2">EUC-KR</a>’s <a data-link-type="dfn" href="#decoder" id="ref-for-decoder-31">decoder</a> has an associated <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport="" id="euc-kr-lead">EUC-KR lead</dfn> (initially 0x00). </p>
   <p><a data-link-type="dfn" href="#euc-kr" id="ref-for-euc-kr-3">EUC-KR</a>’s <a data-link-type="dfn" href="#decoder" id="ref-for-decoder-32">decoder</a>’s <a data-link-type="dfn" href="#handler" id="ref-for-handler-17">handler</a>, given a <var>stream</var> and <var>byte</var>, runs these steps: </p>
   <ol>
    <li>
     <p>If <var>byte</var> is <a data-link-type="dfn" href="#end-of-stream" id="ref-for-end-of-stream-31">end-of-stream</a> and <a data-link-type="dfn" href="#euc-kr-lead" id="ref-for-euc-kr-lead-1">EUC-KR lead</a> is not 0x00, set <a data-link-type="dfn" href="#euc-kr-lead" id="ref-for-euc-kr-lead-2">EUC-KR lead</a> to 0x00
 and return <a data-link-type="dfn" href="#error" id="ref-for-error-46">error</a>. </p>
    <li>
     <p>If <var>byte</var> is <a data-link-type="dfn" href="#end-of-stream" id="ref-for-end-of-stream-32">end-of-stream</a> and <a data-link-type="dfn" href="#euc-kr-lead" id="ref-for-euc-kr-lead-3">EUC-KR lead</a> is 0x00, return <a data-link-type="dfn" href="#finished" id="ref-for-finished-21">finished</a>. </p>
    <li>
     <p>If <a data-link-type="dfn" href="#euc-kr-lead" id="ref-for-euc-kr-lead-4">EUC-KR lead</a> is not 0x00, let <var>lead</var> be <a data-link-type="dfn" href="#euc-kr-lead" id="ref-for-euc-kr-lead-5">EUC-KR lead</a>, let <var>pointer</var> be null, set <a data-link-type="dfn" href="#euc-kr-lead" id="ref-for-euc-kr-lead-6">EUC-KR lead</a> to 0x00, and then: </p>
     <ol>
      <li>
       <p>If <var>byte</var> is in the range  0x41 to 0xFE, inclusive, set <var>pointer</var> to
   (<var>lead</var> − 0x81) × 190 + (<var>byte</var> − 0x41). </p>
      <li>
       <p>Let <var>code point</var> be null, if <var>pointer</var> is null,
   and the <a data-link-type="dfn" href="#index-code-point" id="ref-for-index-code-point-8">index code point</a> for <var>pointer</var> in <a data-link-type="dfn" href="#index-euc-kr" id="ref-for-index-euc-kr-1">index EUC-KR</a> otherwise. </p>
      <li>
       <p>If <var>code point</var> is non-null, return a code point whose value is <var>code point</var>. </p>
      <li>
       <p>If <var>byte</var> is an <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#ascii-byte">ASCII byte</a>, <a data-link-type="dfn" href="#concept-stream-prepend" id="ref-for-concept-stream-prepend-19">prepend</a> <var>byte</var> to <var>stream</var>. </p>
      <li>
       <p>Return <a data-link-type="dfn" href="#error" id="ref-for-error-47">error</a>. </p>
     </ol>
    <li>
     <p>If <var>byte</var> is an <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#ascii-byte">ASCII byte</a>, return
 a code point whose value is <var>byte</var>. </p>
    <li>
     <p>If <var>byte</var> is in the range 0x81 to 0xFE, inclusive, set <a data-link-type="dfn" href="#euc-kr-lead" id="ref-for-euc-kr-lead-7">EUC-KR lead</a> to <var>byte</var> and return <a data-link-type="dfn" href="#continue" id="ref-for-continue-20">continue</a>. </p>
    <li>
     <p>Return <a data-link-type="dfn" href="#error" id="ref-for-error-48">error</a>. </p>
   </ol>
   <h4 class="heading settled" data-dfn-type="dfn" data-export="" data-level="13.1.2" data-lt="EUC-KR encoder" id="euc-kr-encoder"><span class="secno">13.1.2. </span><span class="content">EUC-KR encoder</span><a class="self-link" href="#euc-kr-encoder"></a></h4>
   <p><a data-link-type="dfn" href="#euc-kr" id="ref-for-euc-kr-4">EUC-KR</a>’s <a data-link-type="dfn" href="#encoder" id="ref-for-encoder-25">encoder</a>’s <a data-link-type="dfn" href="#handler" id="ref-for-handler-18">handler</a>, given a <var>stream</var> and <var>code point</var>, runs these steps: </p>
   <ol>
    <li>
     <p>If <var>code point</var> is <a data-link-type="dfn" href="#end-of-stream" id="ref-for-end-of-stream-33">end-of-stream</a>, return <a data-link-type="dfn" href="#finished" id="ref-for-finished-22">finished</a>. </p>
    <li>
     <p>If <var>code point</var> is an <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#ascii-code-point">ASCII code point</a>, return
 a byte whose value is <var>code point</var>. </p>
    <li>
     <p>Let <var>pointer</var> be the <a data-link-type="dfn" href="#index-pointer" id="ref-for-index-pointer-9">index pointer</a> for <var>code point</var> in <a data-link-type="dfn" href="#index-euc-kr" id="ref-for-index-euc-kr-2">index EUC-KR</a>. </p>
    <li>
     <p>If <var>pointer</var> is null, return <a data-link-type="dfn" href="#error" id="ref-for-error-49">error</a> with <var>code point</var>. </p>
    <li>
     <p>Let <var>lead</var> be <var>pointer</var> / 190 + 0x81. </p>
    <li>
     <p>Let <var>trail</var> be <var>pointer</var> % 190 + 0x41. </p>
    <li>
     <p>Return two bytes whose values are <var>lead</var> and <var>trail</var>. </p>
   </ol>
   <h2 class="heading settled" data-level="14" id="legacy-miscellaneous-encodings"><span class="secno">14. </span><span class="content">Legacy miscellaneous encodings</span><a class="self-link" href="#legacy-miscellaneous-encodings"></a></h2>
   <h3 class="heading settled dfn-paneled" data-dfn-type="dfn" data-export="" data-level="14.1" data-lt="replacement" id="replacement"><span class="secno">14.1. </span><span class="content">replacement</span></h3>
   <p class="note" role="note">The <a data-link-type="dfn" href="#replacement" id="ref-for-replacement-8">replacement</a> <a data-link-type="dfn" href="#encoding" id="ref-for-encoding-22">encoding</a> exists to prevent certain
attacks that abuse a mismatch between <a data-link-type="dfn" href="#encoding" id="ref-for-encoding-23">encodings</a> supported on
the server and the client. </p>
   <h4 class="heading settled" data-dfn-type="dfn" data-export="" data-level="14.1.1" data-lt="replacement decoder" id="replacement-decoder"><span class="secno">14.1.1. </span><span class="content">replacement decoder</span><a class="self-link" href="#replacement-decoder"></a></h4>
   <p><a data-link-type="dfn" href="#replacement" id="ref-for-replacement-9">replacement</a>’s <a data-link-type="dfn" href="#decoder" id="ref-for-decoder-33">decoder</a> has an associated <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport="" id="replacement-error-returned-flag">replacement error returned flag</dfn> (initially unset). </p>
   <p><a data-link-type="dfn" href="#replacement" id="ref-for-replacement-10">replacement</a>’s <a data-link-type="dfn" href="#decoder" id="ref-for-decoder-34">decoder</a>’s <a data-link-type="dfn" href="#handler" id="ref-for-handler-19">handler</a>, given a <var>stream</var> and <var>byte</var>, runs these steps: </p>
   <ol>
    <li>
     <p>If <var>byte</var> is <a data-link-type="dfn" href="#end-of-stream" id="ref-for-end-of-stream-34">end-of-stream</a>, return <a data-link-type="dfn" href="#finished" id="ref-for-finished-23">finished</a>. </p>
    <li>
     <p>If <a data-link-type="dfn" href="#replacement-error-returned-flag" id="ref-for-replacement-error-returned-flag-1">replacement error returned flag</a> is unset, set the <a data-link-type="dfn" href="#replacement-error-returned-flag" id="ref-for-replacement-error-returned-flag-2">replacement error returned flag</a> and return <a data-link-type="dfn" href="#error" id="ref-for-error-50">error</a>. </p>
    <li>
     <p>Return <a data-link-type="dfn" href="#finished" id="ref-for-finished-24">finished</a>. </p>
   </ol>
   <h3 class="heading settled" data-level="14.2" id="common-infrastructure-for-utf-16be-and-utf-16le"><span class="secno">14.2. </span><span class="content">Common infrastructure for <a data-link-type="dfn" href="#utf-16be" id="ref-for-utf-16be-8">UTF-16BE</a> and <a data-link-type="dfn" href="#utf-16le" id="ref-for-utf-16le-8">UTF-16LE</a></span><a class="self-link" href="#common-infrastructure-for-utf-16be-and-utf-16le"></a></h3>
   <h4 class="heading settled dfn-paneled" data-dfn-type="dfn" data-export="" data-level="14.2.1" data-lt="shared UTF-16 decoder" id="shared-utf-16-decoder"><span class="secno">14.2.1. </span><span class="content">shared UTF-16 decoder</span></h4>
   <p class="note no-backref" role="note">A byte order mark has priority over a <a data-link-type="dfn" href="#label" id="ref-for-label-12">label</a> as it
has been found to be more accurate in deployed content. Therefore it is not part of the <a data-link-type="dfn" href="#shared-utf-16-decoder" id="ref-for-shared-utf-16-decoder-1">shared UTF-16 decoder</a> algorithm but rather the <a data-link-type="dfn" href="#decode" id="ref-for-decode-3">decode</a> algorithm. </p>
   <p><a data-link-type="dfn" href="#shared-utf-16-decoder" id="ref-for-shared-utf-16-decoder-2">shared UTF-16 decoder</a> has an associated <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport="" id="utf-16-lead-byte">UTF-16 lead byte</dfn> and <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport="" id="utf-16-lead-surrogate">UTF-16 lead surrogate</dfn> (both initially null), and <dfn class="dfn-paneled" data-dfn-type="dfn" data-noexport="" id="utf-16be-decoder-flag">UTF-16BE decoder flag</dfn> (initially unset). </p>
   <p><a data-link-type="dfn" href="#shared-utf-16-decoder" id="ref-for-shared-utf-16-decoder-3">shared UTF-16 decoder</a>’s <a data-link-type="dfn" href="#handler" id="ref-for-handler-20">handler</a>, given a <var>stream</var> and <var>byte</var>, runs these steps: </p>
   <ol>
    <li>
     <p>If <var>byte</var> is <a data-link-type="dfn" href="#end-of-stream" id="ref-for-end-of-stream-35">end-of-stream</a> and either <a data-link-type="dfn" href="#utf-16-lead-byte" id="ref-for-utf-16-lead-byte-1">UTF-16 lead byte</a> or <a data-link-type="dfn" href="#utf-16-lead-surrogate" id="ref-for-utf-16-lead-surrogate-1">UTF-16 lead surrogate</a> is non-null, set <a data-link-type="dfn" href="#utf-16-lead-byte" id="ref-for-utf-16-lead-byte-2">UTF-16 lead byte</a> and <a data-link-type="dfn" href="#utf-16-lead-surrogate" id="ref-for-utf-16-lead-surrogate-2">UTF-16 lead surrogate</a> to null, and return <a data-link-type="dfn" href="#error" id="ref-for-error-51">error</a>. </p>
    <li>
     <p>If <var>byte</var> is <a data-link-type="dfn" href="#end-of-stream" id="ref-for-end-of-stream-36">end-of-stream</a> and <a data-link-type="dfn" href="#utf-16-lead-byte" id="ref-for-utf-16-lead-byte-3">UTF-16 lead byte</a> and <a data-link-type="dfn" href="#utf-16-lead-surrogate" id="ref-for-utf-16-lead-surrogate-3">UTF-16 lead surrogate</a> are null, return <a data-link-type="dfn" href="#finished" id="ref-for-finished-25">finished</a>. </p>
    <li>
     <p>If <a data-link-type="dfn" href="#utf-16-lead-byte" id="ref-for-utf-16-lead-byte-4">UTF-16 lead byte</a> is null, set <a data-link-type="dfn" href="#utf-16-lead-byte" id="ref-for-utf-16-lead-byte-5">UTF-16 lead byte</a> to <var>byte</var> and return <a data-link-type="dfn" href="#continue" id="ref-for-continue-21">continue</a>. </p>
    <li>
     <p>Let <var>code unit</var> be the result of: </p>
     <dl class="switch">
      <dt><a data-link-type="dfn" href="#utf-16be-decoder-flag" id="ref-for-utf-16be-decoder-flag-1">UTF-16BE decoder flag</a> is set 
      <dd>
       <p>(<a data-link-type="dfn" href="#utf-16-lead-byte" id="ref-for-utf-16-lead-byte-6">UTF-16 lead byte</a> &lt;&lt; 8) + <var>byte</var>. </p>
      <dt><a data-link-type="dfn" href="#utf-16be-decoder-flag" id="ref-for-utf-16be-decoder-flag-2">UTF-16BE decoder flag</a> is unset 
      <dd>
       <p>(<var>byte</var> &lt;&lt; 8) + <a data-link-type="dfn" href="#utf-16-lead-byte" id="ref-for-utf-16-lead-byte-7">UTF-16 lead byte</a>. </p>
     </dl>
     <p>Then set <a data-link-type="dfn" href="#utf-16-lead-byte" id="ref-for-utf-16-lead-byte-8">UTF-16 lead byte</a> to null. </p>
    <li>
     <p>If <a data-link-type="dfn" href="#utf-16-lead-surrogate" id="ref-for-utf-16-lead-surrogate-4">UTF-16 lead surrogate</a> is non-null, let <var>lead surrogate</var> be <a data-link-type="dfn" href="#utf-16-lead-surrogate" id="ref-for-utf-16-lead-surrogate-5">UTF-16 lead surrogate</a>, set <a data-link-type="dfn" href="#utf-16-lead-surrogate" id="ref-for-utf-16-lead-surrogate-6">UTF-16 lead surrogate</a> to null, and then: </p>
     <ol>
      <li>
       <p>If <var>code unit</var> is in the range U+DC00 to U+DFFF, inclusive,
   return a code point whose value is
   0x10000 + ((<var>lead surrogate</var> − 0xD800) &lt;&lt; 10) + (<var>code unit</var> − 0xDC00). </p>
      <li>
       <p>Let <var>byte1</var> be <var>code unit</var> >> 8. </p>
      <li>
       <p>Let <var>byte2</var> be <var>code unit</var> &amp; 0x00FF. </p>
      <li>
       <p>Let <var>bytes</var> be two bytes whose values are <var>byte1</var> and <var>byte2</var>,
   if the <a data-link-type="dfn" href="#utf-16be-decoder-flag" id="ref-for-utf-16be-decoder-flag-3">UTF-16BE decoder flag</a> is set, and <var>byte2</var> and <var>byte1</var> otherwise. </p>
      <li>
       <p><a data-link-type="dfn" href="#concept-stream-prepend" id="ref-for-concept-stream-prepend-20">Prepend</a> the <var>bytes</var> to <var>stream</var> and return <a data-link-type="dfn" href="#error" id="ref-for-error-52">error</a>. </p>
     </ol>
    <li>
     <p>If <var>code unit</var> is in the range U+D800 to U+DBFF, inclusive, set <a data-link-type="dfn" href="#utf-16-lead-surrogate" id="ref-for-utf-16-lead-surrogate-7">UTF-16 lead surrogate</a> to <var>code unit</var> and return <a data-link-type="dfn" href="#continue" id="ref-for-continue-22">continue</a>. </p>
    <li>
     <p>If <var>code unit</var> is in the range U+DC00 to U+DFFF, inclusive,
 return <a data-link-type="dfn" href="#error" id="ref-for-error-53">error</a>. </p>
    <li>
     <p>Return code point <var>code unit</var>. </p>
   </ol>
   <h3 class="heading settled dfn-paneled" data-dfn-type="dfn" data-export="" data-level="14.3" data-lt="UTF-16BE" id="utf-16be"><span class="secno">14.3. </span><span class="content">UTF-16BE</span></h3>
   <h4 class="heading settled" data-dfn-type="dfn" data-export="" data-level="14.3.1" data-lt="UTF-16BE decoder" id="utf-16be-decoder"><span class="secno">14.3.1. </span><span class="content">UTF-16BE decoder</span><a class="self-link" href="#utf-16be-decoder"></a></h4>
   <p><a data-link-type="dfn" href="#utf-16be" id="ref-for-utf-16be-9">UTF-16BE</a>’s <a data-link-type="dfn" href="#decoder" id="ref-for-decoder-35">decoder</a> is <a data-link-type="dfn" href="#shared-utf-16-decoder" id="ref-for-shared-utf-16-decoder-4">shared UTF-16 decoder</a> with
its <a data-link-type="dfn" href="#utf-16be-decoder-flag" id="ref-for-utf-16be-decoder-flag-4">UTF-16BE decoder flag</a> set. </p>
   <h3 class="heading settled dfn-paneled" data-dfn-type="dfn" data-export="" data-level="14.4" data-lt="UTF-16LE" id="utf-16le"><span class="secno">14.4. </span><span class="content">UTF-16LE</span></h3>
   <p class="note no-backref" role="note">Both "<code>utf-16</code>" and
"<code>utf-16le</code>" are <a data-link-type="dfn" href="#label" id="ref-for-label-13">labels</a> for <a data-link-type="dfn" href="#utf-16le" id="ref-for-utf-16le-9">UTF-16LE</a> to deal with deployed content. </p>
   <h4 class="heading settled" data-dfn-type="dfn" data-export="" data-level="14.4.1" data-lt="UTF-16LE decoder" id="utf-16le-decoder"><span class="secno">14.4.1. </span><span class="content">UTF-16LE decoder</span><a class="self-link" href="#utf-16le-decoder"></a></h4>
   <p><a data-link-type="dfn" href="#utf-16le" id="ref-for-utf-16le-10">UTF-16LE</a>’s <a data-link-type="dfn" href="#decoder" id="ref-for-decoder-36">decoder</a> is <a data-link-type="dfn" href="#shared-utf-16-decoder" id="ref-for-shared-utf-16-decoder-5">shared UTF-16 decoder</a>. </p>
   <h3 class="heading settled dfn-paneled" data-dfn-type="dfn" data-export="" data-level="14.5" data-lt="x-user-defined" id="x-user-defined"><span class="secno">14.5. </span><span class="content">x-user-defined</span></h3>
   <p class="note" role="note">While technically this is a <a data-link-type="dfn" href="#single-byte-encoding" id="ref-for-single-byte-encoding-6">single-byte encoding</a>,
it is defined separately as it can be implemented algorithmically. </p>
   <h4 class="heading settled" data-dfn-type="dfn" data-export="" data-level="14.5.1" data-lt="x-user-defined decoder" id="x-user-defined-decoder"><span class="secno">14.5.1. </span><span class="content">x-user-defined decoder</span><a class="self-link" href="#x-user-defined-decoder"></a></h4>
   <p><a data-link-type="dfn" href="#x-user-defined" id="ref-for-x-user-defined-2">x-user-defined</a>’s <a data-link-type="dfn" href="#decoder" id="ref-for-decoder-37">decoder</a>’s <a data-link-type="dfn" href="#handler" id="ref-for-handler-21">handler</a>, given a <var>stream</var> and <var>byte</var>, runs these steps: </p>
   <ol>
    <li>
     <p>If <var>byte</var> is <a data-link-type="dfn" href="#end-of-stream" id="ref-for-end-of-stream-37">end-of-stream</a>, return <a data-link-type="dfn" href="#finished" id="ref-for-finished-26">finished</a>. </p>
    <li>
     <p>If <var>byte</var> is an <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#ascii-byte">ASCII byte</a>, return
 a code point whose value is <var>byte</var>. </p>
    <li>
     <p>Return a code point whose value is 0xF780 + <var>byte</var> − 0x80. </p>
   </ol>
   <h4 class="heading settled" data-dfn-type="dfn" data-export="" data-level="14.5.2" data-lt="x-user-defined encoder" id="x-user-defined-encoder"><span class="secno">14.5.2. </span><span class="content">x-user-defined encoder</span><a class="self-link" href="#x-user-defined-encoder"></a></h4>
   <p><a data-link-type="dfn" href="#x-user-defined" id="ref-for-x-user-defined-3">x-user-defined</a>’s <a data-link-type="dfn" href="#encoder" id="ref-for-encoder-26">encoder</a>’s <a data-link-type="dfn" href="#handler" id="ref-for-handler-22">handler</a>, given a <var>stream</var> and <var>code point</var>, runs these steps: </p>
   <ol>
    <li>
     <p>If <var>code point</var> is <a data-link-type="dfn" href="#end-of-stream" id="ref-for-end-of-stream-38">end-of-stream</a>, return <a data-link-type="dfn" href="#finished" id="ref-for-finished-27">finished</a>. </p>
    <li>
     <p>If <var>code point</var> is an <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#ascii-code-point">ASCII code point</a>, return
 a byte whose value is <var>code point</var>. </p>
    <li>
     <p>If <var>code point</var> is in the range U+F780 to U+F7FF, inclusive, return
 a byte whose value is <var>code point</var> − 0xF780 + 0x80. </p>
    <li>
     <p>Return <a data-link-type="dfn" href="#error" id="ref-for-error-54">error</a> with <var>code point</var>. </p>
   </ol>
   <h2 class="heading settled" data-level="15" id="browser-ui"><span class="secno">15. </span><span class="content">Browser UI</span><a class="self-link" href="#browser-ui"></a></h2>
   <p>Browsers are encouraged to not enable overriding the encoding of a resource. If such a
feature is nonetheless present, browsers should not offer either <a data-link-type="dfn" href="#utf-16be" id="ref-for-utf-16be-10">UTF-16BE</a> or <a data-link-type="dfn" href="#utf-16le" id="ref-for-utf-16le-11">UTF-16LE</a> as option due to aforementioned security
issues. Browsers also should disable this feature if the resource was decoded using either <a data-link-type="dfn" href="#utf-16be" id="ref-for-utf-16be-11">UTF-16BE</a> or <a data-link-type="dfn" href="#utf-16le" id="ref-for-utf-16le-12">UTF-16LE</a>. </p>
   <h2 class="no-num heading settled" id="implementation-considerations"><span class="content">Implementation considerations</span><a class="self-link" href="#implementation-considerations"></a></h2>
   <p>Instead of supporting <a data-link-type="dfn" href="#concept-stream" id="ref-for-concept-stream-19">streams</a> with arbitrary <a data-link-type="dfn" href="#concept-stream-prepend" id="ref-for-concept-stream-prepend-21">prepend</a>, the <a data-link-type="dfn" href="#decoder" id="ref-for-decoder-38">decoders</a> for <a data-link-type="dfn" href="#encoding" id="ref-for-encoding-24">encodings</a> in this standard could be implemented with: </p>
   <ol>
    <li>
     <p>The ability to unread the current byte. </p>
    <li>
     <p>A single-byte buffer for <a data-link-type="dfn" href="#gb18030" id="ref-for-gb18030-9">gb18030</a> (an <a data-link-type="dfn" href="https://infra.spec.whatwg.org/#ascii-byte">ASCII byte</a>) and <a data-link-type="dfn" href="#iso-2022-jp" id="ref-for-iso-2022-jp-7">ISO-2022-JP</a> (0x24 or
  0x28). </p>
     <p class="example" id="example-gb18030-implementation-strategy"><a class="self-link" href="#example-gb18030-implementation-strategy"></a>For <a data-link-type="dfn" href="#gb18030" id="ref-for-gb18030-10">gb18030</a> when hitting a
  bogus byte while <a data-link-type="dfn" href="#gb18030-third" id="ref-for-gb18030-third-9">gb18030 third</a> is not 0x00, <a data-link-type="dfn" href="#gb18030-second" id="ref-for-gb18030-second-11">gb18030 second</a> could be moved into the
  single-byte buffer to be returned next, and <a data-link-type="dfn" href="#gb18030-third" id="ref-for-gb18030-third-10">gb18030 third</a> would be the new <a data-link-type="dfn" href="#gb18030-first" id="ref-for-gb18030-first-11">gb18030 first</a>, checked for not being 0x00 after the single-byte buffer was returned and
  emptied. This is possible as the range for the first and third byte in <a data-link-type="dfn" href="#gb18030" id="ref-for-gb18030-11">gb18030</a> is
  identical. </p>
   </ol>
   <p>The <a data-link-type="dfn" href="#iso-2022-jp-encoder" id="ref-for-iso-2022-jp-encoder-2">ISO-2022-JP encoder</a> needs <a data-link-type="dfn" href="#iso-2022-jp-encoder-state" id="ref-for-iso-2022-jp-encoder-state-13">ISO-2022-JP encoder state</a> as additional state, but
other than that, none of the <a data-link-type="dfn" href="#encoder" id="ref-for-encoder-27">encoders</a> for <a data-link-type="dfn" href="#encoding" id="ref-for-encoding-25">encodings</a> in this standard
require additional state or buffers. </p>
   <h2 class="no-num heading settled" id="acknowledgments"><span class="content">Acknowledgments</span><a class="self-link" href="#acknowledgments"></a></h2>
   <p>There have been a lot of people that have helped make encodings more
interoperable over the years and thereby furthered the goals of this
standard. Likewise many people have helped making this standard what it is
today. </p>
   <p>With that, many thanks to
Adam Rice,
Alan Chaney,
Alexander Shtuchkin,
Allen Wirfs-Brock,
Aneesh Agrawal,
Arkadiusz Michalski,
Asmus Freytag,
Ben Noordhuis,
Boris Zbarsky,
Bruno Haible,
Cameron McCormack,
Charles McCathieNeville,
David Carlisle,
Domenic Denicola,
Dominique Hazaël-Massieux,
Doug Ewell,
Erik van der Poel,
譚永鋒 (Frank Yung-Fong Tang),
Geoffrey Sneddon,
Glenn Maynard,
Gordon P. Hemsley,
Henri Sivonen,
Ian Hickson,
James Graham,
Jeffrey Yasskin,
John Tamplin,
Joshua Bell,
村井純 (Jun Murai),
신정식 (Jungshik Shin),
Jxck,
강 성훈 (Kang Seonghoon),
川幡太一 (Kawabata Taichi),
Ken Lunde,
Ken Whistler,
Kenneth Russell,
田村健人 (Kent Tamura),
Leif Halvard Silli,
Makoto Kato,
Mark Callow,
Mark Crispin,
Mark Davis,
Martin Dürst,
Masatoshi Kimura,
Ms2ger,
Nigel Megitt,
Nigel Tao,
Norbert Lindenberg,
Øistein E. Andersen,
Peter Krefting,
Philip Jägenstedt,
Philip Taylor,
Richard Ishida,
Robbert Broersma,
Robert Mustacchi,
Ryan Dahl,
Shawn Steele,
Simon Montagu,
Simon Pieters,
Simon Sapin,
寺田健 (Takeshi Terada),
Vyacheslav Matva, and
成瀬ゆい (Yui Naruse)
for being awesome. </p>
   <p>This standard is written by <a href="https://annevankesteren.nl/" lang="nl">Anne van Kesteren</a> (<a href="https://www.mozilla.org/">Mozilla</a>, <a href="mailto:annevk@annevk.nl">annevk@annevk.nl</a>). The <a href="#api">API</a> chapter
was initially written by Joshua Bell (<a href="https://www.google.com/">Google</a>). </p>
   <p>Per <a href="https://creativecommons.org/publicdomain/zero/1.0/" rel="license">CC0</a>, to
the extent possible under law, the editors have waived all copyright and related or
neighboring rights to this work. </p>
   <h2 class="no-num heading settled" id="changes"><span class="content">Changes</span><a class="self-link" href="#changes"></a></h2>
   <p>Changes since this document was previously updated contain both substantive and editorial changes.
   These can be found <a href="https://github.com/whatwg/encoding/commits/master">in the GitHub log</a>. 
      The following changes have been made since the previous W3C version of this document:</p>
   <ol>
    <li>(substantive) GB18030 Decoder: unwind from fourth byte when it’s not a digit
    <li>(substantive) ISO-2022-JP Encoder: convert half-width katakana to full-width katakana
    <li>(substantive) EUC-JP Decoder: only unwind ASCII bytes
    <li>Remove substeps as a concept
    <li>Check non-null before null
    <li>Various editorial changes to make links work and suppress warnings
   </ol>
  </main>
<script>
(function() {
  "use strict";
  var collapseSidebarText = '<span aria-hidden="true">←</span> '
                          + '<span>Collapse Sidebar</span>';
  var expandSidebarText   = '<span aria-hidden="true">→</span> '
                          + '<span>Pop Out Sidebar</span>';
  var tocJumpText         = '<span aria-hidden="true">↑</span> '
                          + '<span>Jump to Table of Contents</span>';

  var sidebarMedia = window.matchMedia('screen and (min-width: 78em)');
  var autoToggle   = function(e){ toggleSidebar(e.matches) };
  if(sidebarMedia.addListener) {
    sidebarMedia.addListener(autoToggle);
  }

  function toggleSidebar(on) {
    if (on == undefined) {
      on = !document.body.classList.contains('toc-sidebar');
    }

    /* Don’t scroll to compensate for the ToC if we’re above it already. */
    var headY = 0;
    var head = document.querySelector('.head');
    if (head) {
      // terrible approx of "top of ToC"
      headY += head.offsetTop + head.offsetHeight;
    }
    var skipScroll = window.scrollY < headY;

    var toggle = document.getElementById('toc-toggle');
    var tocNav = document.getElementById('toc');
    if (on) {
      var tocHeight = tocNav.offsetHeight;
      document.body.classList.add('toc-sidebar');
      document.body.classList.remove('toc-inline');
      toggle.innerHTML = collapseSidebarText;
      if (!skipScroll) {
        window.scrollBy(0, 0 - tocHeight);
      }
      tocNav.focus();
      sidebarMedia.addListener(autoToggle); // auto-collapse when out of room
    }
    else {
      document.body.classList.add('toc-inline');
      document.body.classList.remove('toc-sidebar');
      toggle.innerHTML = expandSidebarText;
      if (!skipScroll) {
        window.scrollBy(0, tocNav.offsetHeight);
      }
      if (toggle.matches(':hover')) {
        /* Unfocus button when not using keyboard navigation,
           because I don’t know where else to send the focus. */
        toggle.blur();
      }
    }
  }

  function createSidebarToggle() {
    /* Create the sidebar toggle in JS; it shouldn’t exist when JS is off. */
    var toggle = document.createElement('a');
      /* This should probably be a button, but appearance isn’t standards-track.*/
    toggle.id = 'toc-toggle';
    toggle.class = 'toc-toggle';
    toggle.href = '#toc';
    toggle.innerHTML = collapseSidebarText;

    sidebarMedia.addListener(autoToggle);
    var toggler = function(e) {
      e.preventDefault();
      sidebarMedia.removeListener(autoToggle); // persist explicit off states
      toggleSidebar();
      return false;
    }
    toggle.addEventListener('click', toggler, false);


    /* Get <nav id=toc-nav>, or make it if we don’t have one. */
    var tocNav = document.getElementById('toc-nav');
    if (!tocNav) {
      tocNav = document.createElement('p');
      tocNav.id = 'toc-nav';
      /* Prepend for better keyboard navigation */
      document.body.insertBefore(tocNav, document.body.firstChild);
    }
    /* While we’re at it, make sure we have a Jump to Toc link. */
    var tocJump = document.getElementById('toc-jump');
    if (!tocJump) {
      tocJump = document.createElement('a');
      tocJump.id = 'toc-jump';
      tocJump.href = '#toc';
      tocJump.innerHTML = tocJumpText;
      tocNav.appendChild(tocJump);
    }

    tocNav.appendChild(toggle);
  }

  var toc = document.getElementById('toc');
  if (toc) {
    createSidebarToggle();
    toggleSidebar(sidebarMedia.matches);

    /* If the sidebar has been manually opened and is currently overlaying the text
       (window too small for the MQ to add the margin to body),
       then auto-close the sidebar once you click on something in there. */
    toc.addEventListener('click', function(e) {
      if(e.target.tagName.toLowerCase() == "a" && document.body.classList.contains('toc-sidebar') && !sidebarMedia.matches) {
        toggleSidebar(false);
      }
    }, false);
  }
  else {
    console.warn("Can’t find Table of Contents. Please use <nav id='toc'> around the ToC.");
  }

  /* Wrap tables in case they overflow */
  var tables = document.querySelectorAll(':not(.overlarge) > table.data, :not(.overlarge) > table.index');
  var numTables = tables.length;
  for (var i = 0; i < numTables; i++) {
    var table = tables[i];
    var wrapper = document.createElement('div');
    wrapper.className = 'overlarge';
    table.parentNode.insertBefore(wrapper, table);
    wrapper.appendChild(table);
  }

})();
</script>
  <h2 class="no-num no-ref heading settled" id="references"><span class="content">References</span><a class="self-link" href="#references"></a></h2>
  <h3 class="no-num no-ref heading settled" id="normative"><span class="content">Normative References</span><a class="self-link" href="#normative"></a></h3>
  <dl>
   <dt id="biblio-infra">[INFRA]
   <dd>Anne van Kesteren; Domenic Denicola. <a href="https://infra.spec.whatwg.org/">Infra Standard</a>. Living Standard. URL: <a href="https://infra.spec.whatwg.org/">https://infra.spec.whatwg.org/</a>
   <dt id="biblio-unicode">[UNICODE]
   <dd><a href="http://www.unicode.org/versions/latest/">The Unicode Standard</a>. URL: <a href="http://www.unicode.org/versions/latest/">http://www.unicode.org/versions/latest/</a>
   <dt id="biblio-webidl">[WEBIDL]
   <dd>Cameron McCormack; Boris Zbarsky; Tobie Langel. <a href="https://heycam.github.io/webidl/">Web IDL</a>. URL: <a href="https://heycam.github.io/webidl/">https://heycam.github.io/webidl/</a>
  </dl>
  <h3 class="no-num no-ref heading settled" id="informative"><span class="content">Informative References</span><a class="self-link" href="#informative"></a></h3>
  <dl>
   <dt id="biblio-html">[HTML]
   <dd>Ian Hickson; et al. <a href="https://www.w3.org/TR/html5/">HTML5</a>. W3C Recommendation. URL: <a href="https://www.w3.org/TR/html5/">https://www.w3.org/TR/html5/</a>
  <dt id="biblio-url">[URL]
   <dd>Anne van Kesteren. <a href="https://url.spec.whatwg.org/">URL Standard</a>. Living Standard. URL: <a href="https://url.spec.whatwg.org/">https://url.spec.whatwg.org/</a>
   <dt id="biblio-xml">[XML]
   <dd>Tim Bray; et al. <a href="https://www.w3.org/TR/xml">Extensible Markup Language (XML) 1.0 (Fifth Edition)</a>. 26 November 2008. REC. URL: <a href="https://www.w3.org/TR/xml">https://www.w3.org/TR/xml</a>
  </dl>
  <aside class="dfn-panel" data-for="concept-token">
   <b><a href="#concept-token">#concept-token</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-concept-token-1">3. Terminology</a> <a href="#ref-for-concept-token-2">(2)</a> <a href="#ref-for-concept-token-3">(3)</a> <a href="#ref-for-concept-token-4">(4)</a> <a href="#ref-for-concept-token-5">(5)</a> <a href="#ref-for-concept-token-6">(6)</a>
    <li><a href="#ref-for-concept-token-7">4.1. Encoders and decoders</a> <a href="#ref-for-concept-token-8">(2)</a> <a href="#ref-for-concept-token-9">(3)</a> <a href="#ref-for-concept-token-10">(4)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="concept-stream">
   <b><a href="#concept-stream">#concept-stream</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-concept-stream-1">3. Terminology</a> <a href="#ref-for-concept-stream-2">(2)</a> <a href="#ref-for-concept-stream-3">(3)</a> <a href="#ref-for-concept-stream-4">(4)</a>
    <li><a href="#ref-for-concept-stream-5">4.1. Encoders and decoders</a> <a href="#ref-for-concept-stream-6">(2)</a> <a href="#ref-for-concept-stream-7">(3)</a> <a href="#ref-for-concept-stream-8">(4)</a> <a href="#ref-for-concept-stream-9">(5)</a>
    <li><a href="#ref-for-concept-stream-10">6. Specification hooks</a> <a href="#ref-for-concept-stream-11">(2)</a> <a href="#ref-for-concept-stream-12">(3)</a> <a href="#ref-for-concept-stream-13">(4)</a>
    <li><a href="#ref-for-concept-stream-14">7.1. Interface TextDecoder</a> <a href="#ref-for-concept-stream-15">(2)</a> <a href="#ref-for-concept-stream-16">(3)</a>
    <li><a href="#ref-for-concept-stream-17">7.2. Interface TextEncoder</a> <a href="#ref-for-concept-stream-18">(2)</a>
    <li><a href="#ref-for-concept-stream-19">Implementation considerations</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="end-of-stream">
   <b><a href="#end-of-stream">#end-of-stream</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-end-of-stream-1">3. Terminology</a>
    <li><a href="#ref-for-end-of-stream-2">6. Specification hooks</a>
    <li><a href="#ref-for-end-of-stream-3">7.1. Interface TextDecoder</a> <a href="#ref-for-end-of-stream-4">(2)</a> <a href="#ref-for-end-of-stream-5">(3)</a> <a href="#ref-for-end-of-stream-6">(4)</a>
    <li><a href="#ref-for-end-of-stream-7">8.1.1. UTF-8 decoder</a> <a href="#ref-for-end-of-stream-8">(2)</a>
    <li><a href="#ref-for-end-of-stream-9">8.1.2. UTF-8 encoder</a>
    <li><a href="#ref-for-end-of-stream-10">9.1. single-byte decoder</a>
    <li><a href="#ref-for-end-of-stream-11">9.2. single-byte encoder</a>
    <li><a href="#ref-for-end-of-stream-12">10.2.1. gb18030 decoder</a> <a href="#ref-for-end-of-stream-13">(2)</a>
    <li><a href="#ref-for-end-of-stream-14">10.2.2. gb18030 encoder</a>
    <li><a href="#ref-for-end-of-stream-15">11.1.1. Big5 decoder</a> <a href="#ref-for-end-of-stream-16">(2)</a>
    <li><a href="#ref-for-end-of-stream-17">11.1.2. Big5 encoder</a>
    <li><a href="#ref-for-end-of-stream-18">12.1.1. EUC-JP decoder</a> <a href="#ref-for-end-of-stream-19">(2)</a>
    <li><a href="#ref-for-end-of-stream-20">12.1.2. EUC-JP encoder</a>
    <li><a href="#ref-for-end-of-stream-21">12.2.1. ISO-2022-JP decoder</a> <a href="#ref-for-end-of-stream-22">(2)</a> <a href="#ref-for-end-of-stream-23">(3)</a> <a href="#ref-for-end-of-stream-24">(4)</a> <a href="#ref-for-end-of-stream-25">(5)</a>
    <li><a href="#ref-for-end-of-stream-26">12.2.2. ISO-2022-JP encoder</a> <a href="#ref-for-end-of-stream-27">(2)</a>
    <li><a href="#ref-for-end-of-stream-28">12.3.1. Shift_JIS decoder</a> <a href="#ref-for-end-of-stream-29">(2)</a>
    <li><a href="#ref-for-end-of-stream-30">12.3.2. Shift_JIS encoder</a>
    <li><a href="#ref-for-end-of-stream-31">13.1.1. EUC-KR decoder</a> <a href="#ref-for-end-of-stream-32">(2)</a>
    <li><a href="#ref-for-end-of-stream-33">13.1.2. EUC-KR encoder</a>
    <li><a href="#ref-for-end-of-stream-34">14.1.1. replacement decoder</a>
    <li><a href="#ref-for-end-of-stream-35">14.2.1. shared UTF-16 decoder</a> <a href="#ref-for-end-of-stream-36">(2)</a>
    <li><a href="#ref-for-end-of-stream-37">14.5.1. x-user-defined decoder</a>
    <li><a href="#ref-for-end-of-stream-38">14.5.2. x-user-defined encoder</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="concept-stream-read">
   <b><a href="#concept-stream-read">#concept-stream-read</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-concept-stream-read-1">4.1. Encoders and decoders</a>
    <li><a href="#ref-for-concept-stream-read-2">6. Specification hooks</a> <a href="#ref-for-concept-stream-read-3">(2)</a> <a href="#ref-for-concept-stream-read-4">(3)</a>
    <li><a href="#ref-for-concept-stream-read-5">7.1. Interface TextDecoder</a> <a href="#ref-for-concept-stream-read-6">(2)</a>
    <li><a href="#ref-for-concept-stream-read-7">7.2. Interface TextEncoder</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="concept-stream-prepend">
   <b><a href="#concept-stream-prepend">#concept-stream-prepend</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-concept-stream-prepend-1">4.1. Encoders and decoders</a>
    <li><a href="#ref-for-concept-stream-prepend-2">6. Specification hooks</a> <a href="#ref-for-concept-stream-prepend-3">(2)</a> <a href="#ref-for-concept-stream-prepend-4">(3)</a>
    <li><a href="#ref-for-concept-stream-prepend-5">8.1.1. UTF-8 decoder</a>
    <li><a href="#ref-for-concept-stream-prepend-6">10.2.1. gb18030 decoder</a> <a href="#ref-for-concept-stream-prepend-7">(2)</a> <a href="#ref-for-concept-stream-prepend-8">(3)</a>
    <li><a href="#ref-for-concept-stream-prepend-9">11.1.1. Big5 decoder</a>
    <li><a href="#ref-for-concept-stream-prepend-10">12.1.1. EUC-JP decoder</a>
    <li><a href="#ref-for-concept-stream-prepend-11">12.2.1. ISO-2022-JP decoder</a> <a href="#ref-for-concept-stream-prepend-12">(2)</a> <a href="#ref-for-concept-stream-prepend-13">(3)</a>
    <li><a href="#ref-for-concept-stream-prepend-14">12.2.2. ISO-2022-JP encoder</a> <a href="#ref-for-concept-stream-prepend-15">(2)</a> <a href="#ref-for-concept-stream-prepend-16">(3)</a> <a href="#ref-for-concept-stream-prepend-17">(4)</a>
    <li><a href="#ref-for-concept-stream-prepend-18">12.3.1. Shift_JIS decoder</a>
    <li><a href="#ref-for-concept-stream-prepend-19">13.1.1. EUC-KR decoder</a>
    <li><a href="#ref-for-concept-stream-prepend-20">14.2.1. shared UTF-16 decoder</a>
    <li><a href="#ref-for-concept-stream-prepend-21">Implementation considerations</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="concept-stream-push">
   <b><a href="#concept-stream-push">#concept-stream-push</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-concept-stream-push-1">4.1. Encoders and decoders</a> <a href="#ref-for-concept-stream-push-2">(2)</a>
    <li><a href="#ref-for-concept-stream-push-3">7.1. Interface TextDecoder</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="encoding">
   <b><a href="#encoding">#encoding</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-encoding-1">4. Encodings</a>
    <li><a href="#ref-for-encoding-2">4.1. Encoders and decoders</a> <a href="#ref-for-encoding-3">(2)</a> <a href="#ref-for-encoding-4">(3)</a> <a href="#ref-for-encoding-5">(4)</a> <a href="#ref-for-encoding-6">(5)</a>
    <li><a href="#ref-for-encoding-7">4.2. Names and labels</a> <a href="#ref-for-encoding-8">(2)</a> <a href="#ref-for-encoding-9">(3)</a> <a href="#ref-for-encoding-10">(4)</a> <a href="#ref-for-encoding-11">(5)</a> <a href="#ref-for-encoding-12">(6)</a> <a href="#ref-for-encoding-13">(7)</a> <a href="#ref-for-encoding-14">(8)</a>
    <li><a href="#ref-for-encoding-15">4.3. Output encodings</a>
    <li><a href="#ref-for-encoding-16">5. Indexes</a> <a href="#ref-for-encoding-17">(2)</a>
    <li><a href="#ref-for-encoding-18">6. Specification hooks</a> <a href="#ref-for-encoding-19">(2)</a>
    <li><a href="#ref-for-encoding-20">9. Legacy single-byte encodings</a> <a href="#ref-for-encoding-21">(2)</a>
    <li><a href="#ref-for-encoding-22">14.1. replacement</a> <a href="#ref-for-encoding-23">(2)</a>
    <li><a href="#ref-for-encoding-24">Implementation considerations</a> <a href="#ref-for-encoding-25">(2)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="name">
   <b><a href="#name">#name</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-name-1">4.2. Names and labels</a> <a href="#ref-for-name-2">(2)</a>
    <li><a href="#ref-for-name-3">7.1. Interface TextDecoder</a> <a href="#ref-for-name-4">(2)</a>
    <li><a href="#ref-for-name-5">9. Legacy single-byte encodings</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="label">
   <b><a href="#label">#label</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-label-1">4.2. Names and labels</a> <a href="#ref-for-label-2">(2)</a> <a href="#ref-for-label-3">(3)</a> <a href="#ref-for-label-4">(4)</a> <a href="#ref-for-label-5">(5)</a> <a href="#ref-for-label-6">(6)</a> <a href="#ref-for-label-7">(7)</a> <a href="#ref-for-label-8">(8)</a>
    <li><a href="#ref-for-label-9">6. Specification hooks</a>
    <li><a href="#ref-for-label-10">7.1. Interface TextDecoder</a> <a href="#ref-for-label-11">(2)</a>
    <li><a href="#ref-for-label-12">14.2.1. shared UTF-16 decoder</a>
    <li><a href="#ref-for-label-13">14.4. UTF-16LE</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="decoder">
   <b><a href="#decoder">#decoder</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-decoder-1">4.1. Encoders and decoders</a> <a href="#ref-for-decoder-2">(2)</a> <a href="#ref-for-decoder-3">(3)</a> <a href="#ref-for-decoder-4">(4)</a> <a href="#ref-for-decoder-5">(5)</a> <a href="#ref-for-decoder-6">(6)</a>
    <li><a href="#ref-for-decoder-7">5. Indexes</a>
    <li><a href="#ref-for-decoder-8">6. Specification hooks</a> <a href="#ref-for-decoder-9">(2)</a> <a href="#ref-for-decoder-10">(3)</a> <a href="#ref-for-decoder-11">(4)</a>
    <li><a href="#ref-for-decoder-12">7.1. Interface TextDecoder</a> <a href="#ref-for-decoder-13">(2)</a> <a href="#ref-for-decoder-14">(3)</a>
    <li><a href="#ref-for-decoder-15">8.1.1. UTF-8 decoder</a> <a href="#ref-for-decoder-16">(2)</a>
    <li><a href="#ref-for-decoder-17">9. Legacy single-byte encodings</a>
    <li><a href="#ref-for-decoder-18">9.1. single-byte decoder</a>
    <li><a href="#ref-for-decoder-19">10.1.1. GBK decoder</a> <a href="#ref-for-decoder-20">(2)</a>
    <li><a href="#ref-for-decoder-21">10.2.1. gb18030 decoder</a> <a href="#ref-for-decoder-22">(2)</a>
    <li><a href="#ref-for-decoder-23">11.1.1. Big5 decoder</a> <a href="#ref-for-decoder-24">(2)</a>
    <li><a href="#ref-for-decoder-25">12.1.1. EUC-JP decoder</a> <a href="#ref-for-decoder-26">(2)</a>
    <li><a href="#ref-for-decoder-27">12.2.1. ISO-2022-JP decoder</a> <a href="#ref-for-decoder-28">(2)</a>
    <li><a href="#ref-for-decoder-29">12.3.1. Shift_JIS decoder</a> <a href="#ref-for-decoder-30">(2)</a>
    <li><a href="#ref-for-decoder-31">13.1.1. EUC-KR decoder</a> <a href="#ref-for-decoder-32">(2)</a>
    <li><a href="#ref-for-decoder-33">14.1.1. replacement decoder</a> <a href="#ref-for-decoder-34">(2)</a>
    <li><a href="#ref-for-decoder-35">14.3.1. UTF-16BE decoder</a>
    <li><a href="#ref-for-decoder-36">14.4.1. UTF-16LE decoder</a>
    <li><a href="#ref-for-decoder-37">14.5.1. x-user-defined decoder</a>
    <li><a href="#ref-for-decoder-38">Implementation considerations</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="encoder">
   <b><a href="#encoder">#encoder</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-encoder-1">4.1. Encoders and decoders</a> <a href="#ref-for-encoder-2">(2)</a> <a href="#ref-for-encoder-3">(3)</a> <a href="#ref-for-encoder-4">(4)</a> <a href="#ref-for-encoder-5">(5)</a> <a href="#ref-for-encoder-6">(6)</a>
    <li><a href="#ref-for-encoder-7">5. Indexes</a>
    <li><a href="#ref-for-encoder-8">6. Specification hooks</a>
    <li><a href="#ref-for-encoder-9">7.2. Interface TextEncoder</a> <a href="#ref-for-encoder-10">(2)</a> <a href="#ref-for-encoder-11">(3)</a>
    <li><a href="#ref-for-encoder-12">8.1.2. UTF-8 encoder</a>
    <li><a href="#ref-for-encoder-13">9. Legacy single-byte encodings</a>
    <li><a href="#ref-for-encoder-14">9.2. single-byte encoder</a>
    <li><a href="#ref-for-encoder-15">10.1.2. GBK encoder</a> <a href="#ref-for-encoder-16">(2)</a> <a href="#ref-for-encoder-17">(3)</a>
    <li><a href="#ref-for-encoder-18">10.2.2. gb18030 encoder</a> <a href="#ref-for-encoder-19">(2)</a>
    <li><a href="#ref-for-encoder-20">11.1.2. Big5 encoder</a>
    <li><a href="#ref-for-encoder-21">12.1.2. EUC-JP encoder</a>
    <li><a href="#ref-for-encoder-22">12.2.2. ISO-2022-JP encoder</a> <a href="#ref-for-encoder-23">(2)</a>
    <li><a href="#ref-for-encoder-24">12.3.2. Shift_JIS encoder</a>
    <li><a href="#ref-for-encoder-25">13.1.2. EUC-KR encoder</a>
    <li><a href="#ref-for-encoder-26">14.5.2. x-user-defined encoder</a>
    <li><a href="#ref-for-encoder-27">Implementation considerations</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="handler">
   <b><a href="#handler">#handler</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-handler-1">4.1. Encoders and decoders</a> <a href="#ref-for-handler-2">(2)</a>
    <li><a href="#ref-for-handler-3">8.1.1. UTF-8 decoder</a>
    <li><a href="#ref-for-handler-4">8.1.2. UTF-8 encoder</a>
    <li><a href="#ref-for-handler-5">9.1. single-byte decoder</a>
    <li><a href="#ref-for-handler-6">9.2. single-byte encoder</a>
    <li><a href="#ref-for-handler-7">10.2.1. gb18030 decoder</a>
    <li><a href="#ref-for-handler-8">10.2.2. gb18030 encoder</a>
    <li><a href="#ref-for-handler-9">11.1.1. Big5 decoder</a>
    <li><a href="#ref-for-handler-10">11.1.2. Big5 encoder</a>
    <li><a href="#ref-for-handler-11">12.1.1. EUC-JP decoder</a>
    <li><a href="#ref-for-handler-12">12.1.2. EUC-JP encoder</a>
    <li><a href="#ref-for-handler-13">12.2.1. ISO-2022-JP decoder</a>
    <li><a href="#ref-for-handler-14">12.2.2. ISO-2022-JP encoder</a>
    <li><a href="#ref-for-handler-15">12.3.1. Shift_JIS decoder</a>
    <li><a href="#ref-for-handler-16">12.3.2. Shift_JIS encoder</a>
    <li><a href="#ref-for-handler-17">13.1.1. EUC-KR decoder</a>
    <li><a href="#ref-for-handler-18">13.1.2. EUC-KR encoder</a>
    <li><a href="#ref-for-handler-19">14.1.1. replacement decoder</a>
    <li><a href="#ref-for-handler-20">14.2.1. shared UTF-16 decoder</a>
    <li><a href="#ref-for-handler-21">14.5.1. x-user-defined decoder</a>
    <li><a href="#ref-for-handler-22">14.5.2. x-user-defined encoder</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="finished">
   <b><a href="#finished">#finished</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-finished-1">4.1. Encoders and decoders</a>
    <li><a href="#ref-for-finished-2">7.1. Interface TextDecoder</a>
    <li><a href="#ref-for-finished-3">7.2. Interface TextEncoder</a>
    <li><a href="#ref-for-finished-4">8.1.1. UTF-8 decoder</a>
    <li><a href="#ref-for-finished-5">8.1.2. UTF-8 encoder</a>
    <li><a href="#ref-for-finished-6">9.1. single-byte decoder</a>
    <li><a href="#ref-for-finished-7">9.2. single-byte encoder</a>
    <li><a href="#ref-for-finished-8">10.2.1. gb18030 decoder</a>
    <li><a href="#ref-for-finished-9">10.2.2. gb18030 encoder</a>
    <li><a href="#ref-for-finished-10">11.1.1. Big5 decoder</a>
    <li><a href="#ref-for-finished-11">11.1.2. Big5 encoder</a>
    <li><a href="#ref-for-finished-12">12.1.1. EUC-JP decoder</a>
    <li><a href="#ref-for-finished-13">12.1.2. EUC-JP encoder</a>
    <li><a href="#ref-for-finished-14">12.2.1. ISO-2022-JP decoder</a> <a href="#ref-for-finished-15">(2)</a> <a href="#ref-for-finished-16">(3)</a> <a href="#ref-for-finished-17">(4)</a>
    <li><a href="#ref-for-finished-18">12.2.2. ISO-2022-JP encoder</a>
    <li><a href="#ref-for-finished-19">12.3.1. Shift_JIS decoder</a>
    <li><a href="#ref-for-finished-20">12.3.2. Shift_JIS encoder</a>
    <li><a href="#ref-for-finished-21">13.1.1. EUC-KR decoder</a>
    <li><a href="#ref-for-finished-22">13.1.2. EUC-KR encoder</a>
    <li><a href="#ref-for-finished-23">14.1.1. replacement decoder</a> <a href="#ref-for-finished-24">(2)</a>
    <li><a href="#ref-for-finished-25">14.2.1. shared UTF-16 decoder</a>
    <li><a href="#ref-for-finished-26">14.5.1. x-user-defined decoder</a>
    <li><a href="#ref-for-finished-27">14.5.2. x-user-defined encoder</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="error">
   <b><a href="#error">#error</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-error-1">4.1. Encoders and decoders</a> <a href="#ref-for-error-2">(2)</a>
    <li><a href="#ref-for-error-3">6. Specification hooks</a> <a href="#ref-for-error-4">(2)</a>
    <li><a href="#ref-for-error-5">7.1. Interface TextDecoder</a> <a href="#ref-for-error-6">(2)</a>
    <li><a href="#ref-for-error-7">7.2. Interface TextEncoder</a>
    <li><a href="#ref-for-error-8">8.1.1. UTF-8 decoder</a> <a href="#ref-for-error-9">(2)</a> <a href="#ref-for-error-10">(3)</a>
    <li><a href="#ref-for-error-11">9.1. single-byte decoder</a>
    <li><a href="#ref-for-error-12">9.2. single-byte encoder</a>
    <li><a href="#ref-for-error-13">10.2.1. gb18030 decoder</a> <a href="#ref-for-error-14">(2)</a> <a href="#ref-for-error-15">(3)</a> <a href="#ref-for-error-16">(4)</a> <a href="#ref-for-error-17">(5)</a> <a href="#ref-for-error-18">(6)</a>
    <li><a href="#ref-for-error-19">10.2.2. gb18030 encoder</a> <a href="#ref-for-error-20">(2)</a>
    <li><a href="#ref-for-error-21">11.1.1. Big5 decoder</a> <a href="#ref-for-error-22">(2)</a> <a href="#ref-for-error-23">(3)</a>
    <li><a href="#ref-for-error-24">11.1.2. Big5 encoder</a>
    <li><a href="#ref-for-error-25">12.1.1. EUC-JP decoder</a> <a href="#ref-for-error-26">(2)</a> <a href="#ref-for-error-27">(3)</a>
    <li><a href="#ref-for-error-28">12.1.2. EUC-JP encoder</a>
    <li><a href="#ref-for-error-29">12.2.1. ISO-2022-JP decoder</a> <a href="#ref-for-error-30">(2)</a> <a href="#ref-for-error-31">(3)</a> <a href="#ref-for-error-32">(4)</a> <a href="#ref-for-error-33">(5)</a> <a href="#ref-for-error-34">(6)</a> <a href="#ref-for-error-35">(7)</a> <a href="#ref-for-error-36">(8)</a> <a href="#ref-for-error-37">(9)</a> <a href="#ref-for-error-38">(10)</a> <a href="#ref-for-error-39">(11)</a>
    <li><a href="#ref-for-error-40">12.2.2. ISO-2022-JP encoder</a> <a href="#ref-for-error-41">(2)</a>
    <li><a href="#ref-for-error-42">12.3.1. Shift_JIS decoder</a> <a href="#ref-for-error-43">(2)</a> <a href="#ref-for-error-44">(3)</a>
    <li><a href="#ref-for-error-45">12.3.2. Shift_JIS encoder</a>
    <li><a href="#ref-for-error-46">13.1.1. EUC-KR decoder</a> <a href="#ref-for-error-47">(2)</a> <a href="#ref-for-error-48">(3)</a>
    <li><a href="#ref-for-error-49">13.1.2. EUC-KR encoder</a>
    <li><a href="#ref-for-error-50">14.1.1. replacement decoder</a>
    <li><a href="#ref-for-error-51">14.2.1. shared UTF-16 decoder</a> <a href="#ref-for-error-52">(2)</a> <a href="#ref-for-error-53">(3)</a>
    <li><a href="#ref-for-error-54">14.5.2. x-user-defined encoder</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="continue">
   <b><a href="#continue">#continue</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-continue-1">4.1. Encoders and decoders</a> <a href="#ref-for-continue-2">(2)</a> <a href="#ref-for-continue-3">(3)</a>
    <li><a href="#ref-for-continue-4">8.1.1. UTF-8 decoder</a> <a href="#ref-for-continue-5">(2)</a>
    <li><a href="#ref-for-continue-6">10.2.1. gb18030 decoder</a> <a href="#ref-for-continue-7">(2)</a> <a href="#ref-for-continue-8">(3)</a>
    <li><a href="#ref-for-continue-9">11.1.1. Big5 decoder</a>
    <li><a href="#ref-for-continue-10">12.1.1. EUC-JP decoder</a> <a href="#ref-for-continue-11">(2)</a>
    <li><a href="#ref-for-continue-12">12.2.1. ISO-2022-JP decoder</a> <a href="#ref-for-continue-13">(2)</a> <a href="#ref-for-continue-14">(3)</a> <a href="#ref-for-continue-15">(4)</a> <a href="#ref-for-continue-16">(5)</a> <a href="#ref-for-continue-17">(6)</a> <a href="#ref-for-continue-18">(7)</a>
    <li><a href="#ref-for-continue-19">12.3.1. Shift_JIS decoder</a>
    <li><a href="#ref-for-continue-20">13.1.1. EUC-KR decoder</a>
    <li><a href="#ref-for-continue-21">14.2.1. shared UTF-16 decoder</a> <a href="#ref-for-continue-22">(2)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="error-mode">
   <b><a href="#error-mode">#error-mode</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-error-mode-1">4.1. Encoders and decoders</a> <a href="#ref-for-error-mode-2">(2)</a> <a href="#ref-for-error-mode-3">(3)</a> <a href="#ref-for-error-mode-4">(4)</a> <a href="#ref-for-error-mode-5">(5)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="concept-encoding-run">
   <b><a href="#concept-encoding-run">#concept-encoding-run</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-concept-encoding-run-1">6. Specification hooks</a> <a href="#ref-for-concept-encoding-run-2">(2)</a> <a href="#ref-for-concept-encoding-run-3">(3)</a> <a href="#ref-for-concept-encoding-run-4">(4)</a> <a href="#ref-for-concept-encoding-run-5">(5)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="concept-encoding-process">
   <b><a href="#concept-encoding-process">#concept-encoding-process</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-concept-encoding-process-1">4.1. Encoders and decoders</a>
    <li><a href="#ref-for-concept-encoding-process-2">7.1. Interface TextDecoder</a>
    <li><a href="#ref-for-concept-encoding-process-3">7.2. Interface TextEncoder</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="concept-encoding-get">
   <b><a href="#concept-encoding-get">#concept-encoding-get</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-concept-encoding-get-1">6. Specification hooks</a>
    <li><a href="#ref-for-concept-encoding-get-2">7.1. Interface TextDecoder</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="get-an-output-encoding">
   <b><a href="#get-an-output-encoding">#get-an-output-encoding</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-get-an-output-encoding-1">4.3. Output encodings</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="index">
   <b><a href="#index">#index</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-index-1">5. Indexes</a> <a href="#ref-for-index-2">(2)</a> <a href="#ref-for-index-3">(3)</a> <a href="#ref-for-index-4">(4)</a> <a href="#ref-for-index-5">(5)</a> <a href="#ref-for-index-6">(6)</a> <a href="#ref-for-index-7">(7)</a> <a href="#ref-for-index-8">(8)</a> <a href="#ref-for-index-9">(9)</a> <a href="#ref-for-index-10">(10)</a> <a href="#ref-for-index-11">(11)</a>
    <li><a href="#ref-for-index-12">9. Legacy single-byte encodings</a>
    <li><a href="#ref-for-index-13">11.1.1. Big5 decoder</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="index-code-point">
   <b><a href="#index-code-point">#index-code-point</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-index-code-point-1">9.1. single-byte decoder</a>
    <li><a href="#ref-for-index-code-point-2">10.2.1. gb18030 decoder</a>
    <li><a href="#ref-for-index-code-point-3">11.1.1. Big5 decoder</a>
    <li><a href="#ref-for-index-code-point-4">12.1.1. EUC-JP decoder</a>
    <li><a href="#ref-for-index-code-point-5">12.2.1. ISO-2022-JP decoder</a>
    <li><a href="#ref-for-index-code-point-6">12.2.2. ISO-2022-JP encoder</a>
    <li><a href="#ref-for-index-code-point-7">12.3.1. Shift_JIS decoder</a>
    <li><a href="#ref-for-index-code-point-8">13.1.1. EUC-KR decoder</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="index-pointer">
   <b><a href="#index-pointer">#index-pointer</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-index-pointer-1">5. Indexes</a> <a href="#ref-for-index-pointer-2">(2)</a>
    <li><a href="#ref-for-index-pointer-3">9.2. single-byte encoder</a>
    <li><a href="#ref-for-index-pointer-4">10.2.2. gb18030 encoder</a>
    <li><a href="#ref-for-index-pointer-5">12.1.2. EUC-JP encoder</a> <a href="#ref-for-index-pointer-6">(2)</a>
    <li><a href="#ref-for-index-pointer-7">12.2.2. ISO-2022-JP encoder</a> <a href="#ref-for-index-pointer-8">(2)</a>
    <li><a href="#ref-for-index-pointer-9">13.1.2. EUC-KR encoder</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="index-big5">
   <b><a href="#index-big5">#index-big5</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-index-big5-1">5. Indexes</a>
    <li><a href="#ref-for-index-big5-2">11.1.1. Big5 decoder</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="index-euc-kr">
   <b><a href="#index-euc-kr">#index-euc-kr</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-index-euc-kr-1">13.1.1. EUC-KR decoder</a>
    <li><a href="#ref-for-index-euc-kr-2">13.1.2. EUC-KR encoder</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="index-gb18030">
   <b><a href="#index-gb18030">#index-gb18030</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-index-gb18030-1">10.2.1. gb18030 decoder</a>
    <li><a href="#ref-for-index-gb18030-2">10.2.2. gb18030 encoder</a> <a href="#ref-for-index-gb18030-3">(2)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="index-gb18030-ranges">
   <b><a href="#index-gb18030-ranges">#index-gb18030-ranges</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-index-gb18030-ranges-1">5. Indexes</a> <a href="#ref-for-index-gb18030-ranges-2">(2)</a> <a href="#ref-for-index-gb18030-ranges-3">(3)</a> <a href="#ref-for-index-gb18030-ranges-4">(4)</a> <a href="#ref-for-index-gb18030-ranges-5">(5)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="index-jis0208">
   <b><a href="#index-jis0208">#index-jis0208</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-index-jis0208-1">5. Indexes</a> <a href="#ref-for-index-jis0208-2">(2)</a> <a href="#ref-for-index-jis0208-3">(3)</a>
    <li><a href="#ref-for-index-jis0208-4">12.1.1. EUC-JP decoder</a>
    <li><a href="#ref-for-index-jis0208-5">12.1.2. EUC-JP encoder</a> <a href="#ref-for-index-jis0208-6">(2)</a>
    <li><a href="#ref-for-index-jis0208-7">12.2.1. ISO-2022-JP decoder</a>
    <li><a href="#ref-for-index-jis0208-8">12.2.2. ISO-2022-JP encoder</a> <a href="#ref-for-index-jis0208-9">(2)</a>
    <li><a href="#ref-for-index-jis0208-10">12.3.1. Shift_JIS decoder</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="index-jis0212">
   <b><a href="#index-jis0212">#index-jis0212</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-index-jis0212-1">12.1.1. EUC-JP decoder</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="index-iso-2022-jp-katakana">
   <b><a href="#index-iso-2022-jp-katakana">#index-iso-2022-jp-katakana</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-index-iso-2022-jp-katakana-1">5. Indexes</a> <a href="#ref-for-index-iso-2022-jp-katakana-2">(2)</a>
    <li><a href="#ref-for-index-iso-2022-jp-katakana-3">12.2.2. ISO-2022-JP encoder</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="index-gb18030-ranges-code-point">
   <b><a href="#index-gb18030-ranges-code-point">#index-gb18030-ranges-code-point</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-index-gb18030-ranges-code-point-1">5. Indexes</a>
    <li><a href="#ref-for-index-gb18030-ranges-code-point-2">10.2.1. gb18030 decoder</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="index-gb18030-ranges-pointer">
   <b><a href="#index-gb18030-ranges-pointer">#index-gb18030-ranges-pointer</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-index-gb18030-ranges-pointer-1">5. Indexes</a>
    <li><a href="#ref-for-index-gb18030-ranges-pointer-2">10.2.2. gb18030 encoder</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="index-shift_jis-pointer">
   <b><a href="#index-shift_jis-pointer">#index-shift_jis-pointer</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-index-shift_jis-pointer-1">12.3.2. Shift_JIS encoder</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="index-big5-pointer">
   <b><a href="#index-big5-pointer">#index-big5-pointer</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-index-big5-pointer-1">11.1.2. Big5 encoder</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="decode">
   <b><a href="#decode">#decode</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-decode-1">6. Specification hooks</a>
    <li><a href="#ref-for-decode-2">7.1. Interface TextDecoder</a>
    <li><a href="#ref-for-decode-3">14.2.1. shared UTF-16 decoder</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="utf-8-decode">
   <b><a href="#utf-8-decode">#utf-8-decode</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-utf-8-decode-1">6. Specification hooks</a> <a href="#ref-for-utf-8-decode-2">(2)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="utf-8-decode-without-bom">
   <b><a href="#utf-8-decode-without-bom">#utf-8-decode-without-bom</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-utf-8-decode-without-bom-1">6. Specification hooks</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="utf-8-decode-without-bom-or-fail">
   <b><a href="#utf-8-decode-without-bom-or-fail">#utf-8-decode-without-bom-or-fail</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-utf-8-decode-without-bom-or-fail-1">6. Specification hooks</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="encode">
   <b><a href="#encode">#encode</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-encode-1">6. Specification hooks</a> <a href="#ref-for-encode-2">(2)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="utf-8-encode">
   <b><a href="#utf-8-encode">#utf-8-encode</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-utf-8-encode-1">6. Specification hooks</a> <a href="#ref-for-utf-8-encode-2">(2)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="textdecoderoptions">
   <b><a href="#textdecoderoptions">#textdecoderoptions</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-textdecoderoptions-1">7.1. Interface TextDecoder</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="textdecodeoptions">
   <b><a href="#textdecodeoptions">#textdecodeoptions</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-textdecodeoptions-1">7.1. Interface TextDecoder</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="textdecoder">
   <b><a href="#textdecoder">#textdecoder</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-textdecoder-1">7.1. Interface TextDecoder</a> <a href="#ref-for-textdecoder-2">(2)</a> <a href="#ref-for-textdecoder-3">(3)</a> <a href="#ref-for-textdecoder-4">(4)</a> <a href="#ref-for-textdecoder-5">(5)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="textdecoder-encoding">
   <b><a href="#textdecoder-encoding">#textdecoder-encoding</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-textdecoder-encoding-1">7.1. Interface TextDecoder</a> <a href="#ref-for-textdecoder-encoding-2">(2)</a> <a href="#ref-for-textdecoder-encoding-3">(3)</a> <a href="#ref-for-textdecoder-encoding-4">(4)</a> <a href="#ref-for-textdecoder-encoding-5">(5)</a> <a href="#ref-for-textdecoder-encoding-6">(6)</a> <a href="#ref-for-textdecoder-encoding-7">(7)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="textdecoder-decoder">
   <b><a href="#textdecoder-decoder">#textdecoder-decoder</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-textdecoder-decoder-1">7.1. Interface TextDecoder</a> <a href="#ref-for-textdecoder-decoder-2">(2)</a> <a href="#ref-for-textdecoder-decoder-3">(3)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="textdecoder-stream">
   <b><a href="#textdecoder-stream">#textdecoder-stream</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-textdecoder-stream-1">7.1. Interface TextDecoder</a> <a href="#ref-for-textdecoder-stream-2">(2)</a> <a href="#ref-for-textdecoder-stream-3">(3)</a> <a href="#ref-for-textdecoder-stream-4">(4)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="textdecoder-ignore-bom-flag">
   <b><a href="#textdecoder-ignore-bom-flag">#textdecoder-ignore-bom-flag</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-textdecoder-ignore-bom-flag-1">7.1. Interface TextDecoder</a> <a href="#ref-for-textdecoder-ignore-bom-flag-2">(2)</a> <a href="#ref-for-textdecoder-ignore-bom-flag-3">(3)</a> <a href="#ref-for-textdecoder-ignore-bom-flag-4">(4)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="textdecoder-bom-seen-flag">
   <b><a href="#textdecoder-bom-seen-flag">#textdecoder-bom-seen-flag</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-textdecoder-bom-seen-flag-1">7.1. Interface TextDecoder</a> <a href="#ref-for-textdecoder-bom-seen-flag-2">(2)</a> <a href="#ref-for-textdecoder-bom-seen-flag-3">(3)</a> <a href="#ref-for-textdecoder-bom-seen-flag-4">(4)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="textdecoder-error-mode">
   <b><a href="#textdecoder-error-mode">#textdecoder-error-mode</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-textdecoder-error-mode-1">7.1. Interface TextDecoder</a> <a href="#ref-for-textdecoder-error-mode-2">(2)</a> <a href="#ref-for-textdecoder-error-mode-3">(3)</a> <a href="#ref-for-textdecoder-error-mode-4">(4)</a> <a href="#ref-for-textdecoder-error-mode-5">(5)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="textdecoder-do-not-flush-flag">
   <b><a href="#textdecoder-do-not-flush-flag">#textdecoder-do-not-flush-flag</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-textdecoder-do-not-flush-flag-1">7.1. Interface TextDecoder</a> <a href="#ref-for-textdecoder-do-not-flush-flag-2">(2)</a> <a href="#ref-for-textdecoder-do-not-flush-flag-3">(3)</a> <a href="#ref-for-textdecoder-do-not-flush-flag-4">(4)</a> <a href="#ref-for-textdecoder-do-not-flush-flag-5">(5)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="concept-td-serialize">
   <b><a href="#concept-td-serialize">#concept-td-serialize</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-concept-td-serialize-1">7.1. Interface TextDecoder</a> <a href="#ref-for-concept-td-serialize-2">(2)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="dom-textdecoder">
   <b><a href="#dom-textdecoder">#dom-textdecoder</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dom-textdecoder-1">7.1. Interface TextDecoder</a> <a href="#ref-for-dom-textdecoder-2">(2)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="dom-textdecoder-encoding">
   <b><a href="#dom-textdecoder-encoding">#dom-textdecoder-encoding</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dom-textdecoder-encoding-1">7.1. Interface TextDecoder</a> <a href="#ref-for-dom-textdecoder-encoding-2">(2)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="dom-textdecoder-fatal">
   <b><a href="#dom-textdecoder-fatal">#dom-textdecoder-fatal</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dom-textdecoder-fatal-1">7.1. Interface TextDecoder</a> <a href="#ref-for-dom-textdecoder-fatal-2">(2)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="dom-textdecoder-ignorebom">
   <b><a href="#dom-textdecoder-ignorebom">#dom-textdecoder-ignorebom</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dom-textdecoder-ignorebom-1">7.1. Interface TextDecoder</a> <a href="#ref-for-dom-textdecoder-ignorebom-2">(2)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="dom-textdecoder-decode">
   <b><a href="#dom-textdecoder-decode">#dom-textdecoder-decode</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dom-textdecoder-decode-1">7.1. Interface TextDecoder</a> <a href="#ref-for-dom-textdecoder-decode-2">(2)</a> <a href="#ref-for-dom-textdecoder-decode-3">(3)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="textencoder">
   <b><a href="#textencoder">#textencoder</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-textencoder-1">7. API</a>
    <li><a href="#ref-for-textencoder-2">7.2. Interface TextEncoder</a> <a href="#ref-for-textencoder-3">(2)</a> <a href="#ref-for-textencoder-4">(3)</a> <a href="#ref-for-textencoder-5">(4)</a> <a href="#ref-for-textencoder-6">(5)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="textencoder-encoder">
   <b><a href="#textencoder-encoder">#textencoder-encoder</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-textencoder-encoder-1">7.2. Interface TextEncoder</a> <a href="#ref-for-textencoder-encoder-2">(2)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="dom-textencoder">
   <b><a href="#dom-textencoder">#dom-textencoder</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dom-textencoder-1">7.2. Interface TextEncoder</a> <a href="#ref-for-dom-textencoder-2">(2)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="dom-textencoder-encoding">
   <b><a href="#dom-textencoder-encoding">#dom-textencoder-encoding</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dom-textencoder-encoding-1">7.2. Interface TextEncoder</a> <a href="#ref-for-dom-textencoder-encoding-2">(2)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="dom-textencoder-encode">
   <b><a href="#dom-textencoder-encode">#dom-textencoder-encode</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-dom-textencoder-encode-1">7.2. Interface TextEncoder</a> <a href="#ref-for-dom-textencoder-encode-2">(2)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="utf-8">
   <b><a href="#utf-8">#utf-8</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-utf-8-1">4.1. Encoders and decoders</a>
    <li><a href="#ref-for-utf-8-2">4.2. Names and labels</a> <a href="#ref-for-utf-8-3">(2)</a> <a href="#ref-for-utf-8-4">(3)</a>
    <li><a href="#ref-for-utf-8-5">4.3. Output encodings</a>
    <li><a href="#ref-for-utf-8-6">6. Specification hooks</a> <a href="#ref-for-utf-8-7">(2)</a> <a href="#ref-for-utf-8-8">(3)</a> <a href="#ref-for-utf-8-9">(4)</a> <a href="#ref-for-utf-8-10">(5)</a> <a href="#ref-for-utf-8-11">(6)</a>
    <li><a href="#ref-for-utf-8-12">7. API</a> <a href="#ref-for-utf-8-13">(2)</a>
    <li><a href="#ref-for-utf-8-14">7.1. Interface TextDecoder</a>
    <li><a href="#ref-for-utf-8-15">7.2. Interface TextEncoder</a> <a href="#ref-for-utf-8-16">(2)</a> <a href="#ref-for-utf-8-17">(3)</a> <a href="#ref-for-utf-8-18">(4)</a>
    <li><a href="#ref-for-utf-8-19">8.1.1. UTF-8 decoder</a> <a href="#ref-for-utf-8-20">(2)</a>
    <li><a href="#ref-for-utf-8-21">8.1.2. UTF-8 encoder</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="utf-8-decoder">
   <b><a href="#utf-8-decoder">#utf-8-decoder</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-utf-8-decoder-1">8.1.1. UTF-8 decoder</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="utf-8-code-point">
   <b><a href="#utf-8-code-point">#utf-8-code-point</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-utf-8-code-point-1">8.1.1. UTF-8 decoder</a> <a href="#ref-for-utf-8-code-point-2">(2)</a> <a href="#ref-for-utf-8-code-point-3">(3)</a> <a href="#ref-for-utf-8-code-point-4">(4)</a> <a href="#ref-for-utf-8-code-point-5">(5)</a> <a href="#ref-for-utf-8-code-point-6">(6)</a> <a href="#ref-for-utf-8-code-point-7">(7)</a> <a href="#ref-for-utf-8-code-point-8">(8)</a> <a href="#ref-for-utf-8-code-point-9">(9)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="utf-8-bytes-seen">
   <b><a href="#utf-8-bytes-seen">#utf-8-bytes-seen</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-utf-8-bytes-seen-1">8.1.1. UTF-8 decoder</a> <a href="#ref-for-utf-8-bytes-seen-2">(2)</a> <a href="#ref-for-utf-8-bytes-seen-3">(3)</a> <a href="#ref-for-utf-8-bytes-seen-4">(4)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="utf-8-bytes-needed">
   <b><a href="#utf-8-bytes-needed">#utf-8-bytes-needed</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-utf-8-bytes-needed-1">8.1.1. UTF-8 decoder</a> <a href="#ref-for-utf-8-bytes-needed-2">(2)</a> <a href="#ref-for-utf-8-bytes-needed-3">(3)</a> <a href="#ref-for-utf-8-bytes-needed-4">(4)</a> <a href="#ref-for-utf-8-bytes-needed-5">(5)</a> <a href="#ref-for-utf-8-bytes-needed-6">(6)</a> <a href="#ref-for-utf-8-bytes-needed-7">(7)</a> <a href="#ref-for-utf-8-bytes-needed-8">(8)</a> <a href="#ref-for-utf-8-bytes-needed-9">(9)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="utf-8-lower-boundary">
   <b><a href="#utf-8-lower-boundary">#utf-8-lower-boundary</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-utf-8-lower-boundary-1">8.1.1. UTF-8 decoder</a> <a href="#ref-for-utf-8-lower-boundary-2">(2)</a> <a href="#ref-for-utf-8-lower-boundary-3">(3)</a> <a href="#ref-for-utf-8-lower-boundary-4">(4)</a> <a href="#ref-for-utf-8-lower-boundary-5">(5)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="utf-8-upper-boundary">
   <b><a href="#utf-8-upper-boundary">#utf-8-upper-boundary</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-utf-8-upper-boundary-1">8.1.1. UTF-8 decoder</a> <a href="#ref-for-utf-8-upper-boundary-2">(2)</a> <a href="#ref-for-utf-8-upper-boundary-3">(3)</a> <a href="#ref-for-utf-8-upper-boundary-4">(4)</a> <a href="#ref-for-utf-8-upper-boundary-5">(5)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="single-byte-encoding">
   <b><a href="#single-byte-encoding">#single-byte-encoding</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-single-byte-encoding-1">9. Legacy single-byte encodings</a> <a href="#ref-for-single-byte-encoding-2">(2)</a> <a href="#ref-for-single-byte-encoding-3">(3)</a>
    <li><a href="#ref-for-single-byte-encoding-4">9.1. single-byte decoder</a>
    <li><a href="#ref-for-single-byte-encoding-5">9.2. single-byte encoder</a>
    <li><a href="#ref-for-single-byte-encoding-6">14.5. x-user-defined</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="index-single-byte">
   <b><a href="#index-single-byte">#index-single-byte</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-index-single-byte-1">5. Indexes</a>
    <li><a href="#ref-for-index-single-byte-2">9.1. single-byte decoder</a>
    <li><a href="#ref-for-index-single-byte-3">9.2. single-byte encoder</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="ibm866">
   <b><a href="#ibm866">#ibm866</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-ibm866-1">4.2. Names and labels</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="iso-8859-2">
   <b><a href="#iso-8859-2">#iso-8859-2</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-iso-8859-2-1">4.2. Names and labels</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="iso-8859-3">
   <b><a href="#iso-8859-3">#iso-8859-3</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-iso-8859-3-1">4.2. Names and labels</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="iso-8859-4">
   <b><a href="#iso-8859-4">#iso-8859-4</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-iso-8859-4-1">4.2. Names and labels</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="iso-8859-5">
   <b><a href="#iso-8859-5">#iso-8859-5</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-iso-8859-5-1">4.2. Names and labels</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="iso-8859-6">
   <b><a href="#iso-8859-6">#iso-8859-6</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-iso-8859-6-1">4.2. Names and labels</a>
    <li><a href="#ref-for-iso-8859-6-2">9. Legacy single-byte encodings</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="iso-8859-7">
   <b><a href="#iso-8859-7">#iso-8859-7</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-iso-8859-7-1">4.2. Names and labels</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="iso-8859-8">
   <b><a href="#iso-8859-8">#iso-8859-8</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-iso-8859-8-1">4.2. Names and labels</a>
    <li><a href="#ref-for-iso-8859-8-2">9. Legacy single-byte encodings</a> <a href="#ref-for-iso-8859-8-3">(2)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="iso-8859-8-i">
   <b><a href="#iso-8859-8-i">#iso-8859-8-i</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-iso-8859-8-i-1">4.2. Names and labels</a>
    <li><a href="#ref-for-iso-8859-8-i-2">9. Legacy single-byte encodings</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="iso-8859-10">
   <b><a href="#iso-8859-10">#iso-8859-10</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-iso-8859-10-1">4.2. Names and labels</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="iso-8859-13">
   <b><a href="#iso-8859-13">#iso-8859-13</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-iso-8859-13-1">4.2. Names and labels</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="iso-8859-14">
   <b><a href="#iso-8859-14">#iso-8859-14</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-iso-8859-14-1">4.2. Names and labels</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="iso-8859-15">
   <b><a href="#iso-8859-15">#iso-8859-15</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-iso-8859-15-1">4.2. Names and labels</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="iso-8859-16">
   <b><a href="#iso-8859-16">#iso-8859-16</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-iso-8859-16-1">4.2. Names and labels</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="koi8-r">
   <b><a href="#koi8-r">#koi8-r</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-koi8-r-1">4.2. Names and labels</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="koi8-u">
   <b><a href="#koi8-u">#koi8-u</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-koi8-u-1">4.2. Names and labels</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="macintosh">
   <b><a href="#macintosh">#macintosh</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-macintosh-1">4.2. Names and labels</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="windows-874">
   <b><a href="#windows-874">#windows-874</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-windows-874-1">4.2. Names and labels</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="windows-1250">
   <b><a href="#windows-1250">#windows-1250</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-windows-1250-1">4.2. Names and labels</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="windows-1251">
   <b><a href="#windows-1251">#windows-1251</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-windows-1251-1">4.2. Names and labels</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="windows-1252">
   <b><a href="#windows-1252">#windows-1252</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-windows-1252-1">2. Security background</a>
    <li><a href="#ref-for-windows-1252-2">4.2. Names and labels</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="windows-1253">
   <b><a href="#windows-1253">#windows-1253</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-windows-1253-1">4.2. Names and labels</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="windows-1254">
   <b><a href="#windows-1254">#windows-1254</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-windows-1254-1">4.2. Names and labels</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="windows-1255">
   <b><a href="#windows-1255">#windows-1255</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-windows-1255-1">4.2. Names and labels</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="windows-1256">
   <b><a href="#windows-1256">#windows-1256</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-windows-1256-1">4.2. Names and labels</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="windows-1257">
   <b><a href="#windows-1257">#windows-1257</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-windows-1257-1">4.2. Names and labels</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="windows-1258">
   <b><a href="#windows-1258">#windows-1258</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-windows-1258-1">4.2. Names and labels</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="x-mac-cyrillic">
   <b><a href="#x-mac-cyrillic">#x-mac-cyrillic</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-x-mac-cyrillic-1">4.2. Names and labels</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="single-byte-decoder">
   <b><a href="#single-byte-decoder">#single-byte-decoder</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-single-byte-decoder-1">9. Legacy single-byte encodings</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="single-byte-encoder">
   <b><a href="#single-byte-encoder">#single-byte-encoder</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-single-byte-encoder-1">9. Legacy single-byte encodings</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="gbk">
   <b><a href="#gbk">#gbk</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-gbk-1">4.2. Names and labels</a>
    <li><a href="#ref-for-gbk-2">10.1.1. GBK decoder</a>
    <li><a href="#ref-for-gbk-3">10.1.2. GBK encoder</a> <a href="#ref-for-gbk-4">(2)</a> <a href="#ref-for-gbk-5">(3)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="gb18030">
   <b><a href="#gb18030">#gb18030</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-gb18030-1">4.2. Names and labels</a>
    <li><a href="#ref-for-gb18030-2">10.1.1. GBK decoder</a>
    <li><a href="#ref-for-gb18030-3">10.1.2. GBK encoder</a> <a href="#ref-for-gb18030-4">(2)</a>
    <li><a href="#ref-for-gb18030-5">10.2.1. gb18030 decoder</a> <a href="#ref-for-gb18030-6">(2)</a>
    <li><a href="#ref-for-gb18030-7">10.2.2. gb18030 encoder</a> <a href="#ref-for-gb18030-8">(2)</a>
    <li><a href="#ref-for-gb18030-9">Implementation considerations</a> <a href="#ref-for-gb18030-10">(2)</a> <a href="#ref-for-gb18030-11">(3)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="gb18030-first">
   <b><a href="#gb18030-first">#gb18030-first</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-gb18030-first-1">10.2.1. gb18030 decoder</a> <a href="#ref-for-gb18030-first-2">(2)</a> <a href="#ref-for-gb18030-first-3">(3)</a> <a href="#ref-for-gb18030-first-4">(4)</a> <a href="#ref-for-gb18030-first-5">(5)</a> <a href="#ref-for-gb18030-first-6">(6)</a> <a href="#ref-for-gb18030-first-7">(7)</a> <a href="#ref-for-gb18030-first-8">(8)</a> <a href="#ref-for-gb18030-first-9">(9)</a> <a href="#ref-for-gb18030-first-10">(10)</a>
    <li><a href="#ref-for-gb18030-first-11">Implementation considerations</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="gb18030-second">
   <b><a href="#gb18030-second">#gb18030-second</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-gb18030-second-1">10.2.1. gb18030 decoder</a> <a href="#ref-for-gb18030-second-2">(2)</a> <a href="#ref-for-gb18030-second-3">(3)</a> <a href="#ref-for-gb18030-second-4">(4)</a> <a href="#ref-for-gb18030-second-5">(5)</a> <a href="#ref-for-gb18030-second-6">(6)</a> <a href="#ref-for-gb18030-second-7">(7)</a> <a href="#ref-for-gb18030-second-8">(8)</a> <a href="#ref-for-gb18030-second-9">(9)</a> <a href="#ref-for-gb18030-second-10">(10)</a>
    <li><a href="#ref-for-gb18030-second-11">Implementation considerations</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="gb18030-third">
   <b><a href="#gb18030-third">#gb18030-third</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-gb18030-third-1">10.2.1. gb18030 decoder</a> <a href="#ref-for-gb18030-third-2">(2)</a> <a href="#ref-for-gb18030-third-3">(3)</a> <a href="#ref-for-gb18030-third-4">(4)</a> <a href="#ref-for-gb18030-third-5">(5)</a> <a href="#ref-for-gb18030-third-6">(6)</a> <a href="#ref-for-gb18030-third-7">(7)</a> <a href="#ref-for-gb18030-third-8">(8)</a>
    <li><a href="#ref-for-gb18030-third-9">Implementation considerations</a> <a href="#ref-for-gb18030-third-10">(2)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="gbk-flag">
   <b><a href="#gbk-flag">#gbk-flag</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-gbk-flag-1">10.1.2. GBK encoder</a>
    <li><a href="#ref-for-gbk-flag-2">10.2.2. gb18030 encoder</a> <a href="#ref-for-gbk-flag-3">(2)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="big5">
   <b><a href="#big5">#big5</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-big5-1">4.2. Names and labels</a>
    <li><a href="#ref-for-big5-2">11.1.1. Big5 decoder</a> <a href="#ref-for-big5-3">(2)</a>
    <li><a href="#ref-for-big5-4">11.1.2. Big5 encoder</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="big5-lead">
   <b><a href="#big5-lead">#big5-lead</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-big5-lead-1">11.1.1. Big5 decoder</a> <a href="#ref-for-big5-lead-2">(2)</a> <a href="#ref-for-big5-lead-3">(3)</a> <a href="#ref-for-big5-lead-4">(4)</a> <a href="#ref-for-big5-lead-5">(5)</a> <a href="#ref-for-big5-lead-6">(6)</a> <a href="#ref-for-big5-lead-7">(7)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="euc-jp">
   <b><a href="#euc-jp">#euc-jp</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-euc-jp-1">4.2. Names and labels</a>
    <li><a href="#ref-for-euc-jp-2">12.1.1. EUC-JP decoder</a> <a href="#ref-for-euc-jp-3">(2)</a>
    <li><a href="#ref-for-euc-jp-4">12.1.2. EUC-JP encoder</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="euc-jp-decoder">
   <b><a href="#euc-jp-decoder">#euc-jp-decoder</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-euc-jp-decoder-1">5. Indexes</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="euc-jp-jis0212-flag">
   <b><a href="#euc-jp-jis0212-flag">#euc-jp-jis0212-flag</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-euc-jp-jis0212-flag-1">12.1.1. EUC-JP decoder</a> <a href="#ref-for-euc-jp-jis0212-flag-2">(2)</a> <a href="#ref-for-euc-jp-jis0212-flag-3">(3)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="euc-jp-lead">
   <b><a href="#euc-jp-lead">#euc-jp-lead</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-euc-jp-lead-1">12.1.1. EUC-JP decoder</a> <a href="#ref-for-euc-jp-lead-2">(2)</a> <a href="#ref-for-euc-jp-lead-3">(3)</a> <a href="#ref-for-euc-jp-lead-4">(4)</a> <a href="#ref-for-euc-jp-lead-5">(5)</a> <a href="#ref-for-euc-jp-lead-6">(6)</a> <a href="#ref-for-euc-jp-lead-7">(7)</a> <a href="#ref-for-euc-jp-lead-8">(8)</a> <a href="#ref-for-euc-jp-lead-9">(9)</a> <a href="#ref-for-euc-jp-lead-10">(10)</a> <a href="#ref-for-euc-jp-lead-11">(11)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="iso-2022-jp">
   <b><a href="#iso-2022-jp">#iso-2022-jp</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-iso-2022-jp-1">2. Security background</a>
    <li><a href="#ref-for-iso-2022-jp-2">4.2. Names and labels</a>
    <li><a href="#ref-for-iso-2022-jp-3">12.2.1. ISO-2022-JP decoder</a> <a href="#ref-for-iso-2022-jp-4">(2)</a>
    <li><a href="#ref-for-iso-2022-jp-5">12.2.2. ISO-2022-JP encoder</a> <a href="#ref-for-iso-2022-jp-6">(2)</a>
    <li><a href="#ref-for-iso-2022-jp-7">Implementation considerations</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="iso-2022-jp-decoder-state">
   <b><a href="#iso-2022-jp-decoder-state">#iso-2022-jp-decoder-state</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-iso-2022-jp-decoder-state-1">12.2.1. ISO-2022-JP decoder</a> <a href="#ref-for-iso-2022-jp-decoder-state-2">(2)</a> <a href="#ref-for-iso-2022-jp-decoder-state-3">(3)</a> <a href="#ref-for-iso-2022-jp-decoder-state-4">(4)</a> <a href="#ref-for-iso-2022-jp-decoder-state-5">(5)</a> <a href="#ref-for-iso-2022-jp-decoder-state-6">(6)</a> <a href="#ref-for-iso-2022-jp-decoder-state-7">(7)</a> <a href="#ref-for-iso-2022-jp-decoder-state-8">(8)</a> <a href="#ref-for-iso-2022-jp-decoder-state-9">(9)</a> <a href="#ref-for-iso-2022-jp-decoder-state-10">(10)</a> <a href="#ref-for-iso-2022-jp-decoder-state-11">(11)</a> <a href="#ref-for-iso-2022-jp-decoder-state-12">(12)</a> <a href="#ref-for-iso-2022-jp-decoder-state-13">(13)</a> <a href="#ref-for-iso-2022-jp-decoder-state-14">(14)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="iso-2022-jp-decoder-output-state">
   <b><a href="#iso-2022-jp-decoder-output-state">#iso-2022-jp-decoder-output-state</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-iso-2022-jp-decoder-output-state-1">12.2.1. ISO-2022-JP decoder</a> <a href="#ref-for-iso-2022-jp-decoder-output-state-2">(2)</a> <a href="#ref-for-iso-2022-jp-decoder-output-state-3">(3)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="iso-2022-jp-lead">
   <b><a href="#iso-2022-jp-lead">#iso-2022-jp-lead</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-iso-2022-jp-lead-1">12.2.1. ISO-2022-JP decoder</a> <a href="#ref-for-iso-2022-jp-lead-2">(2)</a> <a href="#ref-for-iso-2022-jp-lead-3">(3)</a> <a href="#ref-for-iso-2022-jp-lead-4">(4)</a> <a href="#ref-for-iso-2022-jp-lead-5">(5)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="iso-2022-jp-output-flag">
   <b><a href="#iso-2022-jp-output-flag">#iso-2022-jp-output-flag</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-iso-2022-jp-output-flag-1">12.2.1. ISO-2022-JP decoder</a> <a href="#ref-for-iso-2022-jp-output-flag-2">(2)</a> <a href="#ref-for-iso-2022-jp-output-flag-3">(3)</a> <a href="#ref-for-iso-2022-jp-output-flag-4">(4)</a> <a href="#ref-for-iso-2022-jp-output-flag-5">(5)</a> <a href="#ref-for-iso-2022-jp-output-flag-6">(6)</a> <a href="#ref-for-iso-2022-jp-output-flag-7">(7)</a> <a href="#ref-for-iso-2022-jp-output-flag-8">(8)</a> <a href="#ref-for-iso-2022-jp-output-flag-9">(9)</a> <a href="#ref-for-iso-2022-jp-output-flag-10">(10)</a> <a href="#ref-for-iso-2022-jp-output-flag-11">(11)</a> <a href="#ref-for-iso-2022-jp-output-flag-12">(12)</a> <a href="#ref-for-iso-2022-jp-output-flag-13">(13)</a> <a href="#ref-for-iso-2022-jp-output-flag-14">(14)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="iso-2022-jp-decoder-ascii">
   <b><a href="#iso-2022-jp-decoder-ascii">#iso-2022-jp-decoder-ascii</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-iso-2022-jp-decoder-ascii-1">12.2.1. ISO-2022-JP decoder</a> <a href="#ref-for-iso-2022-jp-decoder-ascii-2">(2)</a> <a href="#ref-for-iso-2022-jp-decoder-ascii-3">(3)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="iso-2022-jp-decoder-roman">
   <b><a href="#iso-2022-jp-decoder-roman">#iso-2022-jp-decoder-roman</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-iso-2022-jp-decoder-roman-1">12.2.1. ISO-2022-JP decoder</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="iso-2022-jp-decoder-katakana">
   <b><a href="#iso-2022-jp-decoder-katakana">#iso-2022-jp-decoder-katakana</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-iso-2022-jp-decoder-katakana-1">12.2.1. ISO-2022-JP decoder</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="iso-2022-jp-decoder-lead-byte">
   <b><a href="#iso-2022-jp-decoder-lead-byte">#iso-2022-jp-decoder-lead-byte</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-iso-2022-jp-decoder-lead-byte-1">12.2.1. ISO-2022-JP decoder</a> <a href="#ref-for-iso-2022-jp-decoder-lead-byte-2">(2)</a> <a href="#ref-for-iso-2022-jp-decoder-lead-byte-3">(3)</a> <a href="#ref-for-iso-2022-jp-decoder-lead-byte-4">(4)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="iso-2022-jp-decoder-trail-byte">
   <b><a href="#iso-2022-jp-decoder-trail-byte">#iso-2022-jp-decoder-trail-byte</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-iso-2022-jp-decoder-trail-byte-1">12.2.1. ISO-2022-JP decoder</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="iso-2022-jp-decoder-escape-start">
   <b><a href="#iso-2022-jp-decoder-escape-start">#iso-2022-jp-decoder-escape-start</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-iso-2022-jp-decoder-escape-start-1">12.2.1. ISO-2022-JP decoder</a> <a href="#ref-for-iso-2022-jp-decoder-escape-start-2">(2)</a> <a href="#ref-for-iso-2022-jp-decoder-escape-start-3">(3)</a> <a href="#ref-for-iso-2022-jp-decoder-escape-start-4">(4)</a> <a href="#ref-for-iso-2022-jp-decoder-escape-start-5">(5)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="iso-2022-jp-decoder-escape">
   <b><a href="#iso-2022-jp-decoder-escape">#iso-2022-jp-decoder-escape</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-iso-2022-jp-decoder-escape-1">12.2.1. ISO-2022-JP decoder</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="iso-2022-jp-encoder">
   <b><a href="#iso-2022-jp-encoder">#iso-2022-jp-encoder</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-iso-2022-jp-encoder-1">5. Indexes</a>
    <li><a href="#ref-for-iso-2022-jp-encoder-2">Implementation considerations</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="iso-2022-jp-encoder-state">
   <b><a href="#iso-2022-jp-encoder-state">#iso-2022-jp-encoder-state</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-iso-2022-jp-encoder-state-1">12.2.2. ISO-2022-JP encoder</a> <a href="#ref-for-iso-2022-jp-encoder-state-2">(2)</a> <a href="#ref-for-iso-2022-jp-encoder-state-3">(3)</a> <a href="#ref-for-iso-2022-jp-encoder-state-4">(4)</a> <a href="#ref-for-iso-2022-jp-encoder-state-5">(5)</a> <a href="#ref-for-iso-2022-jp-encoder-state-6">(6)</a> <a href="#ref-for-iso-2022-jp-encoder-state-7">(7)</a> <a href="#ref-for-iso-2022-jp-encoder-state-8">(8)</a> <a href="#ref-for-iso-2022-jp-encoder-state-9">(9)</a> <a href="#ref-for-iso-2022-jp-encoder-state-10">(10)</a> <a href="#ref-for-iso-2022-jp-encoder-state-11">(11)</a> <a href="#ref-for-iso-2022-jp-encoder-state-12">(12)</a>
    <li><a href="#ref-for-iso-2022-jp-encoder-state-13">Implementation considerations</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="iso-2022-jp-encoder-ascii">
   <b><a href="#iso-2022-jp-encoder-ascii">#iso-2022-jp-encoder-ascii</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-iso-2022-jp-encoder-ascii-1">12.2.2. ISO-2022-JP encoder</a> <a href="#ref-for-iso-2022-jp-encoder-ascii-2">(2)</a> <a href="#ref-for-iso-2022-jp-encoder-ascii-3">(3)</a> <a href="#ref-for-iso-2022-jp-encoder-ascii-4">(4)</a> <a href="#ref-for-iso-2022-jp-encoder-ascii-5">(5)</a> <a href="#ref-for-iso-2022-jp-encoder-ascii-6">(6)</a> <a href="#ref-for-iso-2022-jp-encoder-ascii-7">(7)</a> <a href="#ref-for-iso-2022-jp-encoder-ascii-8">(8)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="iso-2022-jp-encoder-roman">
   <b><a href="#iso-2022-jp-encoder-roman">#iso-2022-jp-encoder-roman</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-iso-2022-jp-encoder-roman-1">12.2.2. ISO-2022-JP encoder</a> <a href="#ref-for-iso-2022-jp-encoder-roman-2">(2)</a> <a href="#ref-for-iso-2022-jp-encoder-roman-3">(3)</a> <a href="#ref-for-iso-2022-jp-encoder-roman-4">(4)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="iso-2022-jp-encoder-jis0208">
   <b><a href="#iso-2022-jp-encoder-jis0208">#iso-2022-jp-encoder-jis0208</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-iso-2022-jp-encoder-jis0208-1">12.2.2. ISO-2022-JP encoder</a> <a href="#ref-for-iso-2022-jp-encoder-jis0208-2">(2)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="shift_jis">
   <b><a href="#shift_jis">#shift_jis</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-shift_jis-1">2. Security background</a>
    <li><a href="#ref-for-shift_jis-2">4.2. Names and labels</a>
    <li><a href="#ref-for-shift_jis-3">5. Indexes</a>
    <li><a href="#ref-for-shift_jis-4">12.3.1. Shift_JIS decoder</a> <a href="#ref-for-shift_jis-5">(2)</a>
    <li><a href="#ref-for-shift_jis-6">12.3.2. Shift_JIS encoder</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="shift_jis-lead">
   <b><a href="#shift_jis-lead">#shift_jis-lead</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-shift_jis-lead-1">12.3.1. Shift_JIS decoder</a> <a href="#ref-for-shift_jis-lead-2">(2)</a> <a href="#ref-for-shift_jis-lead-3">(3)</a> <a href="#ref-for-shift_jis-lead-4">(4)</a> <a href="#ref-for-shift_jis-lead-5">(5)</a> <a href="#ref-for-shift_jis-lead-6">(6)</a> <a href="#ref-for-shift_jis-lead-7">(7)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="euc-kr">
   <b><a href="#euc-kr">#euc-kr</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-euc-kr-1">4.2. Names and labels</a>
    <li><a href="#ref-for-euc-kr-2">13.1.1. EUC-KR decoder</a> <a href="#ref-for-euc-kr-3">(2)</a>
    <li><a href="#ref-for-euc-kr-4">13.1.2. EUC-KR encoder</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="euc-kr-lead">
   <b><a href="#euc-kr-lead">#euc-kr-lead</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-euc-kr-lead-1">13.1.1. EUC-KR decoder</a> <a href="#ref-for-euc-kr-lead-2">(2)</a> <a href="#ref-for-euc-kr-lead-3">(3)</a> <a href="#ref-for-euc-kr-lead-4">(4)</a> <a href="#ref-for-euc-kr-lead-5">(5)</a> <a href="#ref-for-euc-kr-lead-6">(6)</a> <a href="#ref-for-euc-kr-lead-7">(7)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="replacement">
   <b><a href="#replacement">#replacement</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-replacement-1">2. Security background</a>
    <li><a href="#ref-for-replacement-2">4.1. Encoders and decoders</a>
    <li><a href="#ref-for-replacement-3">4.2. Names and labels</a>
    <li><a href="#ref-for-replacement-4">4.3. Output encodings</a>
    <li><a href="#ref-for-replacement-5">6. Specification hooks</a>
    <li><a href="#ref-for-replacement-6">7.1. Interface TextDecoder</a> <a href="#ref-for-replacement-7">(2)</a>
    <li><a href="#ref-for-replacement-8">14.1. replacement</a>
    <li><a href="#ref-for-replacement-9">14.1.1. replacement decoder</a> <a href="#ref-for-replacement-10">(2)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="replacement-error-returned-flag">
   <b><a href="#replacement-error-returned-flag">#replacement-error-returned-flag</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-replacement-error-returned-flag-1">14.1.1. replacement decoder</a> <a href="#ref-for-replacement-error-returned-flag-2">(2)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="shared-utf-16-decoder">
   <b><a href="#shared-utf-16-decoder">#shared-utf-16-decoder</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-shared-utf-16-decoder-1">14.2.1. shared UTF-16 decoder</a> <a href="#ref-for-shared-utf-16-decoder-2">(2)</a> <a href="#ref-for-shared-utf-16-decoder-3">(3)</a>
    <li><a href="#ref-for-shared-utf-16-decoder-4">14.3.1. UTF-16BE decoder</a>
    <li><a href="#ref-for-shared-utf-16-decoder-5">14.4.1. UTF-16LE decoder</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="utf-16-lead-byte">
   <b><a href="#utf-16-lead-byte">#utf-16-lead-byte</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-utf-16-lead-byte-1">14.2.1. shared UTF-16 decoder</a> <a href="#ref-for-utf-16-lead-byte-2">(2)</a> <a href="#ref-for-utf-16-lead-byte-3">(3)</a> <a href="#ref-for-utf-16-lead-byte-4">(4)</a> <a href="#ref-for-utf-16-lead-byte-5">(5)</a> <a href="#ref-for-utf-16-lead-byte-6">(6)</a> <a href="#ref-for-utf-16-lead-byte-7">(7)</a> <a href="#ref-for-utf-16-lead-byte-8">(8)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="utf-16-lead-surrogate">
   <b><a href="#utf-16-lead-surrogate">#utf-16-lead-surrogate</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-utf-16-lead-surrogate-1">14.2.1. shared UTF-16 decoder</a> <a href="#ref-for-utf-16-lead-surrogate-2">(2)</a> <a href="#ref-for-utf-16-lead-surrogate-3">(3)</a> <a href="#ref-for-utf-16-lead-surrogate-4">(4)</a> <a href="#ref-for-utf-16-lead-surrogate-5">(5)</a> <a href="#ref-for-utf-16-lead-surrogate-6">(6)</a> <a href="#ref-for-utf-16-lead-surrogate-7">(7)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="utf-16be-decoder-flag">
   <b><a href="#utf-16be-decoder-flag">#utf-16be-decoder-flag</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-utf-16be-decoder-flag-1">14.2.1. shared UTF-16 decoder</a> <a href="#ref-for-utf-16be-decoder-flag-2">(2)</a> <a href="#ref-for-utf-16be-decoder-flag-3">(3)</a>
    <li><a href="#ref-for-utf-16be-decoder-flag-4">14.3.1. UTF-16BE decoder</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="utf-16be">
   <b><a href="#utf-16be">#utf-16be</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-utf-16be-1">2. Security background</a>
    <li><a href="#ref-for-utf-16be-2">4.1. Encoders and decoders</a>
    <li><a href="#ref-for-utf-16be-3">4.2. Names and labels</a>
    <li><a href="#ref-for-utf-16be-4">4.3. Output encodings</a>
    <li><a href="#ref-for-utf-16be-5">6. Specification hooks</a> <a href="#ref-for-utf-16be-6">(2)</a>
    <li><a href="#ref-for-utf-16be-7">7.1. Interface TextDecoder</a>
    <li><a href="#ref-for-utf-16be-8">14.2. Common infrastructure for UTF-16BE and UTF-16LE</a>
    <li><a href="#ref-for-utf-16be-9">14.3.1. UTF-16BE decoder</a>
    <li><a href="#ref-for-utf-16be-10">15. Browser UI</a> <a href="#ref-for-utf-16be-11">(2)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="utf-16le">
   <b><a href="#utf-16le">#utf-16le</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-utf-16le-1">2. Security background</a>
    <li><a href="#ref-for-utf-16le-2">4.1. Encoders and decoders</a>
    <li><a href="#ref-for-utf-16le-3">4.2. Names and labels</a>
    <li><a href="#ref-for-utf-16le-4">4.3. Output encodings</a>
    <li><a href="#ref-for-utf-16le-5">6. Specification hooks</a> <a href="#ref-for-utf-16le-6">(2)</a>
    <li><a href="#ref-for-utf-16le-7">7.1. Interface TextDecoder</a>
    <li><a href="#ref-for-utf-16le-8">14.2. Common infrastructure for UTF-16BE and UTF-16LE</a>
    <li><a href="#ref-for-utf-16le-9">14.4. UTF-16LE</a>
    <li><a href="#ref-for-utf-16le-10">14.4.1. UTF-16LE decoder</a>
    <li><a href="#ref-for-utf-16le-11">15. Browser UI</a> <a href="#ref-for-utf-16le-12">(2)</a>
   </ul>
  </aside>
  <aside class="dfn-panel" data-for="x-user-defined">
   <b><a href="#x-user-defined">#x-user-defined</a></b><b>Referenced in:</b>
   <ul>
    <li><a href="#ref-for-x-user-defined-1">4.2. Names and labels</a>
    <li><a href="#ref-for-x-user-defined-2">14.5.1. x-user-defined decoder</a>
    <li><a href="#ref-for-x-user-defined-3">14.5.2. x-user-defined encoder</a>
   </ul>
  </aside>
<script>/* script-dfn-panel */

        document.body.addEventListener("click", function(e) {
            var queryAll = function(sel) { return [].slice.call(document.querySelectorAll(sel)); }
            // Find the dfn element or panel, if any, that was clicked on.
            var el = e.target;
            var target;
            var hitALink = false;
            while(el.parentElement) {
                if(el.tagName == "A") {
                    // Clicking on a link in a <dfn> shouldn't summon the panel
                    hitALink = true;
                }
                if(el.classList.contains("dfn-paneled")) {
                    target = "dfn";
                    break;
                }
                if(el.classList.contains("dfn-panel")) {
                    target = "dfn-panel";
                    break;
                }
                el = el.parentElement;
            }
            if(target != "dfn-panel") {
                // Turn off any currently "on" or "activated" panels.
                queryAll(".dfn-panel.on, .dfn-panel.activated").forEach(function(el){
                    el.classList.remove("on");
                    el.classList.remove("activated");
                });
            }
            if(target == "dfn" && !hitALink) {
                // open the panel
                var dfnPanel = document.querySelector(".dfn-panel[data-for='" + el.id + "']");
                if(dfnPanel) {
                    console.log(dfnPanel);
                    dfnPanel.classList.add("on");
                    var rect = el.getBoundingClientRect();
                    dfnPanel.style.left = window.scrollX + rect.right + 5 + "px";
                    dfnPanel.style.top = window.scrollY + rect.top + "px";
                    var panelRect = dfnPanel.getBoundingClientRect();
                    var panelWidth = panelRect.right - panelRect.left;
                    if(panelRect.right > document.body.scrollWidth && (rect.left - (panelWidth + 5)) > 0) {
                        // Reposition, because the panel is overflowing
                        dfnPanel.style.left = window.scrollX + rect.left - (panelWidth + 5) + "px";
                    }
                } else {
                    console.log("Couldn't find .dfn-panel[data-for='" + el.id + "']");
                }
            } else if(target == "dfn-panel") {
                // Switch it to "activated" state, which pins it.
                el.classList.add("activated");
                el.style.left = null;
                el.style.top = null;
            }

        });
        </script>
        </body>
        </html>
